import{r as a,o as e,e as l,w as s,s as t,i as c,f as i,h as d,j as u,t as n,F as o,G as r,H as f,k as _,n as m,ab as v,J as h,T as p,u as b,q as g,M as k}from"./index-DZtLzZ3A.js";import{u as w}from"./user.BA7q8pkn.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const T=y({__name:"user-info",setup(y){const T=a({realName:"",phoneNumber:"",schoolId:null,schoolName:"",role:"",isVerified:!1,creditScore:0,major:"",studentTeacherId:"",avatarUrl:null,bio:"",skillTags:[],awardsHistory:[]}),x=a(!0),C=a(!1);async function N(){if(!C.value){C.value=!0,t({title:"正在刷新...",icon:"none",duration:1e3});try{const a=await w.getUserProfile();200===a.code&&a.data?(T.value=a.data,t({title:"刷新成功",icon:"success",duration:1e3})):t({title:a.message||"刷新失败",icon:"none"})}catch(a){console.error("刷新用户资料失败:",a),t({title:"刷新失败",icon:"none"})}finally{C.value=!1}}}function j(){v({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(a){a.tempFilePaths[0],t({title:"头像上传功能开发中",icon:"none"})}})}function H(){h({url:"/pages/profile/edit-basic-info"})}function I(){h({url:"/pages/profile/edit-bio"})}function U(){h({url:"/pages/profile/edit-skills"})}function F(){h({url:"/pages/profile/edit-awards"})}function P(){p()}return e((()=>{!async function(){try{x.value=!0;const a=await w.getUserProfile();200===a.code&&a.data?(T.value=a.data,console.log("获取到用户资料:",T.value)):t({title:a.message||"获取资料失败",icon:"none"})}catch(a){console.error("获取用户资料失败:",a),t({title:"获取个人资料失败",icon:"none"})}finally{x.value=!1}}()})),(a,e)=>{const t=b,v=c,h=g,p=k;return i(),l(v,{class:"container"},{default:s((()=>[d(v,{class:"header"},{default:s((()=>[d(v,{class:"back-btn",onClick:P},{default:s((()=>[d(t,{class:"iconfont icon-arrow-left"})])),_:1}),d(t,{class:"header-title"},{default:s((()=>[u("个人资料")])),_:1}),d(v,{class:"right-placeholder"})])),_:1}),x.value?(i(),l(v,{key:0,class:"loading-container"},{default:s((()=>[d(v,{class:"loading-circle"}),d(t,{class:"loading-text"},{default:s((()=>[u("加载中...")])),_:1})])),_:1})):(i(),l(p,{key:1,"scroll-y":"",class:"content-scroll"},{default:s((()=>[d(v,{class:"avatar-section"},{default:s((()=>[d(h,{class:"avatar",src:T.value.avatarUrl||"https://images.unsplash.com/photo-1547425260-76bcadfb4f2c?w=200",mode:"aspectFill"},null,8,["src"]),d(v,{class:"change-avatar-btn",onClick:j},{default:s((()=>[d(t,null,{default:s((()=>[u("更换头像")])),_:1})])),_:1})])),_:1}),d(v,{class:"info-card"},{default:s((()=>[d(v,{class:"card-header"},{default:s((()=>[d(t,{class:"card-title"},{default:s((()=>[u("基本信息")])),_:1}),d(v,{class:"edit-btn",onClick:H},{default:s((()=>[d(t,{class:"iconfont icon-edit"}),d(t,{class:"edit-text"},{default:s((()=>[u("编辑")])),_:1})])),_:1})])),_:1}),d(v,{class:"info-item"},{default:s((()=>[d(t,{class:"item-label"},{default:s((()=>[u("姓名")])),_:1}),d(t,{class:"item-value"},{default:s((()=>[u(n(T.value.realName),1)])),_:1})])),_:1}),d(v,{class:"info-item"},{default:s((()=>[d(t,{class:"item-label"},{default:s((()=>[u("手机号")])),_:1}),d(t,{class:"item-value"},{default:s((()=>[u(n(T.value.phoneNumber),1)])),_:1})])),_:1}),d(v,{class:"info-item"},{default:s((()=>[d(t,{class:"item-label"},{default:s((()=>[u("学号")])),_:1}),d(t,{class:"item-value"},{default:s((()=>[u(n(T.value.studentTeacherId),1)])),_:1})])),_:1}),d(v,{class:"info-item"},{default:s((()=>[d(t,{class:"item-label"},{default:s((()=>[u("学校")])),_:1}),d(t,{class:"item-value"},{default:s((()=>[u(n(T.value.schoolName),1)])),_:1})])),_:1}),d(v,{class:"info-item"},{default:s((()=>[d(t,{class:"item-label"},{default:s((()=>[u("专业")])),_:1}),d(t,{class:"item-value"},{default:s((()=>[u(n(T.value.major),1)])),_:1})])),_:1}),d(v,{class:"info-item"},{default:s((()=>[d(t,{class:"item-label"},{default:s((()=>[u("角色")])),_:1}),d(t,{class:"item-value"},{default:s((()=>[u(n("student"===T.value.role?"学生":"teacher"===T.value.role?"教师":"管理员"),1)])),_:1})])),_:1}),d(v,{class:"info-item"},{default:s((()=>[d(t,{class:"item-label"},{default:s((()=>[u("信用分")])),_:1}),d(t,{class:"item-value credit-score"},{default:s((()=>[u(n(T.value.creditScore),1)])),_:1})])),_:1})])),_:1}),d(v,{class:"info-card"},{default:s((()=>[d(v,{class:"card-header"},{default:s((()=>[d(t,{class:"card-title"},{default:s((()=>[u("个人简介")])),_:1}),d(v,{class:"edit-btn",onClick:I},{default:s((()=>[d(t,{class:"iconfont icon-edit"}),d(t,{class:"edit-text"},{default:s((()=>[u("编辑")])),_:1})])),_:1})])),_:1}),d(v,{class:"bio-content"},{default:s((()=>[d(t,null,{default:s((()=>[u(n(T.value.bio||"暂无个人简介，点击右上角编辑添加"),1)])),_:1})])),_:1})])),_:1}),d(v,{class:"info-card"},{default:s((()=>[d(v,{class:"card-header"},{default:s((()=>[d(t,{class:"card-title"},{default:s((()=>[u("技能标签")])),_:1}),d(v,{class:"edit-btn",onClick:U},{default:s((()=>[d(t,{class:"iconfont icon-edit"}),d(t,{class:"edit-text"},{default:s((()=>[u("编辑")])),_:1})])),_:1})])),_:1}),d(v,{class:"skills-container"},{default:s((()=>[(i(!0),o(f,null,r(T.value.skillTags,((a,e)=>(i(),l(v,{class:"skill-tag",key:e},{default:s((()=>[d(t,null,{default:s((()=>[u(n(a),1)])),_:2},1024)])),_:2},1024)))),128)),T.value.skillTags&&0!==T.value.skillTags.length?_("",!0):(i(),l(v,{key:0,class:"empty-skills"},{default:s((()=>[d(t,null,{default:s((()=>[u("暂无技能标签，点击右上角编辑添加")])),_:1})])),_:1}))])),_:1})])),_:1}),d(v,{class:"info-card"},{default:s((()=>[d(v,{class:"card-header"},{default:s((()=>[d(t,{class:"card-title"},{default:s((()=>[u("获奖经历")])),_:1}),d(v,{class:"edit-btn",onClick:F},{default:s((()=>[d(t,{class:"iconfont icon-edit"}),d(t,{class:"edit-text"},{default:s((()=>[u("编辑")])),_:1})])),_:1})])),_:1}),d(v,{class:"awards-container"},{default:s((()=>[(i(!0),o(f,null,r(T.value.awardsHistory,((a,e)=>(i(),l(v,{class:"award-item",key:e},{default:s((()=>[d(v,{class:"award-header"},{default:s((()=>[d(t,{class:"award-name"},{default:s((()=>[u(n(a.awardName),1)])),_:2},1024),d(t,{class:"award-level"},{default:s((()=>[u(n(a.level),1)])),_:2},1024)])),_:2},1024),d(v,{class:"award-detail"},{default:s((()=>[d(t,{class:"award-org"},{default:s((()=>[u(n(a.organization),1)])),_:2},1024),d(t,{class:"award-time"},{default:s((()=>[u(n(a.awardTime),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),T.value.awardsHistory&&0!==T.value.awardsHistory.length?_("",!0):(i(),l(v,{key:0,class:"empty-awards"},{default:s((()=>[d(t,null,{default:s((()=>[u("暂无获奖经历，点击右上角编辑添加")])),_:1})])),_:1}))])),_:1})])),_:1})])),_:1})),d(v,{class:"refresh-btn",onClick:N},{default:s((()=>[d(t,{class:m(["iconfont icon-refresh",{refreshing:C.value}])},null,8,["class"])])),_:1})])),_:1})}}},[["__scopeId","data-v-ef3fcca5"]]);export{T as default};
