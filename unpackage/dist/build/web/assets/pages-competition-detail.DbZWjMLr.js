import{r as e,o as t,R as a,m as s,s as l,e as i,w as n,i as r,f as c,h as o,j as u,F as d,n as f,t as m,k as g,H as v,G as x,T as _,J as y,ae as p,u as b,q as h,I as w,x as C,Q as k}from"./index-DZtLzZ3A.js";import{a as D}from"./index.BRmG1gro.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./user.BA7q8pkn.js";import"./team.VNekZ19c.js";import"./competitions.CeqcXiK9.js";import"./taskApplications.MAaxBfY8.js";const q=I({__name:"detail",setup(I){const q=e(null),$=e(!1),M=e("details"),j=e({id:null,title:"",category:"",level:"国家级",status:"",statusCode:"",image:"",registrationPeriod:"",registrationStart:"",registrationDeadline:"",competitionPeriod:"",location:"线上初赛 + 线下决赛",teamRequirement:"",description:"",shortDescription:"",requirements:"",organizer:{name:"",description:"",logo:""},contactInfo:{phone:"",email:""},teamSize:0,teamMax:0,websiteUrl:"",viewCount:0,attachments:[],categoryNames:[],coverImageUrl:""}),S=e([{title:"报名阶段",period:"",description:"在此阶段，参赛团队需完成在线报名，提交团队基本信息和项目概述。报名成功后，团队可以开始准备初赛材料。",status:"进行中",active:!0},{title:"初赛阶段",period:"",description:"各参赛团队需提交商业计划书和项目PPT。评审委员会将对所有参赛项目进行评审，选拔优秀项目进入复赛。",status:"未开始",active:!1},{title:"复赛阶段",period:"",description:"入围复赛的团队将进行现场路演和答辩。评委将从项目创新性、商业模式、团队能力等多方面进行评估。",status:"未开始",active:!1},{title:"总决赛",period:"",description:"决赛将在北京举行，入围团队将进行最终路演和展示。评审团将评选出金、银、铜奖项目，并举行颁奖典礼。",status:"未开始",active:!1}]),U=e([{title:"挑战杯创业计划大赛",image:"https://images.unsplash.com/photo-1523240795612-9a054b0db644?w=500",deadline:"6月10日"},{title:"创青春创业大赛",image:"https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=500",deadline:"7月5日"}]),N=e([]),P=e(!1),T=e(1),z=e(10),A=e(!0),F=e("");async function B(e){$.value=!0;try{const t=await D.competitions.getCompetitionDetail(e);if(t&&200===t.code&&t.data){const e=t.data;j.value={...j.value,id:e.id,title:e.title,category:e.categoryNames&&e.categoryNames.length>0?e.categoryNames[0]:"",level:e.level||"国家级",status:R(e.status),statusCode:e.status,image:e.coverImageUrl||"https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?w=800",registrationStart:e.registrationStart,registrationDeadline:e.registrationDeadline,registrationPeriod:E(e.registrationStart,e.registrationDeadline),description:e.description||e.shortDescription||"",shortDescription:e.shortDescription||"",requirements:e.requirements||"",teamRequirement:`${e.teamSize}~${e.teamMax}人/队`,teamSize:e.teamSize,teamMax:e.teamMax,organizer:{name:e.organizer||"未知主办方",description:"",logo:""},contactInfo:e.contactInfo||{phone:"暂无联系方式",email:""},websiteUrl:e.websiteUrl||"",viewCount:e.viewCount||0,attachments:e.attachments||[],categoryNames:e.categoryNames||[],coverImageUrl:e.coverImageUrl||""},function(e){if(e.registrationStart&&e.registrationDeadline){S.value[0].period=E(e.registrationStart,e.registrationDeadline);const t=new Date,a=new Date(e.registrationStart),s=new Date(e.registrationDeadline);t<a?(S.value[0].status="未开始",S.value[0].active=!1):t>=a&&t<=s?(S.value[0].status="进行中",S.value[0].active=!0):(S.value[0].status="已结束",S.value[0].active=!1),"2"===e.status?(S.value[1].active=!0,S.value[1].status="进行中",S.value[0].status="已结束"):"3"===e.status&&(S.value[0].status="已结束",S.value[1].status="已结束",S.value[2].status="已结束",S.value[3].status="已结束")}}(e),console.log("竞赛详情数据:",j.value)}else l({title:"获取竞赛详情失败",icon:"none"})}catch(t){console.error("获取竞赛详情错误:",t),l({title:"获取竞赛详情失败",icon:"none"})}finally{$.value=!1}}function R(e){switch(e){case"0":return"未开始";case"1":return"报名中";case"2":return"进行中";case"3":return"已截止";default:return"未知状态"}}function E(e,t){if(!e||!t)return"";const a=e=>{const t=new Date(e);return`${t.getFullYear()}年${t.getMonth()+1}月${t.getDate()}日`};return`${a(e)} - ${a(t)}`}async function V(e=!0){if(e&&(T.value=1,N.value=[]),A.value||e){P.value=!0;try{const t=await D.team.getTeamList({pageNum:T.value,pageSize:z.value,competitionId:q.value});if(200===t.code&&t.data){const a=(t.data.list||[]).map((e=>{let t=[];e.teamMemberAvatars&&("string"==typeof e.teamMemberAvatars?t=e.teamMemberAvatars.split(",").filter((e=>e)):Array.isArray(e.teamMemberAvatars)&&(t=e.teamMemberAvatars.filter((e=>e))));let a="#6B7280";"0"===e.status||"招募中"===e.statusText?a="#2563EB":"1"===e.status||"进行中"===e.statusText?a="#10B981":"2"!==e.status&&"已完成"!==e.statusText||(a="#059669");const s=e.memberCount||e.currentMemberCount||0,l=e.maxMemberCount||0,i=Math.max(0,l-s),n=function(e){const t=["#2563EB","#10B981","#8B5CF6","#EC4899","#F59E0B","#EF4444"];let a=0;if(0===e.length)return t[0];for(let s=0;s<e.length;s++)a=e.charCodeAt(s)+((a<<5)-a),a&=a;return a=Math.abs(a)%t.length,t[a]}(e.faculty||e.direction||"");let r=[];return e.roles&&e.roles.length>0&&(r=e.roles.map((e=>({id:e.id||0,name:e.name||"未知角色",description:e.description||"",currentCount:e.currentCount||0,requiredCount:e.requiredCount||1,isFilled:(e.currentCount||0)>=(e.requiredCount||1)})))),{...e,avatars:t.slice(0,3),statusColor:a,memberCount:s,remainingCount:i,actionText:"0"===e.status?"申请加入":"查看详情",facultyColor:n,faculty:e.direction||"未知方向",roles:r}}));N.value=e?a:[...N.value,...a],A.value=t.data.hasNext||!1,0!==N.value.length||e||l({title:"没有更多团队了",icon:"none"})}else e&&l({title:"暂无参赛队伍",icon:"none"})}catch(t){console.error("获取竞赛队伍列表失败:",t),l({title:"获取队伍列表失败",icon:"none"})}finally{P.value=!1}}}function Y(){!P.value&&A.value&&(T.value++,V(!1))}function G(e){M.value=e,"teams"===e&&0===N.value.length&&V()}function H(e){switch(e){case"创新创业":return"orange-tag";case"学科竞赛":return"green-tag";case"科技竞赛":return"blue-tag";case"文体竞赛":return"purple-tag";default:return"gray-tag"}}function J(e){switch(e){case"未开始":case"已截止":default:return"status-badge bg-gray-500";case"报名中":return"status-badge bg-green-500";case"进行中":return"status-badge bg-blue-500"}}function L(){switch(j.value.status){case"未开始":return"提醒我";case"报名中":return"寻找队伍";case"进行中":return"查看队伍";case"已截止":return"查看结果";default:return"了解详情"}}function Q(){if(j.value.registrationDeadline){const e=new Date(j.value.registrationDeadline);return`${e.getFullYear()}年${e.getMonth()+1}月${e.getDate()}日`}if(j.value.registrationPeriod){const e=j.value.registrationPeriod.split(" - ");return e.length>1?e[1]:j.value.registrationPeriod}return"暂无截止日期"}function K(){_()}function O(){F.value=""}function W(){console.log("打开筛选选项")}function X(){y({url:`/pages/team/create?competitionId=${j.value.id}&competitionName=${encodeURIComponent(j.value.title)}`})}function Z(){switch(L()){case"寻找队伍":case"查看队伍":M.value="teams",0===N.value.length&&V(),p({selector:".tab-active",duration:300});break;case"提醒我":l({title:"已设置提醒",icon:"success"});break;case"查看结果":l({title:"比赛结果即将公布",icon:"none"});break;default:l({title:"功能开发中",icon:"none"})}}return t((()=>{const e=a(),t=e[e.length-1];t.$page&&t.$page.options?(q.value=t.$page.options.id,q.value?B(q.value).finally((()=>{s()})):(s(),l({title:"竞赛ID不存在",icon:"none"}))):s()})),(e,t)=>{const a=r,s=b,l=h,_=w,p=C;return c(),i(a,{class:"container"},{default:n((()=>[$.value?(c(),i(a,{key:0,class:"loading-container"},{default:n((()=>[o(a,{class:"spinner"}),o(s,{class:"loading-text"},{default:n((()=>[u("加载中...")])),_:1})])),_:1})):(c(),d(v,{key:1},[o(a,{class:"sticky-header"},{default:n((()=>[o(a,{class:"flex-row px-4 py-3"},{default:n((()=>[o(a,{class:"mr-3",onClick:K},{default:n((()=>[o(s,{class:"iconfont icon-arrow-left text-gray-600"})])),_:1}),o(s,{class:"text-xl font-bold text-gray-800"},{default:n((()=>[u("竞赛详情")])),_:1}),o(a,{class:"ml-auto flex-row space-x-3"},{default:n((()=>[o(a,{class:"p-2 rounded-full bg-gray-100"},{default:n((()=>[o(s,{class:"iconfont icon-bookmark-outline text-gray-600"})])),_:1}),o(a,{class:"p-2 rounded-full bg-gray-100"},{default:n((()=>[o(s,{class:"iconfont icon-share text-gray-600"})])),_:1})])),_:1})])),_:1})])),_:1}),o(a,{class:"relative"},{default:n((()=>[o(l,{class:"cover-image",src:j.value.image,mode:"aspectFill"},null,8,["src"]),o(a,{class:"cover-overlay"},{default:n((()=>[o(a,{class:f(J(j.value.status))},{default:n((()=>[u(m(j.value.status),1)])),_:1},8,["class"]),o(s,{class:"text-white text-2xl font-bold"},{default:n((()=>[u(m(j.value.title),1)])),_:1}),o(a,{class:"flex-row items-center mt-1 space-x-2"},{default:n((()=>[o(s,{class:f(["category-tag",H(j.value.category)])},{default:n((()=>[u(m(j.value.category),1)])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),o(a,{class:"bg-white p-4 shadow-sm"},{default:n((()=>[o(a,{class:"flex-row justify-between items-center"},{default:n((()=>[o(a,{class:"flex-row items-center space-x-2"},{default:n((()=>[o(s,{class:"iconfont icon-calendar info-icon"}),o(s,{class:"text-sm text-gray-700"},{default:n((()=>[u("报名截止: "+m(Q()),1)])),_:1})])),_:1}),o(a,{class:"flex-row items-center space-x-2"},{default:n((()=>[o(s,{class:"iconfont icon-users info-icon"}),o(s,{class:"text-sm text-gray-700"},{default:n((()=>[u(m(j.value.teamRequirement),1)])),_:1})])),_:1})])),_:1}),o(a,{class:"flex-row justify-between items-center mt-3"},{default:n((()=>[o(a,{class:"flex-row items-center space-x-2",style:{width:"60%"}},{default:n((()=>[o(s,{class:"iconfont icon-university info-icon"}),o(s,{class:"text-sm text-gray-700"},{default:n((()=>[u("主办方: "+m(j.value.organizer.name),1)])),_:1})])),_:1}),o(a,{class:"flex-row items-center space-x-2"},{default:n((()=>[o(s,{class:"iconfont icon-trophy info-icon"}),o(s,{class:"text-sm text-gray-700"},{default:n((()=>[u(m(j.value.level),1)])),_:1})])),_:1})])),_:1})])),_:1}),o(a,{class:"bg-white mt-2 shadow-sm"},{default:n((()=>[o(a,{class:"flex-row border-b"},{default:n((()=>[o(a,{class:f(["flex-1 py-3 text-center text-sm font-medium","details"===M.value?"tab-active":"text-gray-500"]),onClick:t[0]||(t[0]=e=>G("details"))},{default:n((()=>[u("竞赛详情")])),_:1},8,["class"]),o(a,{class:f(["flex-1 py-3 text-center text-sm font-medium","schedule"===M.value?"tab-active":"text-gray-500"]),onClick:t[1]||(t[1]=e=>G("schedule"))},{default:n((()=>[u("赛程安排")])),_:1},8,["class"]),o(a,{class:f(["flex-1 py-3 text-center text-sm font-medium","teams"===M.value?"tab-active":"text-gray-500"]),onClick:t[2]||(t[2]=e=>G("teams"))},{default:n((()=>[u("参赛队伍")])),_:1},8,["class"])])),_:1})])),_:1}),"details"===M.value?(c(),i(a,{key:0,class:"bg-white p-4 mt-2 shadow-sm"},{default:n((()=>[o(a,{class:"font-bold text-lg text-gray-800 mb-3"},{default:n((()=>[u("竞赛简介")])),_:1}),o(s,{class:"text-gray-700 text-sm leading-relaxed"},{default:n((()=>[u(m(j.value.description),1)])),_:1}),j.value.requirements?(c(),i(a,{key:0,class:"font-bold text-lg text-gray-800 mt-6 mb-3"},{default:n((()=>[u("参赛要求")])),_:1})):g("",!0),j.value.requirements?(c(),i(s,{key:1,class:"text-gray-700 text-sm leading-relaxed"},{default:n((()=>[u(m(j.value.requirements),1)])),_:1})):(c(),i(a,{key:2,class:"text-gray-700 text-sm space-y-2 list-disc pl-5 mt-6"},{default:n((()=>[o(a,{class:"list-item"},{default:n((()=>[u("参赛项目须为本校在校生，允许跨校组队")])),_:1}),o(a,{class:"list-item"},{default:n((()=>[u("参赛团队成员"+m(j.value.teamRequirement),1)])),_:1}),o(a,{class:"list-item"},{default:n((()=>[u("参赛项目需具有创新性、可行性和商业价值")])),_:1}),o(a,{class:"list-item"},{default:n((()=>[u("参赛项目需提交商业计划书和路演PPT")])),_:1}),o(a,{class:"list-item"},{default:n((()=>[u("参赛项目需在报名截止前完成在线提交")])),_:1})])),_:1})),o(a,{class:"font-bold text-lg text-gray-800 mt-6 mb-3"},{default:n((()=>[u("联系方式")])),_:1}),o(a,{class:"space-y-2 text-sm text-gray-700"},{default:n((()=>[j.value.contactInfo.phone?(c(),i(s,{key:0},{default:n((()=>[u("联系电话："+m(j.value.contactInfo.phone),1)])),_:1})):(c(),i(s,{key:1},{default:n((()=>[u("联系人：竞赛组委会")])),_:1})),j.value.contactInfo.email?(c(),i(a,{key:2},{default:n((()=>[u("邮箱："+m(j.value.contactInfo.email),1)])),_:1})):g("",!0),j.value.websiteUrl?(c(),i(a,{key:3},{default:n((()=>[u("官网："+m(j.value.websiteUrl),1)])),_:1})):g("",!0)])),_:1}),j.value.attachments&&j.value.attachments.length>0?(c(),i(a,{key:3,class:"mt-6"},{default:n((()=>[o(a,{class:"font-bold text-lg text-gray-800 mb-3"},{default:n((()=>[u("相关资料")])),_:1}),o(a,null,{default:n((()=>[u("无")])),_:1}),o(a,{class:"space-y-3"},{default:n((()=>[(c(!0),d(v,null,x(j.value.attachments,((e,t)=>(c(),i(a,{key:t,class:"flex-row items-center p-3 bg-gray-50 rounded-lg"},{default:n((()=>[o(s,{class:"iconfont icon-file text-blue-500 mr-2"}),o(s,{class:"flex-1 text-sm text-gray-700"},{default:n((()=>[u(m(e.fileName),1)])),_:2},1024),o(a,{class:"px-3 py-1 bg-blue-500 rounded-full"},{default:n((()=>[o(s,{class:"text-xs text-white"},{default:n((()=>[u("下载")])),_:1})])),_:1})])),_:2},1024)))),128))])),_:1})])),_:1})):g("",!0),o(a,{class:"mt-6"},{default:n((()=>[o(a,{class:"font-bold text-lg text-gray-800 mb-3"},{default:n((()=>[u("相关竞赛")])),_:1}),o(a,{class:"related-grid"},{default:n((()=>[(c(!0),d(v,null,x(U.value,((e,t)=>(c(),i(a,{key:t,class:"related-card"},{default:n((()=>[o(a,{class:"related-image-container"},{default:n((()=>[o(l,{src:e.image,class:"related-image"},null,8,["src"])])),_:2},1024),o(a,{class:"p-3"},{default:n((()=>[o(s,{class:"font-bold text-sm text-gray-800"},{default:n((()=>[u(m(e.title),1)])),_:2},1024),o(a,{class:"flex-row items-center mt-1"},{default:n((()=>[o(s,{class:"text-xs text-gray-500"},{default:n((()=>[u("报名截止: "+m(e.deadline),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})):g("",!0),"schedule"===M.value?(c(),i(a,{key:1,class:"bg-white p-4 mt-2 shadow-sm"},{default:n((()=>[o(a,{class:"relative"},{default:n((()=>[o(a,{class:"timeline-line"}),(c(!0),d(v,null,x(S.value,((e,t)=>(c(),i(a,{key:t,class:"timeline-item"},{default:n((()=>[o(a,{class:"timeline-dot-container"},{default:n((()=>[o(a,{class:f(["timeline-dot",e.active?"active-dot":""])},{default:n((()=>[o(s,{class:"timeline-dot-text"},{default:n((()=>[u(m(t+1),1)])),_:2},1024)])),_:2},1032,["class"])])),_:2},1024),o(a,{class:f(["timeline-content",e.active?"active-content":""])},{default:n((()=>[o(a,{class:"flex-row justify-between items-center mb-2"},{default:n((()=>[o(s,{class:f(["font-bold",e.active?"text-blue-800":"text-gray-700"])},{default:n((()=>[u(m(e.title),1)])),_:2},1032,["class"]),o(s,{class:f(["status-text",e.active?"active-status":"inactive-status"])},{default:n((()=>[u(m(e.status),1)])),_:2},1032,["class"])])),_:2},1024),o(s,{class:"text-sm text-gray-700 mb-2"},{default:n((()=>[u(m(e.period),1)])),_:2},1024),o(s,{class:"text-xs text-gray-600"},{default:n((()=>[u(m(e.description),1)])),_:2},1024)])),_:2},1032,["class"])])),_:2},1024)))),128))])),_:1})])),_:1})):g("",!0),"teams"===M.value?(c(),i(a,{key:2,class:"bg-white p-4 mt-2 shadow-sm"},{default:n((()=>[o(a,{class:"search-filter-container"},{default:n((()=>[o(a,{class:"search-box"},{default:n((()=>[o(s,{class:"iconfont icon-search search-icon"}),o(_,{type:"text",placeholder:"搜索队伍",class:"search-input",modelValue:F.value,"onUpdate:modelValue":t[3]||(t[3]=e=>F.value=e)},null,8,["modelValue"]),F.value?(c(),i(s,{key:0,class:"iconfont icon-close-circle clear-icon",onClick:O})):g("",!0)])),_:1}),o(a,{class:"filter-btn",onClick:W},{default:n((()=>[o(s,{class:"iconfont icon-filter filter-icon"}),o(s,{class:"filter-text"},{default:n((()=>[u("筛选")])),_:1})])),_:1})])),_:1}),N.value.length>0?(c(),i(a,{key:0,class:"space-y-4"},{default:n((()=>[(c(!0),d(v,null,x(N.value,(e=>(c(),i(a,{key:e.id,class:"team-card",onClick:t=>{return a=e.id,void y({url:`/pages/team/detail?id=${a}`});var a}},{default:n((()=>[o(a,{class:"flex-row justify-between items-start"},{default:n((()=>[o(a,null,{default:n((()=>[o(s,{class:"font-bold text-gray-800"},{default:n((()=>[u(m(e.name),1)])),_:2},1024),o(a,{class:"flex-row items-center mt-1"},{default:n((()=>[o(s,{class:"faculty-tag",style:k({backgroundColor:e.facultyColor+"20",color:e.facultyColor})},{default:n((()=>[u(m(e.faculty),1)])),_:2},1032,["style"]),o(s,{class:"text-xs text-gray-500"},{default:n((()=>[u(m(e.memberCount)+"人团队",1)])),_:2},1024)])),_:2},1024)])),_:2},1024),o(a,{class:"team-status",style:k({backgroundColor:e.statusColor+"20",color:e.statusColor})},{default:n((()=>[u(m(e.statusText),1)])),_:2},1032,["style"])])),_:2},1024),o(s,{class:"text-sm text-gray-600 mt-3"},{default:n((()=>[u("项目简介："+m(e.description),1)])),_:2},1024),e.roles&&e.roles.length>0?(c(),i(a,{key:0,class:"role-tags mt-3"},{default:n((()=>[(c(!0),d(v,null,x(e.roles,((e,t)=>(c(),i(a,{key:t,class:f(["role-tag",e.isFilled?"role-filled":"role-recruiting"])},{default:n((()=>[o(s,{class:"role-name"},{default:n((()=>[u(m(e.name),1)])),_:2},1024),o(s,{class:"role-count"},{default:n((()=>[u(m(e.currentCount||0)+"/"+m(e.requiredCount||1),1)])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:2},1024)):g("",!0),o(a,{class:"flex-row items-center justify-between mt-3"},{default:n((()=>[o(a,{class:"flex-row member-avatars"},{default:n((()=>[(c(!0),d(v,null,x(e.avatars,((e,t)=>(c(),i(l,{key:t,src:e||"/static/images/default-avatar.png",class:"member-avatar"},null,8,["src"])))),128)),e.remainingCount>0?(c(),i(a,{key:0,class:"member-avatar-more"},{default:n((()=>[u("+"+m(e.remainingCount),1)])),_:2},1024)):g("",!0)])),_:2},1024),o(s,{class:"text-blue-500 text-sm"},{default:n((()=>[u(m(e.actionText),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):P.value?g("",!0):(c(),i(a,{key:1,class:"empty-state"},{default:n((()=>[o(s,{class:"text-gray-500"},{default:n((()=>[u("暂无参赛队伍")])),_:1})])),_:1})),P.value?(c(),i(a,{key:2,class:"loading-state"},{default:n((()=>[o(a,{class:"spinner-sm"}),o(s,{class:"text-sm text-gray-500 ml-2"},{default:n((()=>[u("加载中...")])),_:1})])),_:1})):g("",!0),N.value.length>0&&A.value?(c(),i(a,{key:3,class:"text-center mt-6"},{default:n((()=>[o(p,{class:"load-more-btn",onClick:Y},{default:n((()=>[u("加载更多")])),_:1})])),_:1})):g("",!0)])),_:1})):g("",!0),o(a,{class:"fixed-bottom"},{default:n((()=>[o(p,{class:"team-btn",onClick:X},{default:n((()=>[o(s,{class:"iconfont icon-users mr-1"}),o(s,null,{default:n((()=>[u("创建队伍")])),_:1})])),_:1}),o(p,{class:f(["register-btn",{"disabled-btn":"0"===j.value.statusCode||"3"===j.value.statusCode}]),disabled:"0"===j.value.statusCode||"3"===j.value.statusCode,onClick:Z},{default:n((()=>[u(m(L()),1)])),_:1},8,["class","disabled"])])),_:1})],64))])),_:1})}}},[["__scopeId","data-v-3c73c564"]]);export{q as default};
