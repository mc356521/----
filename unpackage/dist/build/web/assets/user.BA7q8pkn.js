import{O as e,p as o,af as r,aj as s}from"./index-DZtLzZ3A.js";const t={getSchools:()=>e({url:"/api/schools",method:"GET"}),login:r=>(console.log("登录请求参数:",r),e({url:"/users/login",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{phone:r.phone,password:r.password}}).then((e=>{if(console.log("登录响应:",e),e&&200===e.code&&e.data){const r=e.data;return o("token",r),console.log("登录成功，已保存token"),{token:r,isLogin:!0}}if(e&&e.message)throw new Error(e.message);return e}))),register(o){console.log("注册请求参数 (原始):",o);const r={phoneNumber:o.phoneNumber||o.phone,password:o.password,realName:o.realName,schoolId:o.schoolId||1,role:o.role||"student",major:o.major,studentTeacherId:o.studentTeacherId};return"number"==typeof r.studentTeacherId&&(r.studentTeacherId=String(r.studentTeacherId)),"number"!=typeof r.schoolId&&(r.schoolId=Number(r.schoolId)||1),console.log("注册请求数据 (转换后):",r),console.log("注册请求URL:","/users/register"),e({url:"/users/register",method:"POST",data:r,header:{"Content-Type":"application/json"}}).then((e=>(console.log("注册响应:",e),e))).catch((e=>{throw console.error("注册请求错误:",e),e.response&&e.response.data&&console.error("服务器错误详情:",e.response.data),e}))},getUserInfo:()=>e({url:"/user/info",method:"GET"}),getUserRole(o){const s=o||r();return s?e({url:`/users/role/parse?token=${encodeURIComponent(s)}`,method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"}}):Promise.reject(new Error("未登录"))},logout:()=>e({url:"/user/logout",method:"POST"}).finally((()=>{s("")})),updateUserInfo:o=>e({url:"/user/update",method:"PUT",data:o}),changePassword:o=>e({url:"/user/password",method:"PUT",data:o}),getUserProfile:()=>e({url:"/users/profile",method:"GET"}),updateUserProfile:o=>e({url:"/users/profile",method:"PUT",data:o,header:{"Content-Type":"application/json"}}),getSkillTags:()=>e({url:"/api/skill-tags/group-by-category",method:"GET"})};export{t as u};
