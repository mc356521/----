if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}function a(e,t){return"string"==typeof e?t:e}const n={baseUrl:"http://103.38.83.91:8080",timeout:3e4,uploadUrl:"/api/upload",wsUrl:"wss://dev-api.example.com/ws",debug:!0,version:"1.0.0",env:"development"},i={development:n,test:{baseUrl:"http://103.38.83.91:8080",timeout:45e3,uploadUrl:"/api/upload",wsUrl:"wss://test-api.example.com/ws",debug:!0,version:"1.0.0",env:"test"},production:{baseUrl:"http://103.38.83.91:8080",timeout:15e3,uploadUrl:"/api/upload",wsUrl:"wss://api.example.com/ws",debug:!1,version:"1.0.0",env:"production"}};function l(){t("log","at config/env/index.js:28","当前平台:","app");const e=i.production||i.test;return e.runtimePlatform="app",e.actualBaseUrl=e.baseUrl,e}l(),l();const o=l();o.debug&&(t("log","at utils/request.js:11","当前API环境配置:",o),t("log","at utils/request.js:12","API基础路径:",o.baseUrl),o.actualBaseUrl&&t("log","at utils/request.js:14","实际API地址:",o.actualBaseUrl));const s="token",r=()=>uni.getStorageSync(s)||"",c=e=>{uni.setStorageSync(s,e)},d=e=>{const a={url:e.url||"",method:e.method||"GET",data:e.data||{},params:e.params||{},header:e.header||{},timeout:e.timeout||o.timeout||6e4};if(a.url.startsWith("http://")||a.url.startsWith("https://")||a.url.startsWith(o.baseUrl)||(a.url.startsWith("/")&&o.baseUrl.endsWith("/")?a.url=o.baseUrl+a.url.substring(1):a.url.startsWith("/")||o.baseUrl.endsWith("/")?a.url=o.baseUrl+a.url:a.url=o.baseUrl+"/"+a.url),"GET"===a.method&&Object.keys(a.params).length>0){const e=Object.keys(a.params).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(a.params[e])}`)).join("&");a.url=`${a.url}${a.url.includes("?")?"&":"?"}${e}`}o.debug&&(t("log","at utils/request.js:187",`${a.method} 请求:`,a.url),a.data&&Object.keys(a.data).length>0&&t("log","at utils/request.js:189","请求数据:",a.data));const n=(e=>{const a=r();return a&&(e.header.Authorization=`Bearer ${a}`,o.debug&&t("log","at utils/request.js:49","发送请求头Authorization:",`Bearer ${a}`)),e.header["Content-Type"]||(e.header["Content-Type"]="application/json"),o.debug&&(t("log","at utils/request.js:60","完整请求配置:",{url:e.url,method:e.method,headers:e.header,data:e.data,params:e.params}),e.url.includes("/users/register")&&(t("log","at utils/request.js:70","注册请求完整数据:",JSON.stringify(e.data)),t("log","at utils/request.js:71","注册请求Content-Type:",e.header["Content-Type"]))),e})(a);return new Promise(((e,a)=>{uni.request({url:n.url,method:n.method,data:n.data,header:n.header,timeout:n.timeout,success:i=>{o.debug&&t("log","at utils/request.js:206","响应数据:",i),i.config=n,(e=>{if(200===e.statusCode)return e.config&&e.config.url&&(e.config.url.includes("/users/login")||e.config.url.includes("/user/login"))&&e.data&&e.data.data&&"string"==typeof e.data.data?(c(e.data.data),o.debug&&t("log","at utils/request.js:93","已保存token:",e.data.data),Promise.resolve(e.data)):Promise.resolve(e.data);{const a=`请求失败: ${e.statusCode}`;return o.debug&&(t("error","at utils/request.js:108","请求失败状态码:",e.statusCode),t("error","at utils/request.js:109","请求地址:",e.config.url),t("error","at utils/request.js:110","请求方法:",e.config.method),t("error","at utils/request.js:111","请求头:",e.config.header),t("error","at utils/request.js:112","请求数据:",e.config.data),t("error","at utils/request.js:113","响应数据:",e.data)),400===e.statusCode&&(t("error","at utils/request.js:118","400错误详情:",e.data),t("error","at utils/request.js:119","请求的原始数据:",e.config.data)),uni.showToast({title:a,icon:"none"}),401!==e.statusCode&&403!==e.statusCode||(c(""),setTimeout((()=>{uni.navigateTo({url:"/pages/login/login"})}),1500)),Promise.reject(new Error(`HTTP错误: ${e.statusCode}`))}})(i).then((t=>e(t))).catch((e=>a(e)))},fail:e=>{o.debug&&t("error","at utils/request.js:219","请求失败:",e),uni.showToast({title:"网络错误，请检查网络连接",icon:"none"}),a(new Error("网络请求失败"))}})}))},u={getSchools:()=>d({url:"/api/schools",method:"GET"}),login:e=>(t("log","at api/modules/user.js:26","登录请求参数:",e),d({url:"/users/login",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{phone:e.phone,password:e.password}}).then((e=>{if(t("log","at api/modules/user.js:38","登录响应:",e),e&&200===e.code&&e.data){const a=e.data;return uni.setStorageSync("token",a),t("log","at api/modules/user.js:45","登录成功，已保存token"),{token:a,isLogin:!0}}if(e&&e.message)throw new Error(e.message);return e}))),register(e){t("log","at api/modules/user.js:68","注册请求参数 (原始):",e);const a={phoneNumber:e.phoneNumber||e.phone,password:e.password,realName:e.realName,schoolId:e.schoolId||1,role:e.role||"student",major:e.major,studentTeacherId:e.studentTeacherId};return"number"==typeof a.studentTeacherId&&(a.studentTeacherId=String(a.studentTeacherId)),"number"!=typeof a.schoolId&&(a.schoolId=Number(a.schoolId)||1),t("log","at api/modules/user.js:90","注册请求数据 (转换后):",a),t("log","at api/modules/user.js:91","注册请求URL:","/users/register"),d({url:"/users/register",method:"POST",data:a,header:{"Content-Type":"application/json"}}).then((e=>(t("log","at api/modules/user.js:101","注册响应:",e),e))).catch((e=>{throw t("error","at api/modules/user.js:104","注册请求错误:",e),e.response&&e.response.data&&t("error","at api/modules/user.js:106","服务器错误详情:",e.response.data),e}))},getUserInfo:()=>d({url:"/user/info",method:"GET"}),getUserRole(e){const t=e||r();return t?d({url:`/users/role/parse?token=${encodeURIComponent(t)}`,method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"}}):Promise.reject(new Error("未登录"))},logout:()=>d({url:"/user/logout",method:"POST"}).finally((()=>{c("")})),updateUserInfo:e=>d({url:"/user/update",method:"PUT",data:e}),changePassword:e=>d({url:"/user/password",method:"PUT",data:e})},m={getTeamList:(e={})=>d({url:"/teams/list",method:"GET",params:e}),getTeamDetail:e=>d({url:`/teams/${e}`,method:"GET"}),getTeamMembers:e=>d({url:`/teams/${e}/members`,method:"GET"}),applyTeam(e){if(!e.teamId||!e.roleId||!e.message)return t("error","at api/modules/team.js:61","申请加入团队缺少必要参数",e),Promise.reject(new Error("申请加入团队缺少必要参数"));const a={teamId:Number(e.teamId),roleId:Number(e.roleId),message:String(e.message)};return t("log","at api/modules/team.js:72","申请加入团队，请求数据:",a),d({url:"/team-applications",method:"POST",data:a,header:{"Content-Type":"application/json"}})},getMyApplications:(e={})=>d({url:"/team-applications/list",method:"GET",params:{...e,role:"applicant"}}),getTeamApplications:(e={})=>d({url:"/team-applications/list",method:"GET",params:{...e,role:"leader"}}),handleApplication:(e,t)=>d({url:`/team-applications/${e}`,method:"PUT",data:t}),cancelApplication:e=>d({url:`/team-applications/${e}`,method:"DELETE"}),checkTeamStatus:e=>d({url:`/teams/${e}/has-applied`,method:"GET"}),disbandTeam:e=>d({url:`/teams/${e}/dissolve`,method:"POST"}),leaveTeam:e=>d({url:`/team-members/teams/${e}`,method:"DELETE"}),createTeam:e=>d({url:"/teams",method:"POST",data:e}),getMyTeams:()=>d({url:"/teams/my",method:"GET"})},p={getCompetitionsList:(e={})=>d({url:"/competitions/list",method:"GET",params:e}),getCompetitionDetail(e){const t=r();return t?d({url:`/competitions/${e}`,method:"GET",header:{Authorization:`Bearer ${t}`}}):(uni.showToast({title:"请先登录",icon:"none"}),setTimeout((()=>{uni.navigateTo({url:"/pages/login/login"})}),1500),Promise.reject(new Error("未登录")))},createCompetition(e){const a=r();return a?(t("log","at api/modules/competitions.js:99","准备创建竞赛，数据:",e),d({url:"/competitions",method:"POST",data:e,header:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}}).then((e=>(t("log","at api/modules/competitions.js:110","创建竞赛响应:",e),e))).catch((e=>{throw t("error","at api/modules/competitions.js:113","创建竞赛出错:",e),e}))):(uni.showToast({title:"请先登录",icon:"none"}),setTimeout((()=>{uni.navigateTo({url:"/pages/login/login"})}),1500),Promise.reject(new Error("未登录")))},getCompetitionCategories:()=>d({url:"/competitions/categories",method:"GET"}),getCompetitionsBasicInfo:()=>d({url:"/competitions/basic-info",method:"GET"})},h=n.baseUrl;function g(e){return d({url:`${h}/task-applications`,method:"POST",data:e})}function f(e){return d({url:`${h}/task-applications/list`,method:"GET",params:e})}function v(e,t){return d({url:`${h}/task-applications/${e}`,method:"PUT",data:t})}function w(e){return d({url:`${h}/task-applications/${e}`,method:"DELETE"})}function y(e){return d({url:`${h}/task-participations/check`,method:"GET",params:{taskId:e}})}function k(e){return d({url:`${h}/task-applications/${e}`,method:"GET"})}const E={createTaskApplication:g,getTaskApplicationList:f,updateTaskApplication:v,cancelTaskApplication:w,checkTaskApplication:y,getTaskApplicationDetail:k},V=Object.freeze(Object.defineProperty({__proto__:null,cancelTaskApplication:w,checkTaskApplication:y,createTaskApplication:g,default:E,getTaskApplicationDetail:k,getTaskApplicationList:f,updateTaskApplication:v},Symbol.toStringTag,{value:"Module"})),N={user:u,team:m,competitions:p,taskApplications:V},x={__name:"login",setup(a){const n=e.ref(!1),i=e.ref(!0),l=e.ref(!1),o=e.ref([]),s=e.ref([[],[]]),r=e.ref([0,0]),c=e.ref([]),d=e.ref({}),u=e.computed((()=>{if(0===s.value[0].length||0===s.value[1].length)return"";const e=r.value[0],t=r.value[1];if(!s.value[0][e]||!s.value[1][t])return"";return`${s.value[0][e].name} - ${s.value[1][t].name}`}));function m(e){const{column:t,value:a}=e.detail;if(0===t){r.value[0]=a,r.value[1]=0;const e=s.value[0][a].name;s.value[1]=d.value[e]||[]}else r.value[1]=a}function p(e){const[t,a]=e.detail.value;r.value=[t,a],s.value[1]&&s.value[1][a]&&(g.schoolId=s.value[1][a].id)}e.onMounted((async()=>{try{const e=await N.user.getSchools();if(e&&e.data){o.value=e.data;const t={},a={};if(e.data.forEach((e=>{t[e.province]||(t[e.province]={id:e.province,name:e.province},a[e.province]=[]),a[e.province].push(e)})),c.value=Object.values(t),d.value=a,s.value[0]=c.value,c.value.length>0){const e=c.value[0].name;s.value[1]=d.value[e]||[]}if(g.schoolId){const e=o.value.find((e=>e.id===g.schoolId));if(e){const t=c.value.findIndex((t=>t.name===e.province));if(-1!==t){r.value[0]=t;const a=d.value[e.province]||[],n=a.findIndex((t=>t.id===e.id));-1!==n&&(s.value[1]=a,r.value[1]=n)}}}}}catch(e){t("error","at pages/login/login.vue:224","获取学校列表失败:",e),uni.showToast({title:"获取学校列表失败",icon:"none"})}}));const h=e.reactive({phone:"",password:""}),g=e.reactive({phoneNumber:"",password:"",realName:"",schoolId:1,role:"student",major:"",studentTeacherId:""});function f(){l.value=!l.value}function v(){n.value=!n.value}function w(){i.value=!i.value}async function y(){if(h.phone&&h.password){uni.removeStorageSync("token"),uni.showLoading({title:"正在登录...",mask:!0});try{t("log","at pages/login/login.vue:313","正在连接登录服务器...");const e=await N.user.login({phone:h.phone,password:h.password});uni.hideLoading(),t("log","at pages/login/login.vue:322","登录响应:",e),e&&e.token?(uni.showToast({title:"登录成功",icon:"success"}),setTimeout((()=>{uni.switchTab({url:"/pages/index/index"})}),1500)):uni.showToast({title:"登录失败，请检查账号密码",icon:"none"})}catch(e){t("error","at pages/login/login.vue:346","登录失败:",e),uni.hideLoading(),uni.showToast({title:e.message||"登录失败，请检查网络连接或服务器配置",icon:"none",duration:3e3})}}else uni.showToast({title:"请输入手机号和密码",icon:"none"})}async function k(){if(g.phoneNumber)if(g.password)if(g.realName)if(g.schoolId)if(g.major)if(g.studentTeacherId)try{uni.removeStorageSync("token"),t("log","at pages/login/login.vue:414","发送的注册数据:",JSON.stringify(g));await N.user.register(g);uni.showToast({title:"注册成功",icon:"success"}),l.value=!1}catch(e){uni.showToast({title:e.message||"注册失败",icon:"none",duration:3e3}),t("error","at pages/login/login.vue:431","注册失败:",e)}else uni.showToast({title:"请输入学号",icon:"none"});else uni.showToast({title:"请输入专业",icon:"none"});else uni.showToast({title:"请选择学校",icon:"none"});else uni.showToast({title:"请输入姓名",icon:"none"});else uni.showToast({title:"请输入密码",icon:"none"});else uni.showToast({title:"请输入手机号",icon:"none"})}function E(){uni.showToast({title:"忘记密码功能开发中",icon:"none"})}function V(e){uni.showToast({title:`${e}登录功能开发中`,icon:"none"})}function x(){uni.showToast({title:"服务条款",icon:"none"})}function b(){uni.showToast({title:"隐私政策",icon:"none"})}return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"content-area"},[e.createElementVNode("view",{class:"top-image"},[e.createElementVNode("image",{src:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80",mode:"aspectFill",class:"campus-image"})]),e.createElementVNode("view",{class:"welcome-text"},[e.createElementVNode("text",{class:"welcome-title"},e.toDisplayString(l.value?"注册账号":"欢迎回来"),1),e.createElementVNode("text",{class:"welcome-subtitle"},e.toDisplayString(l.value?"创建您的校园平台账号":"登录您的校园平台账号，开启校园新体验"),1)]),l.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"login-form"},[e.createElementVNode("view",{class:"input-field"},[e.createElementVNode("view",{class:"input-content"},[e.createElementVNode("text",{class:"iconfont icon-mobile"}),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"手机号",class:"form-input","onUpdate:modelValue":a[2]||(a[2]=e=>g.phoneNumber=e)},null,512),[[e.vModelText,g.phoneNumber]])])]),e.createElementVNode("view",{class:"input-field"},[e.createElementVNode("view",{class:"input-content"},[e.createElementVNode("text",{class:"iconfont icon-lock"}),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"密码",class:"form-input","onUpdate:modelValue":a[3]||(a[3]=e=>g.password=e),password:i.value},null,8,["password"]),[[e.vModelText,g.password]]),e.createElementVNode("text",{class:e.normalizeClass(["iconfont",i.value?"icon-eye-slash":"icon-eye"]),onClick:w},null,2)])]),e.createElementVNode("view",{class:"input-field"},[e.createElementVNode("view",{class:"input-content"},[e.createElementVNode("text",{class:"iconfont icon-user"}),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"真实姓名",class:"form-input","onUpdate:modelValue":a[4]||(a[4]=e=>g.realName=e)},null,512),[[e.vModelText,g.realName]])])]),e.createElementVNode("view",{class:"input-field"},[e.createElementVNode("view",{class:"input-content"},[e.createElementVNode("text",{class:"iconfont icon-graduation"}),e.createElementVNode("picker",{mode:"multiSelector",onChange:p,onColumnchange:m,value:r.value,range:s.value,"range-key":"name",class:"school-picker"},[e.createElementVNode("view",{class:"picker-content"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString(u.value||"请选择学校（省份-学校）"),1),e.createElementVNode("text",{class:"iconfont icon-arrow-left picker-arrow"})])],40,["value","range"])])]),e.createElementVNode("view",{class:"input-field"},[e.createElementVNode("view",{class:"input-content"},[e.createElementVNode("text",{class:"iconfont icon-graduation"}),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"专业",class:"form-input","onUpdate:modelValue":a[5]||(a[5]=e=>g.major=e)},null,512),[[e.vModelText,g.major]])])]),e.createElementVNode("view",{class:"input-field"},[e.createElementVNode("view",{class:"input-content"},[e.createElementVNode("text",{class:"iconfont icon-graduation"}),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"学号",class:"form-input","onUpdate:modelValue":a[6]||(a[6]=e=>g.studentTeacherId=e)},null,512),[[e.vModelText,g.studentTeacherId]])])]),e.createElementVNode("button",{class:"login-btn",onClick:k,"hover-class":"btn-hover"},"注册"),e.createElementVNode("button",{class:"register-btn",onClick:f,"hover-class":"register-btn-hover"},"返回登录")])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"login-form"},[e.createElementVNode("view",{class:"input-field"},[e.createElementVNode("view",{class:"input-content"},[e.createElementVNode("text",{class:"iconfont icon-user"}),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"学号/手机号",class:"form-input","onUpdate:modelValue":a[0]||(a[0]=e=>h.phone=e)},null,512),[[e.vModelText,h.phone]])])]),e.createElementVNode("view",{class:"input-field"},[e.createElementVNode("view",{class:"input-content"},[e.createElementVNode("text",{class:"iconfont icon-user"}),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"密码",class:"form-input","onUpdate:modelValue":a[1]||(a[1]=e=>h.password=e),password:i.value},null,8,["password"]),[[e.vModelText,h.password]]),e.createElementVNode("text",{class:e.normalizeClass(["iconfont",i.value?"icon-eye-slash":"icon-eye"]),onClick:w},null,2)])]),e.createElementVNode("view",{class:"remember-row"},[e.createElementVNode("view",{class:"remember-me"},[e.createElementVNode("checkbox",{value:"1",checked:n.value,onClick:v,class:"remember-checkbox",color:"#4A90E2"},null,8,["checked"]),e.createElementVNode("text",{class:"remember-text"},"记住我")]),e.createElementVNode("text",{class:"forgot-password",onClick:E},"忘记密码?")]),e.createElementVNode("button",{class:"login-btn",onClick:y,"hover-class":"btn-hover"},"登录"),e.createElementVNode("button",{class:"register-btn",onClick:f,"hover-class":"register-btn-hover"},"注册新账号")])),l.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"other-login"},[e.createElementVNode("view",{class:"divider"},[e.createElementVNode("view",{class:"divider-line"}),e.createElementVNode("text",{class:"divider-text"},"其他登录方式"),e.createElementVNode("view",{class:"divider-line"})]),e.createElementVNode("view",{class:"social-buttons"},[e.createElementVNode("view",{class:"social-btn",onClick:a[7]||(a[7]=e=>V("wechat")),"hover-class":"social-btn-hover"},[e.createElementVNode("text",{class:"iconfont icon-weixin"})]),e.createElementVNode("view",{class:"social-btn",onClick:a[8]||(a[8]=e=>V("qq")),"hover-class":"social-btn-hover"},[e.createElementVNode("text",{class:"iconfont icon-qq"})]),e.createElementVNode("view",{class:"social-btn",onClick:a[9]||(a[9]=e=>V("phone")),"hover-class":"social-btn-hover"},[e.createElementVNode("text",{class:"iconfont icon-mobile"})])])])),e.createElementVNode("view",{class:"footer-text"},[e.createElementVNode("text",{class:"agreement-text"},e.toDisplayString(l.value?"注册即表示您同意我们的":"登录即表示您同意我们的"),1),e.createElementVNode("text",{class:"link-text",onClick:x},"服务条款"),e.createElementVNode("text",{class:"agreement-text"},"和"),e.createElementVNode("text",{class:"link-text",onClick:b},"隐私政策")])])]))}};class b{constructor(e,t){this.options=e,this.animation=uni.createAnimation({...e}),this.currentStepAnimates={},this.next=0,this.$=t}_nvuePushAnimates(e,t){let a=this.currentStepAnimates[this.next],n={};if(n=a||{styles:{},config:{}},T.includes(e)){n.styles.transform||(n.styles.transform="");let a="";"rotate"===e&&(a="deg"),n.styles.transform+=`${e}(${t+a}) `}else n.styles[e]=`${t}`;this.currentStepAnimates[this.next]=n}_animateRun(e={},t={}){let a=this.$.$refs.ani.ref;if(a)return new Promise(((n,i)=>{nvueAnimation.transition(a,{styles:e,...t},(e=>{n()}))}))}_nvueNextAnimate(e,t=0,a){let n=e[t];if(n){let{styles:i,config:l}=n;this._animateRun(i,l).then((()=>{t+=1,this._nvueNextAnimate(e,t,a)}))}else this.currentStepAnimates={},"function"==typeof a&&a(),this.isEnd=!0}step(e={}){return this.animation.step(e),this}run(e){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof e&&e()}),this.$.durationTime)}}const T=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function S(e,t){if(t)return clearTimeout(t.timer),new b(e,t)}T.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((e=>{b.prototype[e]=function(...t){return this.animation[e](...t),this}}));const C=(e,t)=>{const a=e.__vccOpts||e;for(const[n,i]of t)a[n]=i;return a};const D=C({name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""},onceRender:{type:Boolean,default:!1}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let e={...this.styles,"transition-duration":this.duration/1e3+"s"},t="";for(let a in e){t+=this.toLine(a)+":"+e[a]+";"}return t},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=S(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,a={}){if(this.animation){for(let a in e)try{"object"==typeof e[a]?this.animation[a](...e[a]):this.animation[a](e[a])}catch(n){t("error","at uni_modules/uni-transition/components/uni-transition/uni-transition.vue:148",`方法 ${a} 不存在`)}return this.animation.step(a),this}},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:e,transform:t}=this.styleInit(!1);void 0!==e&&(this.opacity=e),this.transform=t,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=S(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})}),20)}))},close(e){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:e,transform:t}=this.styleInit(!1);this.opacity=e||1,this.transform=t,this.$emit("change",{detail:this.isShow})}))},styleInit(e){let t={transform:""},a=(e,a)=>{"fade"===a?t.opacity=this.animationType(e)[a]:t.transform+=this.animationType(e)[a]+" "};return"string"==typeof this.modeClass?a(e,this.modeClass):this.modeClass.forEach((t=>{a(e,t)})),t},tranfromInit(e){let t=(e,t)=>{let a=null;"fade"===t?a=e?0:1:(a=e?"-100%":"0","zoom-in"===t&&(a=e?.8:1),"zoom-out"===t&&(a=e?1.2:1),"slide-right"===t&&(a=e?"100%":"0"),"slide-bottom"===t&&(a=e?"100%":"0")),this.animation[this.animationMode()[t]](a)};return"string"==typeof this.modeClass?t(e,this.modeClass):this.modeClass.forEach((a=>{t(e,a)})),this.animation},animationType:e=>({fade:e?0:1,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:e=>e.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(t,a,n,i,l,o){return e.withDirectives((e.openBlock(),e.createElementBlock("view",{ref:"ani",animation:l.animationData,class:e.normalizeClass(n.customClass),style:e.normalizeStyle(o.transformStyles),onClick:a[0]||(a[0]=(...e)=>o.onClick&&o.onClick(...e))},[e.renderSlot(t.$slots,"default")],14,["animation"])),[[e.vShow,l.isShow]])}]]);const B=C({name:"uniPopup",components:{},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},isMaskClick:{type:Boolean,default:null},maskClick:{type:Boolean,default:null},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBackgroundColor:{type:String,default:"rgba(0, 0, 0, 0.4)"},borderRadius:{type:String}},watch:{type:{handler:function(e){this.config[e]&&this[this.config[e]](!0)},immediate:!0},isDesktop:{handler:function(e){this.config[e]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(e){this.mkclick=e},immediate:!0},isMaskClick:{handler:function(e){this.mkclick=e},immediate:!0},showPopup(e){}},data(){return{duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},maskClass:{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)"},transClass:{backgroundColor:"transparent",borderRadius:this.borderRadius||"0",position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:"top"}},computed:{getStyles(){let e={backgroundColor:this.bg};return this.borderRadius,e=Object.assign(e,{borderRadius:this.borderRadius}),e},isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.backgroundColor||"none"===this.backgroundColor?"transparent":this.backgroundColor}},mounted(){(()=>{const{windowWidth:e,windowHeight:t,windowTop:a,safeArea:n,screenHeight:i,safeAreaInsets:l}=uni.getSystemInfoSync();this.popupWidth=e,this.popupHeight=t+(a||0),n&&this.safeArea?this.safeAreaInsets=l.bottom:this.safeAreaInsets=0})()},unmounted(){this.setH5Visible()},activated(){this.setH5Visible(!this.showPopup)},deactivated(){this.setH5Visible(!0)},created(){null===this.isMaskClick&&null===this.maskClick?this.mkclick=!0:this.mkclick=null!==this.isMaskClick?this.isMaskClick:this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1,this.maskClass.backgroundColor=this.maskBackgroundColor},methods:{setH5Visible(e=!0){},closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(e){e.stopPropagation(),this.clearPropagation=!0},open(e){if(this.showPopup)return;e&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(e)||(e=this.type),this.config[e]?(this[this.config[e]](),this.$emit("change",{show:!0,type:e})):t("error","at uni_modules/uni-popup/components/uni-popup/uni-popup.vue:298","缺少类型：",e)},close(e){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.mkclick&&this.close())},top(e){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},e||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.messageChild&&"message"===this.type&&this.messageChild.timerClose()})))},bottom(e){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets+"px",backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},e||(this.showPopup=!0,this.showTrans=!0)},center(e){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center",borderRadius:this.borderRadius||"0"},e||(this.showPopup=!0,this.showTrans=!0)},left(e){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},e||(this.showPopup=!0,this.showTrans=!0)},right(e){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},e||(this.showPopup=!0,this.showTrans=!0)}}},[["render",function(t,n,i,l,o,s){const r=a(e.resolveDynamicComponent("uni-transition"),D);return o.showPopup?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-popup",[o.popupstyle,s.isDesktop?"fixforpc-z-index":""]])},[e.createElementVNode("view",{onTouchstart:n[1]||(n[1]=(...e)=>s.touchstart&&s.touchstart(...e))},[o.maskShow?(e.openBlock(),e.createBlock(r,{key:"1",name:"mask","mode-class":"fade",styles:o.maskClass,duration:o.duration,show:o.showTrans,onClick:s.onTap},null,8,["styles","duration","show","onClick"])):e.createCommentVNode("",!0),e.createVNode(r,{key:"2","mode-class":o.ani,name:"content",styles:o.transClass,duration:o.duration,show:o.showTrans,onClick:s.onTap},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-popup__wrapper",[o.popupstyle]]),style:e.normalizeStyle(s.getStyles),onClick:n[0]||(n[0]=(...e)=>s.clear&&s.clear(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)])),_:3},8,["mode-class","styles","duration","show","onClick"])],32)],2)):e.createCommentVNode("",!0)}],["__scopeId","data-v-ee521468"]]),_=C({__name:"TeamCard",props:{team:{type:Object,required:!0},index:{type:Number,default:0}},emits:["detail","apply"],setup(t,{emit:a}){const n=t,i=a,l=e.computed((()=>.1*n.index+"s")),o=e.computed((()=>n.team.viewCount&&n.team.viewCount>100)),s=e.computed((()=>"0"===n.team.status||"招募中"===n.team.statusText)),r=e.computed((()=>{const e=n.team.status,t=n.team.statusText;return"0"===e||"招募中"===t?"status-recruiting":"1"===e||"进行中"===t?"status-ongoing":"2"===e||"已完成"===t?"status-completed":"3"===e||"已截止"===t?"status-ended":"status-default"})),c=e.computed((()=>n.team.positions||n.team.roles||[])),d=e.computed((()=>{if(n.team.avatars)return n.team.avatars;if(n.team.teamMemberAvatars){if("string"==typeof n.team.teamMemberAvatars)return n.team.teamMemberAvatars.split(",").filter((e=>e&&!e.includes(".pdf")));if(Array.isArray(n.team.teamMemberAvatars))return n.team.teamMemberAvatars.filter((e=>e&&!e.includes(".pdf")))}return[]})),u=e.computed((()=>"0"===n.team.status||"招募中"===n.team.statusText));function m(e){return p(e)>=h(e)}function p(e){return e.current||e.currentCount||0}function h(e){return e.total||e.requiredCount||0}function g(){i("detail",n.team.id)}function f(){g()}return e.computed((()=>"number"==typeof n.team.teamProgress)),e.computed((()=>null!==n.team.maxMemberCount&&n.team.maxMemberCount>0)),(a,i)=>(e.openBlock(),e.createElementBlock("view",{class:"team-item card-hover animate__animated animate__fadeInUp",style:e.normalizeStyle({"animation-delay":l.value}),onClick:g},[e.createElementVNode("view",{class:"team-top"},[e.createElementVNode("view",{class:"flex-between"},[e.createElementVNode("view",null,[e.createElementVNode("view",{class:"title-with-icon"},[e.createElementVNode("text",{class:"team-title"},e.toDisplayString(t.team.title||t.team.name),1),o.value?(e.openBlock(),e.createElementBlock("text",{key:0,class:"iconfont icon-spark hot-icon"})):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"view-count"},[e.createElementVNode("text",{class:"view-text"},e.toDisplayString(t.team.viewCount),1)])]),e.createElementVNode("view",{class:"tag-row"},[e.createElementVNode("text",{class:"tag orange-tag"},e.toDisplayString(t.team.competitionName),1)])]),e.createElementVNode("view",null,[e.createElementVNode("text",{class:e.normalizeClass(["status-tag",[{pulse:s.value},r.value]])},e.toDisplayString(t.team.statusText),3),e.createElementVNode("view",{class:"date-info"},"截止: "+e.toDisplayString(t.team.deadline||t.team.recruitmentDeadlineFormatted),1)])])]),c.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"role-tags"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"role-tag"},[e.createElementVNode("text",{class:"role-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:e.normalizeClass(["role-count",{success:m(t),warning:!m(t)}])},e.toDisplayString(p(t))+"/"+e.toDisplayString(h(t)),3)])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"team-desc"},e.toDisplayString(t.team.description),1),e.createElementVNode("view",{class:"team-bottom"},[e.createElementVNode("view",{class:"flex-center"},[e.createElementVNode("view",{class:"team-avatars"},[d.value&&d.value.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(d.value.slice(0,3),((t,a)=>(e.openBlock(),e.createElementBlock("image",{key:a,src:t,class:"team-avatar"},null,8,["src"])))),128)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-avatar"},[e.createElementVNode("text",{class:"iconfont icon-user"})]))]),e.createElementVNode("text",{class:"member-count"},e.toDisplayString(n.team.memberCount||n.team.currentMemberCount||0)+"人已加入",1)]),u.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"join-btn blue-join",onClick:e.withModifiers(f,["stop"])}," 招募中 ")):(e.openBlock(),e.createElementBlock("view",{key:1,class:"join-btn gray-join"}," 已组满 "))])],4))}},[["__scopeId","data-v-8ca6821e"]]),M=C({__name:"TabBar",props:{activeTab:{type:String,default:"home",validator:e=>["home","competition","task-square","team","profile"].includes(e)}},emits:["tab-change","publish"],setup(a,{emit:n}){const i=a,l=e.ref("");e.onMounted((()=>{uni.getStorageSync("token")&&async function(){try{const e=await u.getUserRole();200===e.code&&e.data&&(l.value=e.data,t("log","at components/TabBar.vue:70","当前用户角色:",l.value))}catch(e){t("error","at components/TabBar.vue:73","获取用户角色失败:",e)}}()}));const o=e.computed((()=>!1)),s=n;function r(e){if(e!==i.activeTab){const a={home:"/pages/index/index",competition:"/pages/competition/index","task-square":"/pages/task-square/index",team:"/pages/team/list",profile:"/pages/profile/index"};uni.switchTab({url:a[e],fail:a=>{t("error","at components/TabBar.vue:107","切换Tab失败:",a),s("tab-change",e)}})}}function c(){const e=uni.getStorageSync("token");e?(t("log","at components/TabBar.vue:135","当前token:",e),l.value?(t("log","at components/TabBar.vue:157","使用缓存角色信息:",l.value),d()):(t("log","at components/TabBar.vue:139","开始获取用户角色..."),u.getUserRole(e).then((e=>{t("log","at components/TabBar.vue:141","获取角色成功, 完整响应:",e),200===e.code&&e.data?(l.value=e.data,t("log","at components/TabBar.vue:144","设置当前用户角色:",l.value),d()):(t("warn","at components/TabBar.vue:147","获取角色返回异常:",e),d())})).catch((e=>{t("error","at components/TabBar.vue:151","获取用户角色失败:",e),t("error","at components/TabBar.vue:152","错误详情:",JSON.stringify(e)),d()})))):uni.showModal({title:"提示",content:"请先登录后再操作",confirmText:"去登录",success:function(e){e.confirm&&uni.navigateTo({url:"/pages/login/login"})}})}function d(){const e=[];"admin"===l.value&&e.push({text:"创建竞赛",action:()=>{uni.navigateTo({url:"/pages/competition/create"})}}),e.push({text:"创建队伍",action:()=>{uni.navigateTo({url:"/pages/team/create"})}},{text:"发布任务",action:()=>{uni.navigateTo({url:"/pages/task-square/create"})}});const t=e.map((e=>e.text));uni.showActionSheet({itemList:t,success:function(t){const a=t.tapIndex;a>=0&&a<e.length&&e[a].action()}})}return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["tab-bar",{"dark-mode":o.value}])},[e.createElementVNode("view",{class:e.normalizeClass(["tab-item",{active:"home"===a.activeTab}]),onClick:n[0]||(n[0]=e=>r("home"))},[e.createElementVNode("text",{class:"iconfont icon-home"}),e.createElementVNode("text",{class:"tab-text"},"首页"),"home"===a.activeTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"active-indicator"})):e.createCommentVNode("",!0)],2),e.createElementVNode("view",{class:e.normalizeClass(["tab-item",{active:"competition"===a.activeTab}]),onClick:n[1]||(n[1]=e=>r("competition"))},[e.createElementVNode("text",{class:"iconfont icon-trophy"}),e.createElementVNode("text",{class:"tab-text"},"竞赛"),"competition"===a.activeTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"active-indicator"})):e.createCommentVNode("",!0)],2),e.createElementVNode("view",{class:"publish-btn-container"},[e.createElementVNode("view",{class:"publish-btn pulse",onClick:c},[e.createElementVNode("text",{class:"iconfont icon-plus"})])]),e.createElementVNode("view",{class:e.normalizeClass(["tab-item",{active:"team"===a.activeTab}]),onClick:n[2]||(n[2]=e=>r("team"))},[e.createElementVNode("text",{class:"iconfont icon-users"}),e.createElementVNode("text",{class:"tab-text"},"队伍"),"team"===a.activeTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"active-indicator"})):e.createCommentVNode("",!0)],2),e.createElementVNode("view",{class:e.normalizeClass(["tab-item",{active:"profile"===a.activeTab}]),onClick:n[3]||(n[3]=e=>r("profile"))},[e.createElementVNode("text",{class:"iconfont icon-user"}),e.createElementVNode("text",{class:"tab-text"},"我的"),"profile"===a.activeTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"active-indicator"})):e.createCommentVNode("",!0)],2)],2))}},[["__scopeId","data-v-d3e5d2bd"]]),I=C({__name:"HeaderBar",props:{title:{type:String,default:"页面标题"},showSearch:{type:Boolean,default:!0},showFilter:{type:Boolean,default:!1},categories:{type:Array,default:()=>[]},defaultCategory:{type:Number,default:0}},emits:["search","filter","category-change"],setup(t,{expose:a,emit:n}){const i=t,l=e.ref(i.defaultCategory),o=e.computed((()=>{let e=90;return i.categories&&i.categories.length>0&&(e+=70),e})),s=n;function r(){s("search")}function c(){uni.navigateTo({url:"/pages/Xiaoxi/Xiaoxi"})}a({headerHeight:o});let d=e.ref(0);return e.onMounted((()=>{uni.getSystemInfo({success:e=>{e.safeArea&&e.safeArea.top&&(d.value=e.safeArea.top)}})})),(a,n)=>(e.openBlock(),e.createElementBlock("view",{class:"sticky-header"},[e.createElementVNode("view",{class:"header-title"},[e.createElementVNode("text",{class:"section-title"},e.toDisplayString(t.title),1),e.createElementVNode("view",{class:"header-actions"},[t.showSearch?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-btn",onClick:r},[e.createElementVNode("text",{class:"iconfont icon-search"})])):e.createCommentVNode("",!0),t.showFilter?(e.openBlock(),e.createElementBlock("view",{key:1,class:"action-btn",onClick:c},[e.createElementVNode("text",{class:"iconfont icon-filter"})])):e.createCommentVNode("",!0),e.renderSlot(a.$slots,"actions",{},void 0,!0)])]),t.categories&&t.categories.length>0?(e.openBlock(),e.createElementBlock("scroll-view",{key:0,"scroll-x":"true",class:"category-scroll"},[e.createElementVNode("view",{class:"category-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.categories,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["category-item",l.value===a?"active-category":""]),onClick:e=>function(e){l.value!==e&&(l.value=e,s("category-change",e))}(a)},[e.createElementVNode("text",null,e.toDisplayString(t),1)],10,["onClick"])))),128))])])):e.createCommentVNode("",!0),e.renderSlot(a.$slots,"default",{},void 0,!0)]))}},[["__scopeId","data-v-a010500b"]]),A={__name:"index",setup(n){const i=e.ref(null);e.computed((()=>i.value&&i.value.headerHeight?i.value.headerHeight+"rpx":"120rpx"));const l=e.ref([]),o=e.ref([]),s=e.ref(!1),r=e.ref(null),c=e.ref("希望加入您的团队，请审核"),d=e.ref(null),u=e.ref([]),h=e.ref(!1);function g(e){"competition"===e?uni.navigateTo({url:"/pages/competition/index"}):"task-square"===e?uni.switchTab({url:"/pages/task-square/index"}):uni.showToast({title:`导航到${e}页面`,icon:"none"})}function f(e){"competition"===e?uni.navigateTo({url:"/pages/competition/index"}):uni.showToast({title:`查看所有${e}`,icon:"none"})}function v(e,t){"competition"===e?uni.navigateTo({url:`/pages/competition/detail?id=${t}`}):uni.navigateTo({url:`/pages/team/detail?id=${t}`})}async function w(e){try{h.value=!0,r.value=e;const t=await m.checkTeamStatus(e);if(200===t.code&&t.data){if(t.data.isApplied)return void uni.showToast({title:"您已经申请过该队伍",icon:"none"});if(t.data.isMember)return void uni.showToast({title:"您已经是该队伍成员",icon:"none"})}const a=await m.getTeamDetail(e);if(200!==a.code||!a.data)return void uni.showToast({title:"获取队伍信息失败",icon:"none"});if(u.value=a.data.roles||[],0===u.value.length)return void uni.showToast({title:"该队伍暂无可申请的角色",icon:"none"});u.value[0]&&(d.value=u.value[0].id),s.value=!0}catch(a){uni.showToast({title:"操作失败，请稍后重试",icon:"none"}),t("error","at pages/index/index.vue:371","获取队伍角色失败:",a)}finally{h.value=!1}}async function y(){if(d.value)if(c.value.trim())try{uni.showLoading({title:"提交中..."});const e=u.value.find((e=>e.id===d.value));if(e&&e.count<=e.filled)return uni.hideLoading(),void uni.showToast({title:"该角色已满员",icon:"none"});const a={teamId:Number(r.value),roleId:Number(d.value),message:c.value.trim()};t("log","at pages/index/index.vue:419","申请加入队伍:",a);const n=await m.applyTeam(a);uni.hideLoading(),200===n.code?(uni.showToast({title:"申请已发送",icon:"success"}),k(),s.value=!1):uni.showToast({title:n.message||"申请失败",icon:"none"})}catch(e){uni.hideLoading(),t("error","at pages/index/index.vue:442","申请加入队伍失败:",e),uni.showToast({title:e.message||"申请提交失败，请稍后重试",icon:"none"})}else uni.showToast({title:"请输入申请留言",icon:"none"});else uni.showToast({title:"请选择申请角色",icon:"none"})}function k(){s.value=!1,r.value=null,d.value=null,c.value="希望加入您的团队，请审核",u.value=[]}function E(){uni.navigateTo({url:"/pages/search/index"})}function V(e){switch(e){case"0":return"status-not-started";case"1":return"status-recruiting";case"2":return"status-ongoing";case"3":return"status-ended";default:return""}}return e.watch(s,(t=>{const a=uni.createSelectorQuery().in(e.getCurrentInstance()).select(".uni-popup");a&&setTimeout((()=>{a.node((e=>{e&&e.node&&(t?e.node.open&&e.node.open():e.node.close&&e.node.close())})).exec()}),0)})),e.onMounted((()=>{t("log","at pages/index/index.vue:505","状态栏高度:",uni.getSystemInfoSync().statusBarHeight),async function(){try{const e=await m.getTeamList();200===e.code&&e.data&&e.data.list&&(l.value=e.data.list.slice(0,10),t("log","at pages/index/index.vue:261","获取到队伍列表数据:",l.value))}catch(e){t("error","at pages/index/index.vue:264","获取队伍数据失败:",e)}}(),async function(){try{const e=await p.getCompetitionsList({isHot:!0,pageSize:3});200===e.code&&e.data&&e.data.list&&(o.value=e.data.list,t("log","at pages/index/index.vue:248","获取到热门竞赛数据:",o.value))}catch(e){t("error","at pages/index/index.vue:251","获取竞赛数据失败:",e)}}()})),(t,n)=>{const r=a(e.resolveDynamicComponent("uni-popup"),B);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(I,{ref_key:"headerBarRef",ref:i,title:"校园任务与组队平台",onSearch:E},null,512),e.createElementVNode("scroll-view",{"scroll-y":"",class:"content-scroll"},[e.createElementVNode("view",{class:"swiper-container"},[e.createElementVNode("swiper",{class:"swiper animate__animated animate__fadeIn",circular:"",autoplay:"",interval:"3000",duration:"500","indicator-dots":"","indicator-active-color":"#247ae4","indicator-color":"rgba(0, 0, 0, 0.2)"},[e.createElementVNode("swiper-item",null,[e.createElementVNode("view",{class:"swiper-item"},[e.createElementVNode("image",{src:"https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?w=800",mode:"aspectFill"}),e.createElementVNode("view",{class:"swiper-overlay"},[e.createElementVNode("text",{class:"swiper-title"},"中国大学生计算机设计大赛(第18届)"),e.createElementVNode("view",{class:"swiper-date"},[e.createElementVNode("text",{class:"iconfont icon-calendar date-icon"}),e.createElementVNode("text",{class:"date-text"},"报名截止：5月15日")])])])]),e.createElementVNode("swiper-item",null,[e.createElementVNode("view",{class:"swiper-item"},[e.createElementVNode("image",{src:"https://images.unsplash.com/photo-1523240795612-9a054b0db644?w=800",mode:"aspectFill"}),e.createElementVNode("view",{class:"swiper-overlay"},[e.createElementVNode("text",{class:"swiper-title"},"挑战杯创业计划大赛"),e.createElementVNode("view",{class:"swiper-date"},[e.createElementVNode("text",{class:"iconfont icon-calendar date-icon"}),e.createElementVNode("text",{class:"date-text"},"报名截止：6月10日")])])])]),e.createElementVNode("swiper-item",null,[e.createElementVNode("view",{class:"swiper-item"},[e.createElementVNode("image",{src:"https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=800",mode:"aspectFill"}),e.createElementVNode("view",{class:"swiper-overlay"},[e.createElementVNode("text",{class:"swiper-title"},"创青春创业大赛"),e.createElementVNode("view",{class:"swiper-date"},[e.createElementVNode("text",{class:"iconfont icon-calendar date-icon"}),e.createElementVNode("text",{class:"date-text"},"报名截止：7月5日")])])])])])]),e.createElementVNode("view",{class:"menu-container"},[e.createElementVNode("view",{class:"menu-grid"},[e.createElementVNode("view",{class:"menu-item animate__animated animate__fadeInUp",style:{"animation-delay":"0.1s"},onClick:n[0]||(n[0]=e=>g("task-square"))},[e.createElementVNode("view",{class:"menu-icon blue"},[e.createElementVNode("text",{class:"iconfont icon-trophy"})]),e.createElementVNode("text",{class:"menu-text"},"校园委托")]),e.createElementVNode("view",{class:"menu-item animate__animated animate__fadeInUp",style:{"animation-delay":"0.2s"},onClick:n[1]||(n[1]=e=>g("findPartner"))},[e.createElementVNode("view",{class:"menu-icon green"},[e.createElementVNode("text",{class:"iconfont icon-users"})]),e.createElementVNode("text",{class:"menu-text"},"寻找队友")]),e.createElementVNode("view",{class:"menu-item animate__animated animate__fadeInUp",style:{"animation-delay":"0.3s"},onClick:n[2]||(n[2]=e=>g("project"))},[e.createElementVNode("view",{class:"menu-icon purple"},[e.createElementVNode("text",{class:"iconfont icon-project"})]),e.createElementVNode("text",{class:"menu-text"},"项目展示")]),e.createElementVNode("view",{class:"menu-item animate__animated animate__fadeInUp",style:{"animation-delay":"0.4s"},onClick:n[3]||(n[3]=e=>g("schedule"))},[e.createElementVNode("view",{class:"menu-icon orange"},[e.createElementVNode("text",{class:"iconfont icon-calendar"})]),e.createElementVNode("text",{class:"menu-text"},"日程安排")])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title animate__animated animate__fadeInLeft"},"热门竞赛"),e.createElementVNode("text",{class:"view-all animate__animated animate__fadeInRight",onClick:n[4]||(n[4]=e=>f("competition"))},"查看全部")]),e.createElementVNode("view",{class:"competition-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value,(t=>(e.openBlock(),e.createElementBlock("view",{class:"competition-item card-hover animate__animated animate__fadeInUp",style:{"animation-delay":"0.1s"},onClick:e=>v("competition",t.id),key:t.id},[e.createElementVNode("view",{class:"competition-flex"},[e.createElementVNode("view",{class:"competition-image-container"},[e.createElementVNode("image",{class:"competition-image",src:t.coverImageUrl||"https://images.unsplash.com/photo-1523240795612-9a054b0db644?w=800",mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"competition-content"},[e.createElementVNode("view",{class:"flex-between"},[e.createElementVNode("text",{class:"competition-title"},e.toDisplayString(t.title),1),e.createElementVNode("view",{class:"status-wrapper"},[e.createElementVNode("text",{class:e.normalizeClass(["status-tag pulse",V(t.status)])},e.toDisplayString(t.statusText),3)])]),e.createElementVNode("view",{class:"tag-row"},[t.categoryNames&&t.categoryNames.length>0?(e.openBlock(),e.createElementBlock("text",{key:0,class:"tag green-tag"},e.toDisplayString(t.categoryNames[0]),1)):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"tag gray-tag"},e.toDisplayString(t.level),1)]),e.createElementVNode("view",{class:"competition-info"},[e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"iconfont icon-clock"}),e.createElementVNode("text",{class:"info-text"},"报名截止: "+e.toDisplayString(t.registrationDeadlineFormatted),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"iconfont icon-team"}),e.createElementVNode("text",{class:"info-text"},e.toDisplayString(t.teamSize)+"-"+e.toDisplayString(t.teamMax)+"人/队",1)])])])])],8,["onClick"])))),128))])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title animate__animated animate__fadeInLeft"},"热门队伍"),e.createElementVNode("text",{class:"view-all animate__animated animate__fadeInRight",onClick:n[5]||(n[5]=e=>f("team"))},"查看全部")]),e.createElementVNode("view",{class:"team-list"},[l.value.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(l.value,((t,a)=>(e.openBlock(),e.createBlock(_,{key:t.id,team:t,index:a,onDetail:n[6]||(n[6]=e=>v("team",e)),onApply:w},null,8,["team","index"])))),128)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("text",{class:"empty-text"},"加载中...")]))])])]),e.createVNode(M,{activeTab:"home"}),e.createVNode(r,{ref:"applyPopup",type:"center",show:s.value,onChange:n[10]||(n[10]=e=>{e.show||k()})},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"apply-popup"},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"申请加入团队"),e.createElementVNode("text",{class:"close-icon",onClick:n[7]||(n[7]=e=>s.value=!1)},"×")]),e.createElementVNode("view",{class:"popup-content"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"申请角色"),e.createElementVNode("view",{class:"role-select"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["role-option",d.value===t.id?"role-selected":""]),onClick:e=>d.value=t.id},[e.createElementVNode("text",{class:"role-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"role-count"},e.toDisplayString(t.filled)+"/"+e.toDisplayString(t.count)+"人",1)],10,["onClick"])))),128))])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("申请留言 "),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("textarea",{class:"message-input","onUpdate:modelValue":n[8]||(n[8]=e=>c.value=e),placeholder:"请输入申请留言",maxlength:"100"},null,512),[[e.vModelText,c.value]]),e.createElementVNode("text",{class:"char-count"},e.toDisplayString(c.value.length)+"/100",1)])]),e.createElementVNode("view",{class:"popup-footer"},[e.createElementVNode("button",{class:"cancel-btn",onClick:n[9]||(n[9]=e=>s.value=!1)},"取消"),e.createElementVNode("button",{class:"submit-btn",onClick:y,disabled:!c.value},"提交申请",8,["disabled"])])])])),_:1},8,["show"])])}}},R=["{","}"];const P=/^(?:\d)+/,L=/^(?:\w)+/;const $="zh-Hans",F="zh-Hant",z="en",U=Object.prototype.hasOwnProperty,j=(e,t)=>U.call(e,t),q=new class{constructor(){this._caches=Object.create(null)}interpolate(e,t,a=R){if(!t)return[e];let n=this._caches[e];return n||(n=function(e,[t,a]){const n=[];let i=0,l="";for(;i<e.length;){let o=e[i++];if(o===t){l&&n.push({type:"text",value:l}),l="";let t="";for(o=e[i++];void 0!==o&&o!==a;)t+=o,o=e[i++];const s=o===a,r=P.test(t)?"list":s&&L.test(t)?"named":"unknown";n.push({value:t,type:r})}else l+=o}return l&&n.push({type:"text",value:l}),n}(e,a),this._caches[e]=n),function(e,t){const a=[];let n=0;const i=Array.isArray(t)?"list":(l=t,null!==l&&"object"==typeof l?"named":"unknown");var l;if("unknown"===i)return a;for(;n<e.length;){const l=e[n];switch(l.type){case"text":a.push(l.value);break;case"list":a.push(t[parseInt(l.value,10)]);break;case"named":"named"===i&&a.push(t[l.value])}n++}return a}(n,t)}};function H(e,t){if(!e)return;if(e=e.trim().replace(/_/g,"-"),t&&t[e])return e;if("chinese"===(e=e.toLowerCase()))return $;if(0===e.indexOf("zh"))return e.indexOf("-hans")>-1?$:e.indexOf("-hant")>-1?F:(a=e,["-tw","-hk","-mo","-cht"].find((e=>-1!==a.indexOf(e)))?F:$);var a;let n=[z,"fr","es"];t&&Object.keys(t).length>0&&(n=Object.keys(t));const i=function(e,t){return t.find((t=>0===e.indexOf(t)))}(e,n);return i||void 0}class O{constructor({locale:e,fallbackLocale:t,messages:a,watcher:n,formater:i}){this.locale=z,this.fallbackLocale=z,this.message={},this.messages={},this.watchers=[],t&&(this.fallbackLocale=t),this.formater=i||q,this.messages=a||{},this.setLocale(e||z),n&&this.watchLocale(n)}setLocale(e){const t=this.locale;this.locale=H(e,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],t!==this.locale&&this.watchers.forEach((e=>{e(this.locale,t)}))}getLocale(){return this.locale}watchLocale(e){const t=this.watchers.push(e)-1;return()=>{this.watchers.splice(t,1)}}add(e,t,a=!0){const n=this.messages[e];n?a?Object.assign(n,t):Object.keys(t).forEach((e=>{j(n,e)||(n[e]=t[e])})):this.messages[e]=t}f(e,t,a){return this.formater.interpolate(e,t,a).join("")}t(e,t,a){let n=this.message;return"string"==typeof t?(t=H(t,this.messages))&&(n=this.messages[t]):a=t,j(n,e)?this.formater.interpolate(n[e],a).join(""):(console.warn(`Cannot translate the value of keypath ${e}. Use the value of keypath as default.`),e)}}function G(e,t={},a,n){if("string"!=typeof e){const a=[t,e];e=a[0],t=a[1]}"string"!=typeof e&&(e="undefined"!=typeof uni&&uni.getLocale?uni.getLocale():"undefined"!=typeof global&&global.getLocale?global.getLocale():z),"string"!=typeof a&&(a="undefined"!=typeof __uniConfig&&__uniConfig.fallbackLocale||z);const i=new O({locale:e,fallbackLocale:a,messages:t,watcher:n});let l=(e,t)=>{if("function"!=typeof getApp)l=function(e,t){return i.t(e,t)};else{let e=!1;l=function(t,a){const n=getApp().$vm;return n&&(n.$locale,e||(e=!0,function(e,t){e.$watchLocale?e.$watchLocale((e=>{t.setLocale(e)})):e.$watch((()=>e.$locale),(e=>{t.setLocale(e)}))}(n,i))),i.t(t,a)}}return l(e,t)};return{i18n:i,f:(e,t,a)=>i.f(e,t,a),t:(e,t)=>l(e,t),add:(e,t,a=!0)=>i.add(e,t,a),watch:e=>i.watchLocale(e),getLocale:()=>i.getLocale(),setLocale:e=>i.setLocale(e)}}const W={en:{"uni-load-more.contentdown":"Pull up to show more","uni-load-more.contentrefresh":"loading...","uni-load-more.contentnomore":"No more data"},"zh-Hans":{"uni-load-more.contentdown":"上拉显示更多","uni-load-more.contentrefresh":"正在加载...","uni-load-more.contentnomore":"没有更多数据了"},"zh-Hant":{"uni-load-more.contentdown":"上拉顯示更多","uni-load-more.contentrefresh":"正在加載...","uni-load-more.contentnomore":"沒有更多數據了"}};let Y;setTimeout((()=>{Y=uni.getSystemInfoSync().platform}),16);const{t:J}=G(W);const Q=C({name:"UniLoadMore",emits:["clickLoadMore"],props:{status:{type:String,default:"more"},showIcon:{type:Boolean,default:!0},iconType:{type:String,default:"auto"},iconSize:{type:Number,default:24},color:{type:String,default:"#777777"},contentText:{type:Object,default:()=>({contentdown:"",contentrefresh:"",contentnomore:""})},showText:{type:Boolean,default:!0}},data:()=>({webviewHide:!1,platform:Y,imgBase64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzlBMzU3OTlEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzlBMzU3OUFEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDOUEzNTc5N0Q5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDOUEzNTc5OEQ5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pt+ALSwAAA6CSURBVHja1FsLkFZVHb98LM+F5bHL8khA1iSeiyQBCRM+YGqKUnnJTDLGI0BGZlKDIU2MMglUiDApEZvSsZnQtBRJtKwQNKQMFYeRDR10WOLd8ljYXdh+v8v5fR3Od+797t1dnOnO/Ofce77z+J//+b/P+ZqtXbs2sJ9MJhNUV1cHJ06cCJo3bx7EPc2aNcvpy7pWrVoF+/fvDyoqKoI2bdoE9fX1F7TjN8a+EXBn/fkfvw942Tf+wYMHg9mzZwfjxo0LDhw4EPa1x2MbFw/fOGfPng1qa2tzcCkILsLDydq2bRsunpOTMM7TD/W/tZDZhPdeKD+yGxHhdu3aBV27dg3OnDlzMVANMheLAO3btw8KCwuDmpoaX5OxbgUIMEq7K8IcPnw4KCsrC/r37x8cP378/4cAXAB3vqSkJMuiDhTkw+XcuXNhOWbMmKBly5YhUT8xArhyFvP0BfwRsAuwxJZJsm/nzp2DTp06he/OU+cZ64K6o0ePBkOHDg2GDx8e6gEbJ5Q/NHNuAJQ1hgBeHUDlR7nVTkY8rQAvAi4z34vR/mPs1FoRsaCgIJThI0eOBC1atEiFGGV+5MiRoS45efJkqFjJFXV1dQuA012m2WcwTw98fy6CqBdsaiIO4CScrGPHjvk4odhavPquRtFWXEC25VgkREKOCh/qDSq+vn37htzD/mZTOmOc5U7zKzBPEedygWshcDyWvs30igAbU+6oyMgJBCFhwQE0fccxN60Ay9iebbjoDh06hMowjQxT4fXq1SskArmHZpkArvixp/kWzHdMeArExSJEaiXIjjRjRJ4DaAGWpibLzXN3Fm1vA5teBgh3j1Rv3bp1YgKwPdmf2p9zcyNYYgPKMfY0T5f5nNYdw158nJ8QawW4CLKwiOBSEgO/hok2eBydR+3dYH+PLxA5J8Vv0KBBwenTp0P2JWAx6+yFEBfs8lMY+y0SWMBNI9E4ThKi58VKTg3FQZS1RQF1cz27eC0QHMu+3E0SkUowjhVt5VdaWhp07949ZHv2Qd1EjDXM2cla1M0nl3GxAs3J9yREzyTdFVKVFOaE9qRA8GM0WebRuo9JGZKA7Mv2SeS/Z8+eoQ9BArMfFrLGo6jvxbhHbJZnKX2Rzz1O7QhJJ9Cs2ZMaWIyq/zhdeqPNfIoHd58clIQD+JSXl4dKlyIAuBdVXZwFVWKspSSoxE++h8x4k3uCnEhE4I5KwRiFWGOU0QWKiCYLbdoRMRKAu2kQ9vkfLU6dOhX06NEjlH+yMRZSinnuyWnYosVcji8CEA/6Cg2JF+IIUBqnGKUTCNwtwBN4f89RiK1R96DEgO2o0NDmtEdvVFdVVYV+P3UAPUEs6GFwV3PHmXkD4vh74iDFJysVI/MlaQhwKeBNTLYX5VuA8T4/gZxA4MRGFxDB6R7OmYPfyykGRJbyie+XnGYnQIC/coH9+vULiYrxrkL9ZA9+0ykaHIfEpM7ge8TiJ2CsHYwyMfafAF1yCGBHYIbCVDjDjKt7BeB51D+LgQa6OkG7IDYEEtvQ7lnXLKLtLdLuJBpE4gPUXcW2+PkZwOex+4cGDhwYDBkyRL7/HFcEwUGPo/8uWRUpYnfxGHco8HkewLHLyYmAawAPuIFZxhOpDfJQ8gbUv41yORAptMWBNr6oqMhWird5+u+iHmBb2nhjDV7HWBNQTgK8y11l5NetWzc5ULscAtSj7nbNI0skhWeUZCc0W4nyH/jO4Vz0u1IeYhbk4AiwM6tjxIWByHsoZ9qcIBPJd/y+DwPfBESOmCa/QF3WiZHucLlEDpNxcNhmheEOPgdQNx6/VZFQzFZ5TN08AHXQt2Ii3EdyFuUsPtTcGPhW5iMiCNELvz+Gdn9huG4HUJaW/w3g0wxV0XaG7arG2WeKiUWYM4Y7GO5ezshTARbbWGw/DvXkpp/ivVvE0JVoMxN4rpGzJMhE5Pl+xlATsDIqikP9F9D2z3h9nOksEUFhK+qO4rcPkoalMQ/HqJLIyb3F3JdjrCcw1yZ8joyJLR5gCo54etlag7qIoeNh1N1BRYj3DTFJ0elotxPlVzkGuYAmL0VSJVGAJA41c4Z6A3BzTLfn0HYwYKEI6CUAMzZEWvLsIcQOo1AmmyyM72nHJCfYsogflGV6jEk9vyQZXSuq6w4c16NsGcGZbwOPr+H1RkOk2LEzjNepxQkihHSCQ4ynAYNRx2zMKV92CQMWqj8J0BRE8EShxRFN6YrfCRhC0x3r/Zm4IbQCcmJoV0kMamllccR6FjHqUC5F2R/wS2dcymOlfAKOS4KmzQb5cpNC2MC7JhVn5wjXoJ44rYhLh8n0eXOCorJxa7POjbSlCGVczr34/RsAmrcvo9s+wGp3tzVhntxiXiJ4nvEYb4FJkf0O8HocAePmLvCxnL0AORraVekJk6TYjDabRVXfRE2lCN1h6ZQRN1+InUbsCpKwoBZHh0dODN9JBCUffItXxEavTQkUtnfTVAplCWL3JISz29h4NjotnuSsQKJCk8dF+kJR6RARjrqFVmfPnj3ZbK8cIJ0msd6jgHPGtfVTQ8VLmlvh4mct9sobRmPic0DyDQQnx/NlfYUgyz59+oScsH379pAwXABD32nTpoUHIToESeI5mnbE/UqDdyLcafEBf2MCqgC7NwxIbMREJQ0g4D4sfJwnD+AmRrII05cfMWJE+L1169bQr+fip06dGp4oJ83lmYd5wj/EmMa4TaHivo4EeCguYZBnkB5g2aWA69OIEnUHOaGysjIYMGBAMGnSpODYsWPZwCpFmm4lNq+4gSLQA7jcX8DwtjEyRC8wjabnXEx9kfWnTJkSJkAo90xpJVV+FmcVNeYAF5zWngS4C4O91MBxmAv8blLEpbjI5sz9MTdAhcgkCT1RO8mZkAjfiYpTEvStAS53Uw1vAiUGgZ3GpuQEYvoiBqlIan7kSDHnTwJQFNiPu0+5VxCVYhcZIjNrdXUDdp+Eq5AZ3Gkg8QAyVZRZIk4Tl4QAbF9cXJxNYZMAtAokgs4BrNxEpCtteXg7DDTMDKYNSuQdKsnJBek7HxewvxaosWxLYXtw+cJp18217wql4aKCfBNoEu0O5VU+PhctJ0YeXD4C6JQpyrlpSLTojpGGGN5YwNziChdIZLk4lvLcFJ9jMX3QdiImY9bmGQU+TRUL5CHITTRlgF8D9ouD1MfmLoEPl5xokIumZ2cfgMpHt47IW9N64Hsh7wQYYjyIugWuF5fCqYncXRd5vPMWyizzvhi/32+nvG0dZc9vR6fZOu0md5e+uC408FvKSIOZwXlGvxPv95izA2Vtvg1xKFWARI+vMX66HUhpQQb643uW1bSjuTWyw2SBvDrBvjFic1eGGlz5esq3ko9uSIlBRqPuFcCv8F4WIcN12nVaBd0SaYwI6PDDImR11JkqgHcPmQssjxIn6bUshygDFJUTxPMpHk+jfjPgupgdnYV2R/g7xSjtpah8RJBewhwf0gGK6XI92u4wXFEU40afJ4DN4h5LcAd+40HI3JgJecuT0c062W0i2hQJUTcxan3/CMW1PF2K6bbA+Daz4xRs1D3Br1Cm0OihKCqizW78/nXAF/G5TXrEcVzaNMH6CyMswqsAHqDyDLEyou8lwOXnKF8DjI6KjV3KzMBiXkDH8ij/H214J5A596ekrZ3F0zXlWeL7+P5eUrNo3/QwC15uxthuzidy7DzKRwEDaAViiDgKbTbz7CJnzo0bN7pIfIiid8SuPwn25o3QCmpnyjlZkyxPP8EomCJzrGb7GJMx7tNsq4MT2xMUYaiErZOluTzKsnz3gwCeCZyVRZJfYplNEokEjwrPtxlxjeYAk+F1F74VAzPxQRNYYdtpOUvWs8J1sGhBJMNsb7igN8plJs1eSmLIhLKE4rvaCX27gOhLpLOsIzJ7qn/i+wZzcvSOZ23/du8TZjwV8zHIXoP4R3ifBxiFz1dcVpa3aPntPE+c6TmIWE9EtcMmAcPdWAhYhAXxcLOQi9L1WhD1Sc8p1d2oL7XGiRKp8F4A2i8K/nfI+y/gsTDJ/YC/8+AD5Uh04KHiGl+cIFPnBDDrPMjwRGkLXyxO4VGbfQWnDH2v0bVWE3C9QOXlepbgjEfIJQI6XDG3z5ahD9cw2pS78ipB85wyScNTvsVzlzzhL8/jRrnmVjfFJK/m3m4nj9vbgQTguT8XZTjsm672R5uJKEaQmBI/c58gyus8ZDagLpEVSJBIyHp4jn++xqPV71OgQgJYEWOtZ/haxRtKmWOBu8xdBLftWltsY84zE6WIEy/eIOWL+BaayMx+KHtL7EAkqdNDLiEXmEMUHniedtJqg9HmZtfvt26vNi0BdG3Ft3g8ZOf7PAu59TxtzivLNIekyi+wD1i8CuUiD9FXAa8C+/xS3JPmZnomyc7H+fb4/Se0bk41Fel621r4cgVxbq91V4jVqwB7HTe2M7jgB+QWHavZkDRPmZcASoZEmBx6i75bGjPcMdL4/VKGFAGWZkGzPG0XAbdL9A81G5LOmUnC9hHKJeO7dcUMjblSl12867ElFTtaGl20xvvLGPdVz/8TVuU7y0x1PG7vtNg24oz9Uo/Z412++VFWI7Fcog9tu9Lm6gvRmIPv9x1xmQAu6RDkXtbOtlGEmpgD5Nvnyc0dcv0EE6cfdi1HmhMf9wDF3k3gtRvEedhxjpgfqPb9PU9iEJHnyOUA7bQUXh6kq/D7l2iTjWv7XOD530BDr8jIrus+srXjt4MzumJMHuTsBa63YKE1+RR5lBjEikCCnWKWiHdzOgKO+nRIBAF88za/IFmJ3eMZov4CYxGBabcpGL8EYx+SeMXJeRwHNsV/h+vdxeuhEpN3ZyNY78Gm2fknJxVGhyjixPiQvVkNzT1elD9Py/aTAL64Hb9vcYmC9zfdXdT/C1LeGbg4rnBaAihDFJH12W5ulfNCNe/xTsP3bp8ikzJs5BF+5PNfAQYAPaseTdsEcaYAAAAASUVORK5CYII="}),computed:{iconSnowWidth(){return 2*(Math.floor(this.iconSize/24)||1)},contentdownText(){return this.contentText.contentdown||J("uni-load-more.contentdown")},contentrefreshText(){return this.contentText.contentrefresh||J("uni-load-more.contentrefresh")},contentnomoreText(){return this.contentText.contentnomore||J("uni-load-more.contentnomore")}},mounted(){var e=getCurrentPages(),t=e[e.length-1].$getAppWebview();t.addEventListener("hide",(()=>{this.webviewHide=!0})),t.addEventListener("show",(()=>{this.webviewHide=!1}))},methods:{onClick(){this.$emit("clickLoadMore",{detail:{status:this.status}})}}},[["render",function(t,a,n,i,l,o){return e.openBlock(),e.createElementBlock("view",{class:"uni-load-more",onClick:a[0]||(a[0]=(...e)=>o.onClick&&o.onClick(...e))},[!l.webviewHide&&("circle"===n.iconType||"auto"===n.iconType&&"android"===l.platform)&&"loading"===n.status&&n.showIcon?(e.openBlock(),e.createElementBlock("view",{key:0,style:e.normalizeStyle({width:n.iconSize+"px",height:n.iconSize+"px"}),class:"uni-load-more__img uni-load-more__img--android-MP"},[e.createElementVNode("view",{class:"uni-load-more__img-icon",style:e.normalizeStyle({borderTopColor:n.color,borderTopWidth:n.iconSize/12})},null,4),e.createElementVNode("view",{class:"uni-load-more__img-icon",style:e.normalizeStyle({borderTopColor:n.color,borderTopWidth:n.iconSize/12})},null,4),e.createElementVNode("view",{class:"uni-load-more__img-icon",style:e.normalizeStyle({borderTopColor:n.color,borderTopWidth:n.iconSize/12})},null,4)],4)):!l.webviewHide&&"loading"===n.status&&n.showIcon?(e.openBlock(),e.createElementBlock("view",{key:1,style:e.normalizeStyle({width:n.iconSize+"px",height:n.iconSize+"px"}),class:"uni-load-more__img uni-load-more__img--ios-H5"},[e.createElementVNode("image",{src:l.imgBase64,mode:"widthFix"},null,8,["src"])],4)):e.createCommentVNode("",!0),n.showText?(e.openBlock(),e.createElementBlock("text",{key:2,class:"uni-load-more__text",style:e.normalizeStyle({color:n.color})},e.toDisplayString("more"===n.status?o.contentdownText:"loading"===n.status?o.contentrefreshText:o.contentnomoreText),5)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-b9147751"]]),Z={__name:"index",setup(n){const i=e.ref(null),l=e.computed((()=>i.value&&i.value.headerHeight?i.value.headerHeight+"rpx":s.value&&s.value.length>0?"200rpx":"120rpx")),o=e.ref([{id:0,name:"全部"}]),s=e.computed((()=>o.value.map((e=>e.name)))),r=e.computed((()=>{const e=o.value.findIndex((e=>e.id===m.value));return e>=0?e:0}));function c(e){o.value[e]&&function(e){if(m.value===e)return;m.value=e,g.value=1,y.value=!1,h.value=[],V()}(o.value[e].id)}const u=[{label:"全部",value:""},{label:"招募中",value:"recruiting"},{label:"进行中",value:"ongoing"},{label:"已完成",value:"completed"},{label:"已取消",value:"canceled"}],m=e.ref(0),p=e.ref(""),h=e.ref([]),g=e.ref(1),f=e.ref(10),v=e.ref(!1),w=e.ref(!1),y=e.ref(!1),k=e.ref({contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"已经到底啦"}),E=e.ref(!1);async function V(){w.value||(v.value=!0);try{const e={pageNum:g.value,pageSize:f.value};0!==m.value&&(e.categoryId=m.value),p.value&&(e.status=p.value);const a=await d({url:"/tasks/list",method:"GET",params:e});200===a.code&&a.data?(1===g.value?(h.value=a.data.records||[],w.value&&uni.showToast({title:"刷新成功",icon:"success",duration:1500})):(h.value=[...h.value,...a.data.records||[]],a.data.records&&a.data.records.length>0&&uni.showToast({title:`加载了${a.data.records.length}条新数据`,icon:"none",duration:1500})),a.data.current>=a.data.pages||!a.data.records||0===a.data.records.length?y.value=!0:y.value=!1):(t("error","at pages/task-square/index.vue:311","获取任务列表失败:",a),uni.showToast({title:"获取任务列表失败",icon:"none"}))}catch(e){t("error","at pages/task-square/index.vue:318","获取任务列表异常:",e),uni.showToast({title:"网络异常，请稍后重试",icon:"none"})}finally{v.value=!1,w.value&&(w.value=!1,uni.stopPullDownRefresh())}}function N(){v.value||(w.value=!0,g.value=1,y.value=!1,V())}function x(e){if(!e)return"";try{const t=new Date(e);return`${t.getMonth()+1}月${t.getDate()}日`}catch(t){return e}}function b(){v.value||w.value||y.value||(uni.showToast({title:"加载更多数据...",icon:"none",duration:800}),g.value++,V())}function T(e){switch(e){case"问卷调查":case"技术支持":default:return"tag-blue";case"数据收集":case"志愿服务":return"tag-green";case"实验参与":return"tag-purple";case"校园活动":return"tag-orange";case"学术研究":return"tag-pink";case"竞赛协助":return"tag-yellow"}}function S(e){switch(e){case"recruiting":default:return"status-recruiting";case"ongoing":return"status-ongoing";case"completed":return"status-ended";case"canceled":return"status-canceled"}}function C(e){switch(e){case"现金":return"reward-orange";case"学分":return"reward-blue";case"志愿服务":return"reward-green";case"证书":return"reward-yellow";case"礼品":return"reward-purple";default:return"reward-gray"}}function D(){uni.navigateTo({url:"/pages/task-square/create"})}function B(){uni.navigateTo({url:"/pages/task-square/search"})}function _(){uni.navigateTo({url:"/pages/notification/index"})}return e.computed((()=>{if(E.value){const e=o.value.slice(4).length;return 300+80*Math.ceil(e/4)+30+"rpx"}return"300rpx"})),e.onMounted((()=>{k.value={contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"已经到底啦"},async function(){try{const e=await d({url:"/taskCategories",method:"GET"});if(200===e.code&&e.data&&Array.isArray(e.data)){const t=[{id:0,name:"全部"},...e.data];o.value=t}else t("error","at pages/task-square/index.vue:237","获取任务分类失败:",e)}catch(e){t("error","at pages/task-square/index.vue:240","获取任务分类异常:",e),uni.showToast({title:"获取分类失败",icon:"none"})}}(),V()})),(n,o)=>{const d=a(e.resolveDynamicComponent("uni-load-more"),Q);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(I,{ref_key:"headerBarRef",ref:i,title:"任务广场",categories:s.value,"default-category":r.value,"show-filter":"true","show-search":"true",onSearch:B,onFilter:_,onCategoryChange:c},null,8,["categories","default-category"]),e.createElementVNode("view",{class:"header-placeholder",style:e.normalizeStyle({height:l.value})},null,4),e.createElementVNode("view",{class:"status-section"},[e.createElementVNode("scroll-view",{"scroll-x":"",class:"status-scroll","show-scrollbar":"false"},[e.createElementVNode("view",{class:"status-container"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(u,((t,a)=>e.createElementVNode("view",{key:a,class:e.normalizeClass(["status-filter-tag",p.value===t.value?"status-filter-active":""]),onClick:e=>{return a=t.value,void(p.value!==a&&(p.value=a,g.value=1,y.value=!1,h.value=[],V()));var a}},e.toDisplayString(t.label),11,["onClick"]))),64))])])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"tasks-scroll",onScrolltolower:b,onRefresherrefresh:N,"refresher-enabled":"true","refresher-triggered":w.value,"refresher-background":"#f5f5f5"},[e.createElementVNode("view",{class:"tasks-container"},[w.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"refresh-tip"},[e.createElementVNode("text",{class:"refresh-text"},"正在刷新数据...")])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,(a=>(e.openBlock(),e.createElementBlock("view",{class:"task-card",key:a.id,onClick:e=>{return n=a.id,void uni.navigateTo({url:`/pages/task-square/detail?id=${n}`,events:{acceptDataFromDetail:function(e){t("log","at pages/task-square/index.vue:460","来自详情页的数据",e)}},success:function(e){e.eventChannel.emit("taskId",{id:n})},fail:function(e){t("error","at pages/task-square/index.vue:468","打开任务详情失败:",e),uni.navigateTo({url:`/pages/task-square/detail?id=${n}`})}});var n}},[e.createElementVNode("view",{class:"task-header"},[e.createElementVNode("view",null,[e.createElementVNode("view",{class:"task-title"},e.toDisplayString(a.title),1),e.createElementVNode("view",{class:"task-tags"},[e.createElementVNode("text",{class:e.normalizeClass(["task-tag",T(a.categoryName)])},e.toDisplayString(a.categoryName),3),e.createElementVNode("text",{class:e.normalizeClass(["task-status-tag",S(a.status)])},e.toDisplayString(a.statusText),3),e.createElementVNode("text",{class:"task-deadline"},"截止: "+e.toDisplayString(x(a.deadline)),1)])]),e.createElementVNode("view",{class:e.normalizeClass(["task-reward",C(a.rewardTypeName)])},["现金"===a.rewardTypeName?(e.openBlock(),e.createElementBlock("text",{key:0},"¥"+e.toDisplayString(a.rewardAmount),1)):"学分"===a.rewardTypeName?(e.openBlock(),e.createElementBlock("text",{key:1},e.toDisplayString(a.rewardAmount)+"学分",1)):(e.openBlock(),e.createElementBlock("text",{key:2},e.toDisplayString(a.rewardTypeName),1))],2)]),e.createElementVNode("view",{class:"task-desc"},e.toDisplayString(a.shortDescription),1),a.location?(e.openBlock(),e.createElementBlock("view",{key:0,class:"task-location"},[e.createElementVNode("text",{class:"iconfont icon-location"}),e.createElementVNode("text",{class:"location-text"},e.toDisplayString(a.location),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"task-footer"},[e.createElementVNode("view",{class:"task-publisher"},[e.createElementVNode("image",{class:"publisher-avatar",src:a.creatorAvatarUrl||"https://via.placeholder.com/100",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("text",{class:"publisher-info"},e.toDisplayString(a.creatorName)+" · "+e.toDisplayString(a.creatorMajor),1)]),e.createElementVNode("view",{class:"task-stats"},[e.createElementVNode("text",{class:"stat-item"},[e.createElementVNode("text",{class:"iconfont icon-view"}),e.createTextVNode(" "+e.toDisplayString(a.viewCount),1)]),e.createElementVNode("text",{class:"stat-item"},[e.createElementVNode("text",{class:"iconfont icon-user"}),e.createTextVNode(" "+e.toDisplayString(a.currentParticipants)+"/"+e.toDisplayString(a.maxParticipants),1)])])])],8,["onClick"])))),128)),0!==h.value.length||v.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("image",{class:"empty-image",src:"/static/empty-task.png",mode:"aspectFit"}),e.createElementVNode("text",{class:"empty-text"},"暂无任务数据")])),v.value&&!w.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"loading-more"},[e.createVNode(d,{status:"loading",contentText:k.value},null,8,["contentText"])])):e.createCommentVNode("",!0),y.value&&!v.value&&h.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:3,class:"no-more"},[e.createVNode(d,{status:"noMore",contentText:k.value},null,8,["contentText"])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"safe-area-bottom"})])],40,["refresher-triggered"]),e.createElementVNode("view",{class:"float-btn",onClick:D},[e.createElementVNode("text",{class:"iconfont icon-plus"})])])}}},X={__name:"detail",setup(a,{expose:n}){const i=e.ref(null),l=e.ref(!1);e.ref(!1),e.ref(0);const o=e.ref(!1),s=e.ref({id:0,title:"",description:"",requirements:"",contactInfo:"",categoryId:0,categoryName:"",creatorId:0,creatorName:"",creatorAvatarUrl:"",creatorMajor:"",rewardTypeId:0,rewardTypeName:"",rewardAmount:0,createdAt:"",deadline:"",status:"recruiting",maxParticipants:0,currentParticipants:0,viewCount:0,location:""}),r=e.computed((()=>{if(!s.value.contactInfo)return null;try{let e;return e="string"==typeof s.value.contactInfo?JSON.parse(s.value.contactInfo):s.value.contactInfo,e}catch(e){return t("error","at pages/task-square/detail.vue:184","解析联系方式失败:",e),null}})),c=e.computed((()=>r.value?Object.entries(r.value).filter((([e,t])=>t&&""!==t.toString().trim())).map((([e,t])=>({key:e,value:t}))):[])),u=e.computed((()=>!!o.value||("recruiting"!==s.value.status||s.value.currentParticipants>=s.value.maxParticipants)));async function m(e){try{uni.showLoading({title:"加载中..."});const a=await d({url:`/tasks/${e}`,method:"GET"});200===a.code&&a.data?(s.value=a.data,async function(e){try{const t=await N.taskApplications.checkTaskApplication(e);200===t.code&&t.data&&(o.value=t.data.participated||!1)}catch(a){t("error","at pages/task-square/detail.vue:611","检查申请状态失败:",a),o.value=!1}}(e)):(t("error","at pages/task-square/detail.vue:322","获取任务详情失败:",a),uni.showToast({title:"获取任务详情失败",icon:"none"}))}catch(a){t("error","at pages/task-square/detail.vue:329","获取任务详情异常:",a),s.value={id:e,title:"图书馆志愿者服务",description:"协助图书馆整理书籍、指导学生使用图书检索系统，并维持阅览室秩序。需要有耐心和良好的沟通能力，熟悉图书馆分类系统优先。",requirements:"1. 有责任心，能按时参与服务\n2. 熟悉图书馆基本布局和分类\n3. 具有良好沟通能力和耐心\n4. 每周至少能保证3小时志愿时间",contactInfo:{phone:"13800138000",wechat:"library_volunteer"},categoryId:6,categoryName:"志愿服务",creatorId:10,creatorName:"张同学",creatorAvatarUrl:"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100",creatorMajor:"计算机学院",rewardTypeId:2,rewardTypeName:"学分",rewardAmount:5,createdAt:new Date((new Date).getTime()-108e5).toISOString(),deadline:new Date((new Date).getTime()+6048e5).toISOString(),status:"ongoing",maxParticipants:5,currentParticipants:3,viewCount:128,location:"中心图书馆 3楼"},uni.showToast({title:"网络异常，显示示例数据",icon:"none"})}finally{uni.hideLoading()}}function p(e){if(!e)return"";try{const t=new Date(e),a=new Date,n=["日","一","二","三","四","五","六"],i=t.getHours().toString().padStart(2,"0"),l=`${i}:${t.getMinutes().toString().padStart(2,"0")}`;if(t.getFullYear()===a.getFullYear()){const e=t.getMonth()+1,a=t.getDate();return`${e}月${a}日 周${n[t.getDay()]} ${l}`}return`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()} ${l}`}catch(t){return e}}function h(e){if(!e)return"";try{const t=new Date(e),a=(new Date).getTime()-t.getTime(),n=6e4,i=60*n,l=24*i,o=7*l,s=30*l;return a<n?"刚刚":a<i?Math.floor(a/n)+"分钟前":a<l?Math.floor(a/i)+"小时前":a<o?Math.floor(a/l)+"天前":a<s?Math.floor(a/o)+"周前":Math.floor(a/s)+"个月前"}catch(t){return e}}function g(e){switch(e){case"recruiting":return"status-recruiting";case"ongoing":return"status-ongoing";case"completed":return"status-completed";case"ended":return"status-ended";case"canceled":return"status-canceled";default:return""}}function f(e){switch(e){case"现金":return"报酬";case"学分":return"学分奖励";case"志愿服务":return"志愿时长";case"证书":return"证书奖励";default:return"奖励"}}function v(e){switch(e){case"现金":return"reward-orange";case"学分":return"reward-blue";case"志愿服务":return"reward-green";case"证书":return"reward-yellow";default:return""}}function w(e){switch(e){case"phone":return"电话";case"wechat":return"微信";case"qq":return"QQ";case"email":return"邮箱";default:return e}}function y(){uni.navigateBack()}function k(){s.value.title&&uni.share({provider:"weixin",scene:"WXSceneSession",type:0,title:s.value.title,summary:s.value.description,imageUrl:"",href:"",success:function(e){t("log","at pages/task-square/detail.vue:570","分享成功：",e)},fail:function(e){t("log","at pages/task-square/detail.vue:573","分享失败：",e),uni.showToast({title:"分享功能开发中",icon:"none"})}})}async function E(){i.value}async function V(){u.value||uni.showModal({title:"申请任务",content:"确定要申请该任务吗？",editable:!0,placeholderText:"可选择填写申请理由（如有特长、经验等）",success:async e=>{if(e.confirm)try{uni.showLoading({title:"提交申请中..."});const t=await N.taskApplications.createTaskApplication({taskId:i.value,message:e.content||"我对这个任务很感兴趣，希望能参与。",status:"pending"});uni.hideLoading(),200===t.code?(uni.showToast({title:"申请成功，等待审核",icon:"success"}),o.value=!0,setTimeout((()=>{uni.navigateTo({url:"/pages/application/application"})}),1500)):uni.showToast({title:t.message||"申请失败",icon:"none"})}catch(a){uni.hideLoading(),t("error","at pages/task-square/detail.vue:665","申请任务失败:",a),uni.showToast({title:"申请失败，请稍后重试",icon:"none"})}}})}return e.onMounted((()=>{const e=function(){const e=getCurrentPages().pop();if(e&&e.$page)return e.$page.fullPath.eventChannel;return null}();if(e)e.on("taskId",(e=>{i.value=e.id,m(e.id)}));else{const e=getCurrentPages(),t=e[e.length-1];let a;if(t.options&&t.options.id)a=t.options.id;else if(t.$page&&t.$page.fullPath){const e=t.$page.fullPath.split("?")[1];if(e){a=new URLSearchParams(e).get("id")}}else{if(!(t.route&&t.__displayReporter&&t.__displayReporter.query))return uni.$once("task-detail-params",(e=>{e&&e.id&&(i.value=e.id,m(e.id))})),void setTimeout((()=>{i.value||uni.showToast({title:"任务ID无效，请返回重试",icon:"none"})}),300);a=t.__displayReporter.query.id}a?(i.value=a,m(a)):uni.showToast({title:"任务ID无效",icon:"none"})}})),n({onLoad(e){e&&e.id&&uni.$emit("task-detail-params",e)}}),(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"navbar"},[e.createElementVNode("view",{class:"back-btn",onClick:y},[e.createElementVNode("text",{class:"iconfont icon-back"})]),e.createElementVNode("view",{class:"title"},"任务详情"),e.createElementVNode("view",{class:"right-btns"},[e.createElementVNode("view",{class:"action-btn",onClick:k},[e.createElementVNode("text",{class:"iconfont icon-share"})])])])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"content-scroll"},[e.createElementVNode("view",{class:"top-info-card"},[e.createElementVNode("view",{class:"title-status-row"},[e.createElementVNode("text",{class:"task-title"},e.toDisplayString(s.value.title),1),e.createElementVNode("text",{class:e.normalizeClass(["task-status-tag",g(s.value.status)])},e.toDisplayString(s.value.statusText),3)]),e.createElementVNode("view",{class:"publisher-info-row"},[e.createElementVNode("image",{class:"publisher-avatar",src:s.value.creatorAvatarUrl||"https://via.placeholder.com/100",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"publisher-text"},[e.createElementVNode("text",{class:"publisher-name"},e.toDisplayString(s.value.creatorName),1),e.createElementVNode("text",{class:"publisher-extra"},e.toDisplayString(s.value.creatorMajor)+" · "+e.toDisplayString(h(s.value.createdAt))+"发布",1)])])]),e.createElementVNode("view",{class:"detail-card"},[e.createElementVNode("view",{class:"card-title"},"任务详情"),e.createElementVNode("view",{class:"card-content description-content"},[e.createElementVNode("text",{class:"description-text"},e.toDisplayString(s.value.description),1)])]),s.value.requirements?(e.openBlock(),e.createElementBlock("view",{key:0,class:"detail-card"},[e.createElementVNode("view",{class:"card-title"},"任务要求"),e.createElementVNode("view",{class:"card-content description-content"},[e.createElementVNode("text",{class:"description-text"},e.toDisplayString(s.value.requirements),1)])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"info-grid"},[e.createElementVNode("view",{class:"info-grid-item"},[e.createElementVNode("text",{class:"grid-item-label"},"时间"),e.createElementVNode("view",{class:"grid-item-content"},[e.createElementVNode("text",{class:"iconfont icon-clock"}),e.createElementVNode("text",{class:"grid-item-value"},e.toDisplayString(p(s.value.deadline)),1)])]),s.value.location?(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-grid-item"},[e.createElementVNode("text",{class:"grid-item-label"},"地点"),e.createElementVNode("view",{class:"grid-item-content"},[e.createElementVNode("text",{class:"iconfont icon-location"}),e.createElementVNode("text",{class:"grid-item-value"},e.toDisplayString(s.value.location),1)])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"info-grid-item"},[e.createElementVNode("text",{class:"grid-item-label"},e.toDisplayString(f(s.value.rewardTypeName)),1),e.createElementVNode("view",{class:"grid-item-content"},[e.createElementVNode("text",{class:"iconfont icon-reward"}),e.createElementVNode("text",{class:e.normalizeClass(["grid-item-value reward-text",v(s.value.rewardTypeName)])},["现金"===s.value.rewardTypeName?(e.openBlock(),e.createElementBlock("text",{key:0},"¥"+e.toDisplayString(s.value.rewardAmount),1)):"学分"===s.value.rewardTypeName?(e.openBlock(),e.createElementBlock("text",{key:1},e.toDisplayString(s.value.rewardAmount)+" 学分",1)):(e.openBlock(),e.createElementBlock("text",{key:2},e.toDisplayString(s.value.rewardTypeName),1))],2)])]),e.createElementVNode("view",{class:"info-grid-item"},[e.createElementVNode("text",{class:"grid-item-label"},"参与人数"),e.createElementVNode("view",{class:"grid-item-content"},[e.createElementVNode("text",{class:"iconfont icon-user"}),e.createElementVNode("text",{class:"grid-item-value"},e.toDisplayString(s.value.currentParticipants)+"/"+e.toDisplayString(s.value.maxParticipants)+" 人",1)])])]),c.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:1,class:"detail-card"},[e.createElementVNode("view",{class:"card-title"},"联系方式"),e.createElementVNode("view",{class:"contact-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.value,(t=>(e.openBlock(),e.createElementBlock("view",{class:"contact-item",key:t.key,onClick:e=>{return a=t.value,void uni.setClipboardData({data:a,success:()=>{uni.showToast({title:"复制成功",icon:"success"})}});var a}},[e.createElementVNode("text",{class:"contact-type"},e.toDisplayString(w(t.key)),1),e.createElementVNode("view",{class:"contact-value-container"},[e.createElementVNode("text",{class:"contact-value"},e.toDisplayString(t.value),1),e.createElementVNode("text",{class:"copy-hint"},"点击复制")])],8,["onClick"])))),128))])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"bottom-actions"},[e.createElementVNode("view",{class:"action-btn favorite",onClick:E},[e.createElementVNode("text",{class:e.normalizeClass(["iconfont",l.value?"icon-star-filled":"icon-star"])},null,2),e.createElementVNode("text",null,e.toDisplayString(l.value?"已收藏":"收藏"),1)]),e.createElementVNode("button",{class:e.normalizeClass(["apply-btn",{"disabled-btn":u.value}]),disabled:u.value,onClick:V},e.toDisplayString(o.value?"已申请":"recruiting"===s.value.status?s.value.currentParticipants>=s.value.maxParticipants?"名额已满":"立即申请":"ongoing"===s.value.status?"进行中":"completed"===s.value.status?"已完成":"ended"===s.value.status?"已结束":"canceled"===s.value.status?"已取消":"立即申请"),11,["disabled"])])]))}},K=[{font_class:"arrow-down",unicode:""},{font_class:"arrow-left",unicode:""},{font_class:"arrow-right",unicode:""},{font_class:"arrow-up",unicode:""},{font_class:"auth",unicode:""},{font_class:"auth-filled",unicode:""},{font_class:"back",unicode:""},{font_class:"bars",unicode:""},{font_class:"calendar",unicode:""},{font_class:"calendar-filled",unicode:""},{font_class:"camera",unicode:""},{font_class:"camera-filled",unicode:""},{font_class:"cart",unicode:""},{font_class:"cart-filled",unicode:""},{font_class:"chat",unicode:""},{font_class:"chat-filled",unicode:""},{font_class:"chatboxes",unicode:""},{font_class:"chatboxes-filled",unicode:""},{font_class:"chatbubble",unicode:""},{font_class:"chatbubble-filled",unicode:""},{font_class:"checkbox",unicode:""},{font_class:"checkbox-filled",unicode:""},{font_class:"checkmarkempty",unicode:""},{font_class:"circle",unicode:""},{font_class:"circle-filled",unicode:""},{font_class:"clear",unicode:""},{font_class:"close",unicode:""},{font_class:"closeempty",unicode:""},{font_class:"cloud-download",unicode:""},{font_class:"cloud-download-filled",unicode:""},{font_class:"cloud-upload",unicode:""},{font_class:"cloud-upload-filled",unicode:""},{font_class:"color",unicode:""},{font_class:"color-filled",unicode:""},{font_class:"compose",unicode:""},{font_class:"contact",unicode:""},{font_class:"contact-filled",unicode:""},{font_class:"down",unicode:""},{font_class:"bottom",unicode:""},{font_class:"download",unicode:""},{font_class:"download-filled",unicode:""},{font_class:"email",unicode:""},{font_class:"email-filled",unicode:""},{font_class:"eye",unicode:""},{font_class:"eye-filled",unicode:""},{font_class:"eye-slash",unicode:""},{font_class:"eye-slash-filled",unicode:""},{font_class:"fire",unicode:""},{font_class:"fire-filled",unicode:""},{font_class:"flag",unicode:""},{font_class:"flag-filled",unicode:""},{font_class:"folder-add",unicode:""},{font_class:"folder-add-filled",unicode:""},{font_class:"font",unicode:""},{font_class:"forward",unicode:""},{font_class:"gear",unicode:""},{font_class:"gear-filled",unicode:""},{font_class:"gift",unicode:""},{font_class:"gift-filled",unicode:""},{font_class:"hand-down",unicode:""},{font_class:"hand-down-filled",unicode:""},{font_class:"hand-up",unicode:""},{font_class:"hand-up-filled",unicode:""},{font_class:"headphones",unicode:""},{font_class:"heart",unicode:""},{font_class:"heart-filled",unicode:""},{font_class:"help",unicode:""},{font_class:"help-filled",unicode:""},{font_class:"home",unicode:""},{font_class:"home-filled",unicode:""},{font_class:"image",unicode:""},{font_class:"image-filled",unicode:""},{font_class:"images",unicode:""},{font_class:"images-filled",unicode:""},{font_class:"info",unicode:""},{font_class:"info-filled",unicode:""},{font_class:"left",unicode:""},{font_class:"link",unicode:""},{font_class:"list",unicode:""},{font_class:"location",unicode:""},{font_class:"location-filled",unicode:""},{font_class:"locked",unicode:""},{font_class:"locked-filled",unicode:""},{font_class:"loop",unicode:""},{font_class:"mail-open",unicode:""},{font_class:"mail-open-filled",unicode:""},{font_class:"map",unicode:""},{font_class:"map-filled",unicode:""},{font_class:"map-pin",unicode:""},{font_class:"map-pin-ellipse",unicode:""},{font_class:"medal",unicode:""},{font_class:"medal-filled",unicode:""},{font_class:"mic",unicode:""},{font_class:"mic-filled",unicode:""},{font_class:"micoff",unicode:""},{font_class:"micoff-filled",unicode:""},{font_class:"minus",unicode:""},{font_class:"minus-filled",unicode:""},{font_class:"more",unicode:""},{font_class:"more-filled",unicode:""},{font_class:"navigate",unicode:""},{font_class:"navigate-filled",unicode:""},{font_class:"notification",unicode:""},{font_class:"notification-filled",unicode:""},{font_class:"paperclip",unicode:""},{font_class:"paperplane",unicode:""},{font_class:"paperplane-filled",unicode:""},{font_class:"person",unicode:""},{font_class:"person-filled",unicode:""},{font_class:"personadd",unicode:""},{font_class:"personadd-filled",unicode:""},{font_class:"personadd-filled-copy",unicode:""},{font_class:"phone",unicode:""},{font_class:"phone-filled",unicode:""},{font_class:"plus",unicode:""},{font_class:"plus-filled",unicode:""},{font_class:"plusempty",unicode:""},{font_class:"pulldown",unicode:""},{font_class:"pyq",unicode:""},{font_class:"qq",unicode:""},{font_class:"redo",unicode:""},{font_class:"redo-filled",unicode:""},{font_class:"refresh",unicode:""},{font_class:"refresh-filled",unicode:""},{font_class:"refreshempty",unicode:""},{font_class:"reload",unicode:""},{font_class:"right",unicode:""},{font_class:"scan",unicode:""},{font_class:"search",unicode:""},{font_class:"settings",unicode:""},{font_class:"settings-filled",unicode:""},{font_class:"shop",unicode:""},{font_class:"shop-filled",unicode:""},{font_class:"smallcircle",unicode:""},{font_class:"smallcircle-filled",unicode:""},{font_class:"sound",unicode:""},{font_class:"sound-filled",unicode:""},{font_class:"spinner-cycle",unicode:""},{font_class:"staff",unicode:""},{font_class:"staff-filled",unicode:""},{font_class:"star",unicode:""},{font_class:"star-filled",unicode:""},{font_class:"starhalf",unicode:""},{font_class:"trash",unicode:""},{font_class:"trash-filled",unicode:""},{font_class:"tune",unicode:""},{font_class:"tune-filled",unicode:""},{font_class:"undo",unicode:""},{font_class:"undo-filled",unicode:""},{font_class:"up",unicode:""},{font_class:"top",unicode:""},{font_class:"upload",unicode:""},{font_class:"upload-filled",unicode:""},{font_class:"videocam",unicode:""},{font_class:"videocam-filled",unicode:""},{font_class:"vip",unicode:""},{font_class:"vip-filled",unicode:""},{font_class:"wallet",unicode:""},{font_class:"wallet-filled",unicode:""},{font_class:"weibo",unicode:""},{font_class:"weixin",unicode:""}];const ee=C({name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""},fontFamily:{type:String,default:""}},data:()=>({icons:K}),computed:{unicode(){let e=this.icons.find((e=>e.font_class===this.type));return e?e.unicode:""},iconSize(){return"number"==typeof(e=this.size)||/^[0-9]*$/g.test(e)?e+"px":e;var e},styleObj(){return""!==this.fontFamily?`color: ${this.color}; font-size: ${this.iconSize}; font-family: ${this.fontFamily};`:`color: ${this.color}; font-size: ${this.iconSize};`}},methods:{_onClick(){this.$emit("click")}}},[["render",function(t,a,n,i,l,o){return e.openBlock(),e.createElementBlock("text",{style:e.normalizeStyle(o.styleObj),class:e.normalizeClass(["uni-icons",["uniui-"+n.type,n.customPrefix,n.customPrefix?n.type:""]]),onClick:a[0]||(a[0]=(...e)=>o._onClick&&o._onClick(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)}],["__scopeId","data-v-1320ff52"]]);function te(e){let t="";for(let a in e){t+=`${a}:${e[a]};`}return t}const ae=C({name:"uni-easyinput",emits:["click","iconClick","update:modelValue","input","focus","blur","confirm","clear","eyes","change","keyboardheightchange"],model:{prop:"modelValue",event:"update:modelValue"},options:{virtualHost:!0},inject:{form:{from:"uniForm",default:null},formItem:{from:"uniFormItem",default:null}},props:{name:String,value:[Number,String],modelValue:[Number,String],type:{type:String,default:"text"},clearable:{type:Boolean,default:!0},autoHeight:{type:Boolean,default:!1},placeholder:{type:String,default:" "},placeholderStyle:String,focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},clearSize:{type:[Number,String],default:24},inputBorder:{type:Boolean,default:!0},prefixIcon:{type:String,default:""},suffixIcon:{type:String,default:""},trim:{type:[Boolean,String],default:!1},cursorSpacing:{type:Number,default:0},passwordIcon:{type:Boolean,default:!0},adjustPosition:{type:Boolean,default:!0},primaryColor:{type:String,default:"#2979ff"},styles:{type:Object,default:()=>({color:"#333",backgroundColor:"#fff",disableColor:"#F7F6F6",borderColor:"#e5e5e5"})},errorMessage:{type:[String,Boolean],default:""}},data:()=>({focused:!1,val:"",showMsg:"",border:!1,isFirstBorder:!1,showClearIcon:!1,showPassword:!1,focusShow:!1,localMsg:"",isEnter:!1}),computed:{isVal(){const e=this.val;return!(!e&&0!==e)},msg(){return this.localMsg||this.errorMessage},inputMaxlength(){return Number(this.maxlength)},boxStyle(){return`color:${this.inputBorder&&this.msg?"#e43d33":this.styles.color};`},inputContentClass(){return function(e){let t="";for(let a in e)e[a]&&(t+=`${a} `);return t}({"is-input-border":this.inputBorder,"is-input-error-border":this.inputBorder&&this.msg,"is-textarea":"textarea"===this.type,"is-disabled":this.disabled,"is-focused":this.focusShow})},inputContentStyle(){const e=this.focusShow?this.primaryColor:this.styles.borderColor;return te({"border-color":(this.inputBorder&&this.msg?"#dd524d":e)||"#e5e5e5","background-color":this.disabled?this.styles.disableColor:this.styles.backgroundColor})},inputStyle(){return te({"padding-right":"password"===this.type||this.clearable||this.prefixIcon?"":"10px","padding-left":this.prefixIcon?"":"10px"})}},watch:{value(e){this.val=e},modelValue(e){this.val=e},focus(e){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))}},created(){this.init(),this.form&&this.formItem&&this.$watch("formItem.errMsg",(e=>{this.localMsg=e}))},mounted(){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))},methods:{init(){this.value||0===this.value?this.val=this.value:this.modelValue||0===this.modelValue||""===this.modelValue?this.val=this.modelValue:this.val=null},onClickIcon(e){this.$emit("iconClick",e)},onEyes(){this.showPassword=!this.showPassword,this.$emit("eyes",this.showPassword)},onInput(e){let t=e.detail.value;this.trim&&("boolean"==typeof this.trim&&this.trim&&(t=this.trimStr(t)),"string"==typeof this.trim&&(t=this.trimStr(t,this.trim))),this.errMsg&&(this.errMsg=""),this.val=t,this.$emit("input",t),this.$emit("update:modelValue",t)},onFocus(){this.$nextTick((()=>{this.focused=!0})),this.$emit("focus",null)},_Focus(e){this.focusShow=!0,this.$emit("focus",e)},onBlur(){this.focused=!1,this.$emit("blur",null)},_Blur(e){if(e.detail.value,this.focusShow=!1,this.$emit("blur",e),!1===this.isEnter&&this.$emit("change",this.val),this.form&&this.formItem){const{validateTrigger:e}=this.form;"blur"===e&&this.formItem.onFieldChange()}},onConfirm(e){this.$emit("confirm",this.val),this.isEnter=!0,this.$emit("change",this.val),this.$nextTick((()=>{this.isEnter=!1}))},onClear(e){this.val="",this.$emit("input",""),this.$emit("update:modelValue",""),this.$emit("clear")},onkeyboardheightchange(e){this.$emit("keyboardheightchange",e)},trimStr:(e,t="both")=>"both"===t?e.trim():"left"===t?e.trimLeft():"right"===t?e.trimRight():"start"===t?e.trimStart():"end"===t?e.trimEnd():"all"===t?e.replace(/\s+/g,""):e}},[["render",function(t,n,i,l,o,s){const r=a(e.resolveDynamicComponent("uni-icons"),ee);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-easyinput",{"uni-easyinput-error":s.msg}]),style:e.normalizeStyle(s.boxStyle)},[e.createElementVNode("view",{class:e.normalizeClass(["uni-easyinput__content",s.inputContentClass]),style:e.normalizeStyle(s.inputContentStyle)},[i.prefixIcon?(e.openBlock(),e.createBlock(r,{key:0,class:"content-clear-icon",type:i.prefixIcon,color:"#c0c4cc",onClick:n[0]||(n[0]=e=>s.onClickIcon("prefix")),size:"22"},null,8,["type"])):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"left",{},void 0,!0),"textarea"===i.type?(e.openBlock(),e.createElementBlock("textarea",{key:1,class:e.normalizeClass(["uni-easyinput__content-textarea",{"input-padding":i.inputBorder}]),name:i.name,value:o.val,placeholder:i.placeholder,placeholderStyle:i.placeholderStyle,disabled:i.disabled,"placeholder-class":"uni-easyinput__placeholder-class",maxlength:s.inputMaxlength,focus:o.focused,autoHeight:i.autoHeight,"cursor-spacing":i.cursorSpacing,"adjust-position":i.adjustPosition,onInput:n[1]||(n[1]=(...e)=>s.onInput&&s.onInput(...e)),onBlur:n[2]||(n[2]=(...e)=>s._Blur&&s._Blur(...e)),onFocus:n[3]||(n[3]=(...e)=>s._Focus&&s._Focus(...e)),onConfirm:n[4]||(n[4]=(...e)=>s.onConfirm&&s.onConfirm(...e)),onKeyboardheightchange:n[5]||(n[5]=(...e)=>s.onkeyboardheightchange&&s.onkeyboardheightchange(...e))},null,42,["name","value","placeholder","placeholderStyle","disabled","maxlength","focus","autoHeight","cursor-spacing","adjust-position"])):(e.openBlock(),e.createElementBlock("input",{key:2,type:"password"===i.type?"text":i.type,class:"uni-easyinput__content-input",style:e.normalizeStyle(s.inputStyle),name:i.name,value:o.val,password:!o.showPassword&&"password"===i.type,placeholder:i.placeholder,placeholderStyle:i.placeholderStyle,"placeholder-class":"uni-easyinput__placeholder-class",disabled:i.disabled,maxlength:s.inputMaxlength,focus:o.focused,confirmType:i.confirmType,"cursor-spacing":i.cursorSpacing,"adjust-position":i.adjustPosition,onFocus:n[6]||(n[6]=(...e)=>s._Focus&&s._Focus(...e)),onBlur:n[7]||(n[7]=(...e)=>s._Blur&&s._Blur(...e)),onInput:n[8]||(n[8]=(...e)=>s.onInput&&s.onInput(...e)),onConfirm:n[9]||(n[9]=(...e)=>s.onConfirm&&s.onConfirm(...e)),onKeyboardheightchange:n[10]||(n[10]=(...e)=>s.onkeyboardheightchange&&s.onkeyboardheightchange(...e))},null,44,["type","name","value","password","placeholder","placeholderStyle","disabled","maxlength","focus","confirmType","cursor-spacing","adjust-position"])),"password"===i.type&&i.passwordIcon?(e.openBlock(),e.createElementBlock(e.Fragment,{key:3},[s.isVal?(e.openBlock(),e.createBlock(r,{key:0,class:e.normalizeClass(["content-clear-icon",{"is-textarea-icon":"textarea"===i.type}]),type:o.showPassword?"eye-slash-filled":"eye-filled",size:22,color:o.focusShow?i.primaryColor:"#c0c4cc",onClick:s.onEyes},null,8,["class","type","color","onClick"])):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0),i.suffixIcon?(e.openBlock(),e.createElementBlock(e.Fragment,{key:4},[i.suffixIcon?(e.openBlock(),e.createBlock(r,{key:0,class:"content-clear-icon",type:i.suffixIcon,color:"#c0c4cc",onClick:n[11]||(n[11]=e=>s.onClickIcon("suffix")),size:"22"},null,8,["type"])):e.createCommentVNode("",!0)],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:5},[i.clearable&&s.isVal&&!i.disabled&&"textarea"!==i.type?(e.openBlock(),e.createBlock(r,{key:0,class:e.normalizeClass(["content-clear-icon",{"is-textarea-icon":"textarea"===i.type}]),type:"clear",size:i.clearSize,color:s.msg?"#dd524d":o.focusShow?i.primaryColor:"#c0c4cc",onClick:s.onClear},null,8,["class","size","color","onClick"])):e.createCommentVNode("",!0)],64)),e.renderSlot(t.$slots,"right",{},void 0,!0)],6)],6)}],["__scopeId","data-v-63e7b685"]]);const ne=C({name:"uniFormsItem",options:{virtualHost:!0},provide(){return{uniFormItem:this}},inject:{form:{from:"uniForm",default:null}},props:{rules:{type:Array,default:()=>null},name:{type:[String,Array],default:""},required:{type:Boolean,default:!1},label:{type:String,default:""},labelWidth:{type:[String,Number],default:""},labelAlign:{type:String,default:""},errorMessage:{type:[String,Boolean],default:""},leftIcon:String,iconColor:{type:String,default:"#606266"}},data:()=>({errMsg:"",userRules:null,localLabelAlign:"left",localLabelWidth:"70px",localLabelPos:"left",border:!1,isFirstBorder:!1}),computed:{msg(){return this.errorMessage||this.errMsg}},watch:{"form.formRules"(e){this.init()},"form.labelWidth"(e){this.localLabelWidth=this._labelWidthUnit(e)},"form.labelPosition"(e){this.localLabelPos=this._labelPosition()},"form.labelAlign"(e){}},created(){this.init(!0),this.name&&this.form&&this.$watch((()=>this.form._getDataValue(this.name,this.form.localData)),((e,t)=>{if(!this.form._isEqual(e,t)){const t=this.itemSetValue(e);this.onFieldChange(t,!1)}}),{immediate:!1})},unmounted(){this.__isUnmounted=!0,this.unInit()},methods:{setRules(e=null){this.userRules=e,this.init(!1)},setValue(){},async onFieldChange(e,t=!0){const{formData:a,localData:n,errShowType:i,validateCheck:l,validateTrigger:o,_isRequiredField:s,_realName:r}=this.form,c=r(this.name);e||(e=this.form.formData[c]);const d=this.itemRules.rules&&this.itemRules.rules.length;if(!this.validator||!d||0===d)return;const u=s(this.itemRules.rules||[]);let m=null;return"bind"===o||t?(m=await this.validator.validateUpdate({[c]:e},a),u||void 0!==e&&""!==e||(m=null),m&&m.errorMessage?("undertext"===i&&(this.errMsg=m?m.errorMessage:""),"toast"===i&&uni.showToast({title:m.errorMessage||"校验错误",icon:"none"}),"modal"===i&&uni.showModal({title:"提示",content:m.errorMessage||"校验错误"})):this.errMsg="",l(m||null)):this.errMsg="",m||null},init(e=!1){const{validator:t,formRules:a,childrens:n,formData:i,localData:l,_realName:o,labelWidth:s,_getDataValue:r,_setDataValue:c}=this.form||{};if(this.localLabelAlign=this._justifyContent(),this.localLabelWidth=this._labelWidthUnit(s),this.localLabelPos=this._labelPosition(),this.form&&e&&n.push(this),!t||!a)return;this.form.isFirstBorder||(this.form.isFirstBorder=!0,this.isFirstBorder=!0),this.group&&(this.group.isFirstBorder||(this.group.isFirstBorder=!0,this.isFirstBorder=!0)),this.border=this.form.border;const d=o(this.name),u=this.userRules||this.rules;"object"==typeof a&&u&&(a[d]={rules:u},t.updateSchema(a));const m=a[d]||{};this.itemRules=m,this.validator=t,this.itemSetValue(r(this.name,l))},unInit(){if(this.form){const{childrens:e,formData:t,_realName:a}=this.form;e.forEach(((e,n)=>{e===this&&(this.form.childrens.splice(n,1),delete t[a(e.name)])}))}},itemSetValue(e){const t=this.form._realName(this.name),a=this.itemRules.rules||[],n=this.form._getValue(t,e,a);return this.form._setDataValue(t,this.form.formData,n),n},clearValidate(){this.errMsg=""},_isRequired(){return this.required},_justifyContent(){if(this.form){const{labelAlign:e}=this.form;let t=this.labelAlign?this.labelAlign:e;if("left"===t)return"flex-start";if("center"===t)return"center";if("right"===t)return"flex-end"}return"flex-start"},_labelWidthUnit(e){return this.num2px(this.labelWidth?this.labelWidth:e||(this.label?70:"auto"))},_labelPosition(){return this.form&&this.form.labelPosition||"left"},isTrigger:(e,t,a)=>"submit"!==e&&e?"bind":void 0===e?"bind"!==t?t?"submit":""===a?"bind":"submit":"bind":"submit",num2px:e=>"number"==typeof e?`${e}px`:e}},[["render",function(t,a,n,i,l,o){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-forms-item",["is-direction-"+l.localLabelPos,l.border?"uni-forms-item--border":"",l.border&&l.isFirstBorder?"is-first-border":""]])},[e.renderSlot(t.$slots,"label",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-forms-item__label",{"no-label":!n.label&&!n.required}]),style:e.normalizeStyle({width:l.localLabelWidth,justifyContent:l.localLabelAlign})},[n.required?(e.openBlock(),e.createElementBlock("text",{key:0,class:"is-required"},"*")):e.createCommentVNode("",!0),e.createElementVNode("text",null,e.toDisplayString(n.label),1)],6)]),!0),e.createElementVNode("view",{class:"uni-forms-item__content"},[e.renderSlot(t.$slots,"default",{},void 0,!0),e.createElementVNode("view",{class:e.normalizeClass(["uni-forms-item__error",{"msg--active":o.msg}])},[e.createElementVNode("text",null,e.toDisplayString(o.msg),1)],2)])],2)}],["__scopeId","data-v-d42c39e1"]]);function ie(e,t){return`${le(e)} ${oe(e,t)}`}function le(e){e=me(e);const t=(e=new Date(e)).getFullYear(),a=e.getMonth()+1,n=e.getDate();return`${t}-${se(a)}-${se(n)}`}function oe(e,t){e=me(e);const a=(e=new Date(e)).getHours(),n=e.getMinutes(),i=e.getSeconds();return t?`${se(a)}:${se(n)}`:`${se(a)}:${se(n)}:${se(i)}`}function se(e){return e<10&&(e=`0${e}`),e}function re(e){return e?"00:00":"00:00:00"}function ce(e,t){return(e=new Date(me(e)))<=(t=new Date(me(t)))}function de(e){return e.match(/((19|20)\d{2})(-|\/)\d{1,2}(-|\/)\d{1,2}/g)}const ue=/^\d{4}-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01])( [0-5]?[0-9]:[0-5]?[0-9](:[0-5]?[0-9])?)?$/;function me(e){return"string"==typeof e&&ue.test(e)&&(e=e.replace(/-/g,"/")),e}const pe=C({props:{weeks:{type:Object,default:()=>({})},calendar:{type:Object,default:()=>({})},selected:{type:Array,default:()=>[]},checkHover:{type:Boolean,default:!1}},methods:{choiceDate(e){this.$emit("change",e)},handleMousemove(e){this.$emit("handleMouse",e)}}},[["render",function(t,a,n,i,l,o){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-calendar-item__weeks-box",{"uni-calendar-item--disable":n.weeks.disable,"uni-calendar-item--before-checked-x":n.weeks.beforeMultiple,"uni-calendar-item--multiple":n.weeks.multiple,"uni-calendar-item--after-checked-x":n.weeks.afterMultiple}]),onClick:a[0]||(a[0]=e=>o.choiceDate(n.weeks)),onMouseenter:a[1]||(a[1]=e=>o.handleMousemove(n.weeks))},[e.createElementVNode("view",{class:e.normalizeClass(["uni-calendar-item__weeks-box-item",{"uni-calendar-item--checked":n.calendar.fullDate===n.weeks.fullDate&&(n.calendar.userChecked||!n.checkHover),"uni-calendar-item--checked-range-text":n.checkHover,"uni-calendar-item--before-checked":n.weeks.beforeMultiple,"uni-calendar-item--multiple":n.weeks.multiple,"uni-calendar-item--after-checked":n.weeks.afterMultiple,"uni-calendar-item--disable":n.weeks.disable}])},[n.selected&&n.weeks.extraInfo?(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-calendar-item__weeks-box-circle"})):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"uni-calendar-item__weeks-box-text uni-calendar-item__weeks-box-text-disable uni-calendar-item--checked-text"},e.toDisplayString(n.weeks.date),1)],2),e.createElementVNode("view",{class:e.normalizeClass({"uni-calendar-item--today":n.weeks.isToday})},null,2)],34)}],["__scopeId","data-v-cf8cb4f2"]]),he={en:{"uni-datetime-picker.selectDate":"select date","uni-datetime-picker.selectTime":"select time","uni-datetime-picker.selectDateTime":"select date and time","uni-datetime-picker.startDate":"start date","uni-datetime-picker.endDate":"end date","uni-datetime-picker.startTime":"start time","uni-datetime-picker.endTime":"end time","uni-datetime-picker.ok":"ok","uni-datetime-picker.clear":"clear","uni-datetime-picker.cancel":"cancel","uni-datetime-picker.year":"-","uni-datetime-picker.month":"","uni-calender.MON":"MON","uni-calender.TUE":"TUE","uni-calender.WED":"WED","uni-calender.THU":"THU","uni-calender.FRI":"FRI","uni-calender.SAT":"SAT","uni-calender.SUN":"SUN","uni-calender.confirm":"confirm"},"zh-Hans":{"uni-datetime-picker.selectDate":"选择日期","uni-datetime-picker.selectTime":"选择时间","uni-datetime-picker.selectDateTime":"选择日期时间","uni-datetime-picker.startDate":"开始日期","uni-datetime-picker.endDate":"结束日期","uni-datetime-picker.startTime":"开始时间","uni-datetime-picker.endTime":"结束时间","uni-datetime-picker.ok":"确定","uni-datetime-picker.clear":"清除","uni-datetime-picker.cancel":"取消","uni-datetime-picker.year":"年","uni-datetime-picker.month":"月","uni-calender.SUN":"日","uni-calender.MON":"一","uni-calender.TUE":"二","uni-calender.WED":"三","uni-calender.THU":"四","uni-calender.FRI":"五","uni-calender.SAT":"六","uni-calender.confirm":"确认"},"zh-Hant":{"uni-datetime-picker.selectDate":"選擇日期","uni-datetime-picker.selectTime":"選擇時間","uni-datetime-picker.selectDateTime":"選擇日期時間","uni-datetime-picker.startDate":"開始日期","uni-datetime-picker.endDate":"結束日期","uni-datetime-picker.startTime":"開始时间","uni-datetime-picker.endTime":"結束时间","uni-datetime-picker.ok":"確定","uni-datetime-picker.clear":"清除","uni-datetime-picker.cancel":"取消","uni-datetime-picker.year":"年","uni-datetime-picker.month":"月","uni-calender.SUN":"日","uni-calender.MON":"一","uni-calender.TUE":"二","uni-calender.WED":"三","uni-calender.THU":"四","uni-calender.FRI":"五","uni-calender.SAT":"六","uni-calender.confirm":"確認"}},{t:ge}=G(he);const fe=C({name:"UniDatetimePicker",data:()=>({indicatorStyle:"height: 50px;",visible:!1,fixNvueBug:{},dateShow:!0,timeShow:!0,title:"日期和时间",time:"",year:1920,month:0,day:0,hour:0,minute:0,second:0,startYear:1920,startMonth:1,startDay:1,startHour:0,startMinute:0,startSecond:0,endYear:2120,endMonth:12,endDay:31,endHour:23,endMinute:59,endSecond:59}),options:{virtualHost:!0},props:{type:{type:String,default:"datetime"},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},start:{type:[Number,String],default:""},end:{type:[Number,String],default:""},returnType:{type:String,default:"string"},disabled:{type:[Boolean,String],default:!1},border:{type:[Boolean,String],default:!0},hideSecond:{type:[Boolean,String],default:!1}},watch:{modelValue:{handler(e){e?(this.parseValue(me(e)),this.initTime(!1)):(this.time="",this.parseValue(Date.now()))},immediate:!0},type:{handler(e){"date"===e?(this.dateShow=!0,this.timeShow=!1,this.title="日期"):"time"===e?(this.dateShow=!1,this.timeShow=!0,this.title="时间"):(this.dateShow=!0,this.timeShow=!0,this.title="日期和时间")},immediate:!0},start:{handler(e){this.parseDatetimeRange(me(e),"start")},immediate:!0},end:{handler(e){this.parseDatetimeRange(me(e),"end")},immediate:!0},months(e){this.checkValue("month",this.month,e)},days(e){this.checkValue("day",this.day,e)},hours(e){this.checkValue("hour",this.hour,e)},minutes(e){this.checkValue("minute",this.minute,e)},seconds(e){this.checkValue("second",this.second,e)}},computed:{years(){return this.getCurrentRange("year")},months(){return this.getCurrentRange("month")},days(){return this.getCurrentRange("day")},hours(){return this.getCurrentRange("hour")},minutes(){return this.getCurrentRange("minute")},seconds(){return this.getCurrentRange("second")},ymd(){return[this.year-this.minYear,this.month-this.minMonth,this.day-this.minDay]},hms(){return[this.hour-this.minHour,this.minute-this.minMinute,this.second-this.minSecond]},currentDateIsStart(){return this.year===this.startYear&&this.month===this.startMonth&&this.day===this.startDay},currentDateIsEnd(){return this.year===this.endYear&&this.month===this.endMonth&&this.day===this.endDay},minYear(){return this.startYear},maxYear(){return this.endYear},minMonth(){return this.year===this.startYear?this.startMonth:1},maxMonth(){return this.year===this.endYear?this.endMonth:12},minDay(){return this.year===this.startYear&&this.month===this.startMonth?this.startDay:1},maxDay(){return this.year===this.endYear&&this.month===this.endMonth?this.endDay:this.daysInMonth(this.year,this.month)},minHour(){return"datetime"===this.type?this.currentDateIsStart?this.startHour:0:"time"===this.type?this.startHour:void 0},maxHour(){return"datetime"===this.type?this.currentDateIsEnd?this.endHour:23:"time"===this.type?this.endHour:void 0},minMinute(){return"datetime"===this.type?this.currentDateIsStart&&this.hour===this.startHour?this.startMinute:0:"time"===this.type?this.hour===this.startHour?this.startMinute:0:void 0},maxMinute(){return"datetime"===this.type?this.currentDateIsEnd&&this.hour===this.endHour?this.endMinute:59:"time"===this.type?this.hour===this.endHour?this.endMinute:59:void 0},minSecond(){return"datetime"===this.type?this.currentDateIsStart&&this.hour===this.startHour&&this.minute===this.startMinute?this.startSecond:0:"time"===this.type?this.hour===this.startHour&&this.minute===this.startMinute?this.startSecond:0:void 0},maxSecond(){return"datetime"===this.type?this.currentDateIsEnd&&this.hour===this.endHour&&this.minute===this.endMinute?this.endSecond:59:"time"===this.type?this.hour===this.endHour&&this.minute===this.endMinute?this.endSecond:59:void 0},selectTimeText:()=>ge("uni-datetime-picker.selectTime"),okText:()=>ge("uni-datetime-picker.ok"),clearText:()=>ge("uni-datetime-picker.clear"),cancelText:()=>ge("uni-datetime-picker.cancel")},mounted(){},methods:{lessThanTen:e=>e<10?"0"+e:e,parseTimeType(e){if(e){let t=e.split(":");this.hour=Number(t[0]),this.minute=Number(t[1]),this.second=Number(t[2])}},initPickerValue(e){let t=null;e?t=this.compareValueWithStartAndEnd(e,this.start,this.end):(t=Date.now(),t=this.compareValueWithStartAndEnd(t,this.start,this.end)),this.parseValue(t)},compareValueWithStartAndEnd(e,t,a){let n=null;return e=this.superTimeStamp(e),t=this.superTimeStamp(t),a=this.superTimeStamp(a),n=t&&a?e<t?new Date(t):e>a?new Date(a):new Date(e):t&&!a?t<=e?new Date(e):new Date(t):!t&&a?e<=a?new Date(e):new Date(a):new Date(e),n},superTimeStamp(e){let t="";if("time"===this.type&&e&&"string"==typeof e){const e=new Date;t=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" "}return Number(e)&&(e=parseInt(e),t=0),this.createTimeStamp(t+e)},parseValue(e){if(e){if("time"===this.type&&"string"==typeof e)this.parseTimeType(e);else{let t=null;t=new Date(e),"time"!==this.type&&(this.year=t.getFullYear(),this.month=t.getMonth()+1,this.day=t.getDate()),"date"!==this.type&&(this.hour=t.getHours(),this.minute=t.getMinutes(),this.second=t.getSeconds())}this.hideSecond&&(this.second=0)}},parseDatetimeRange(e,t){if(!e)return"start"===t&&(this.startYear=1920,this.startMonth=1,this.startDay=1,this.startHour=0,this.startMinute=0,this.startSecond=0),void("end"===t&&(this.endYear=2120,this.endMonth=12,this.endDay=31,this.endHour=23,this.endMinute=59,this.endSecond=59));if("time"===this.type){const a=e.split(":");this[t+"Hour"]=Number(a[0]),this[t+"Minute"]=Number(a[1]),this[t+"Second"]=Number(a[2])}else{if(!e)return void("start"===t?this.startYear=this.year-60:this.endYear=this.year+60);Number(e)&&(e=parseInt(e));const a=/[0-9]:[0-9]/;"datetime"!==this.type||"end"!==t||"string"!=typeof e||a.test(e)||(e+=" 23:59:59");const n=new Date(e);this[t+"Year"]=n.getFullYear(),this[t+"Month"]=n.getMonth()+1,this[t+"Day"]=n.getDate(),"datetime"===this.type&&(this[t+"Hour"]=n.getHours(),this[t+"Minute"]=n.getMinutes(),this[t+"Second"]=n.getSeconds())}},getCurrentRange(e){const t=[];for(let a=this["min"+this.capitalize(e)];a<=this["max"+this.capitalize(e)];a++)t.push(a);return t},capitalize:e=>e.charAt(0).toUpperCase()+e.slice(1),checkValue(e,t,a){-1===a.indexOf(t)&&(this[e]=a[0])},daysInMonth:(e,t)=>new Date(e,t,0).getDate(),createTimeStamp(e){if(e)return"number"==typeof e?e:(e=e.replace(/-/g,"/"),"date"===this.type&&(e+=" 00:00:00"),Date.parse(e))},createDomSting(){const e=this.year+"-"+this.lessThanTen(this.month)+"-"+this.lessThanTen(this.day);let t=this.lessThanTen(this.hour)+":"+this.lessThanTen(this.minute);return this.hideSecond||(t=t+":"+this.lessThanTen(this.second)),"date"===this.type?e:"time"===this.type?t:e+" "+t},initTime(e=!0){this.time=this.createDomSting(),e&&("timestamp"===this.returnType&&"time"!==this.type?(this.$emit("change",this.createTimeStamp(this.time)),this.$emit("input",this.createTimeStamp(this.time)),this.$emit("update:modelValue",this.createTimeStamp(this.time))):(this.$emit("change",this.time),this.$emit("input",this.time),this.$emit("update:modelValue",this.time)))},bindDateChange(e){const t=e.detail.value;this.year=this.years[t[0]],this.month=this.months[t[1]],this.day=this.days[t[2]]},bindTimeChange(e){const t=e.detail.value;this.hour=this.hours[t[0]],this.minute=this.minutes[t[1]],this.second=this.seconds[t[2]]},initTimePicker(){if(this.disabled)return;const e=me(this.time);this.initPickerValue(e),this.visible=!this.visible},tiggerTimePicker(e){this.visible=!this.visible},clearTime(){this.time="",this.$emit("change",this.time),this.$emit("input",this.time),this.$emit("update:modelValue",this.time),this.tiggerTimePicker()},setTime(){this.initTime(),this.tiggerTimePicker()}}},[["render",function(t,a,n,i,l,o){return e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker"},[e.createElementVNode("view",{onClick:a[0]||(a[0]=(...e)=>o.initTimePicker&&o.initTimePicker(...e))},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-datetime-picker-timebox-pointer",{"uni-datetime-picker-disabled":n.disabled,"uni-datetime-picker-timebox":n.border}])},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(l.time),1),l.time?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-datetime-picker-time"},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(o.selectTimeText),1)]))],2)]),!0)]),l.visible?(e.openBlock(),e.createElementBlock("view",{key:0,id:"mask",class:"uni-datetime-picker-mask",onClick:a[1]||(a[1]=(...e)=>o.tiggerTimePicker&&o.tiggerTimePicker(...e))})):e.createCommentVNode("",!0),l.visible?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["uni-datetime-picker-popup",[l.dateShow&&l.timeShow?"":"fix-nvue-height"]]),style:e.normalizeStyle(l.fixNvueBug)},[e.createElementVNode("view",{class:"uni-title"},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(o.selectTimeText),1)]),l.dateShow?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-datetime-picker__container-box"},[e.createElementVNode("picker-view",{class:"uni-datetime-picker-view","indicator-style":l.indicatorStyle,value:o.ymd,onChange:a[2]||(a[2]=(...e)=>o.bindDateChange&&o.bindDateChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.years,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(o.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.months,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(o.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.days,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(o.lessThanTen(t)),1)])))),128))])],40,["indicator-style","value"]),e.createElementVNode("text",{class:"uni-datetime-picker-sign sign-left"},"-"),e.createElementVNode("text",{class:"uni-datetime-picker-sign sign-right"},"-")])):e.createCommentVNode("",!0),l.timeShow?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-datetime-picker__container-box"},[e.createElementVNode("picker-view",{class:e.normalizeClass(["uni-datetime-picker-view",[n.hideSecond?"time-hide-second":""]]),"indicator-style":l.indicatorStyle,value:o.hms,onChange:a[3]||(a[3]=(...e)=>o.bindTimeChange&&o.bindTimeChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.hours,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(o.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.minutes,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(o.lessThanTen(t)),1)])))),128))]),n.hideSecond?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("picker-view-column",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.seconds,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(o.lessThanTen(t)),1)])))),128))]))],42,["indicator-style","value"]),e.createElementVNode("text",{class:e.normalizeClass(["uni-datetime-picker-sign",[n.hideSecond?"sign-center":"sign-left"]])},":",2),n.hideSecond?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-datetime-picker-sign sign-right"},":"))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-datetime-picker-btn"},[e.createElementVNode("view",{onClick:a[4]||(a[4]=(...e)=>o.clearTime&&o.clearTime(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(o.clearText),1)]),e.createElementVNode("view",{class:"uni-datetime-picker-btn-group"},[e.createElementVNode("view",{class:"uni-datetime-picker-cancel",onClick:a[5]||(a[5]=(...e)=>o.tiggerTimePicker&&o.tiggerTimePicker(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(o.cancelText),1)]),e.createElementVNode("view",{onClick:a[6]||(a[6]=(...e)=>o.setTime&&o.setTime(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(o.okText),1)])])])],6)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-4032e438"]]),{t:ve}=G(he);const we=C({name:"UniDatetimePicker",options:{virtualHost:!0},components:{Calendar:C({components:{calendarItem:pe,timePicker:fe},options:{virtualHost:!0},props:{date:{type:String,default:""},defTime:{type:[String,Object],default:""},selectableTimes:{type:[Object],default:()=>({})},selected:{type:Array,default:()=>[]},startDate:{type:String,default:""},endDate:{type:String,default:""},startPlaceholder:{type:String,default:""},endPlaceholder:{type:String,default:""},range:{type:Boolean,default:!1},hasTime:{type:Boolean,default:!1},insert:{type:Boolean,default:!0},showMonth:{type:Boolean,default:!0},clearDate:{type:Boolean,default:!0},checkHover:{type:Boolean,default:!0},hideSecond:{type:[Boolean],default:!1},pleStatus:{type:Object,default:()=>({before:"",after:"",data:[],fulldate:""})},defaultValue:{type:[String,Object,Array],default:""}},data:()=>({show:!1,weeks:[],calendar:{},nowDate:{},aniMaskShow:!1,firstEnter:!0,time:"",timeRange:{startTime:"",endTime:""},tempSingleDate:"",tempRange:{before:"",after:""}}),watch:{date:{immediate:!0,handler(e){this.range||(this.tempSingleDate=e,setTimeout((()=>{this.init(e)}),100))}},defTime:{immediate:!0,handler(e){this.range?(this.timeRange.startTime=e.start,this.timeRange.endTime=e.end):this.time=e}},startDate(e){this.cale&&(this.cale.setStartDate(e),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},endDate(e){this.cale&&(this.cale.setEndDate(e),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},selected(e){this.cale&&(this.cale.setSelectInfo(this.nowDate.fullDate,e),this.weeks=this.cale.weeks)},pleStatus:{immediate:!0,handler(e){const{before:t,after:a,fulldate:n,which:i}=e;this.tempRange.before=t,this.tempRange.after=a,setTimeout((()=>{if(n)if(this.cale.setHoverMultiple(n),t&&a){if(this.cale.lastHover=!0,this.rangeWithinMonth(a,t))return;this.setDate(t)}else this.cale.setMultiple(n),this.setDate(this.nowDate.fullDate),this.calendar.fullDate="",this.cale.lastHover=!1;else{if(!this.cale)return;this.cale.setDefaultMultiple(t,a),"left"===i&&t?(this.setDate(t),this.weeks=this.cale.weeks):a&&(this.setDate(a),this.weeks=this.cale.weeks),this.cale.lastHover=!0}}),16)}}},computed:{timepickerStartTime(){return(this.range?this.tempRange.before:this.calendar.fullDate)===this.startDate?this.selectableTimes.start:""},timepickerEndTime(){return(this.range?this.tempRange.after:this.calendar.fullDate)===this.endDate?this.selectableTimes.end:""},selectDateText:()=>ve("uni-datetime-picker.selectDate"),startDateText(){return this.startPlaceholder||ve("uni-datetime-picker.startDate")},endDateText(){return this.endPlaceholder||ve("uni-datetime-picker.endDate")},okText:()=>ve("uni-datetime-picker.ok"),yearText:()=>ve("uni-datetime-picker.year"),monthText:()=>ve("uni-datetime-picker.month"),MONText:()=>ve("uni-calender.MON"),TUEText:()=>ve("uni-calender.TUE"),WEDText:()=>ve("uni-calender.WED"),THUText:()=>ve("uni-calender.THU"),FRIText:()=>ve("uni-calender.FRI"),SATText:()=>ve("uni-calender.SAT"),SUNText:()=>ve("uni-calender.SUN"),confirmText:()=>ve("uni-calender.confirm")},created(){this.cale=new class{constructor({selected:e,startDate:t,endDate:a,range:n}={}){this.date=this.getDateObj(new Date),this.selected=e||[],this.startDate=t,this.endDate=a,this.range=n,this.cleanMultipleStatus(),this.weeks={},this.lastHover=!1}setDate(e){const t=this.getDateObj(e);this.getWeeks(t.fullDate)}cleanMultipleStatus(){this.multipleStatus={before:"",after:"",data:[]}}setStartDate(e){this.startDate=e}setEndDate(e){this.endDate=e}getPreMonthObj(e){e=me(e);const t=(e=new Date(e)).getMonth();e.setMonth(t-1);const a=e.getMonth();return 0!==t&&a-t==0&&e.setMonth(a-1),this.getDateObj(e)}getNextMonthObj(e){e=me(e);const t=(e=new Date(e)).getMonth();e.setMonth(t+1);const a=e.getMonth();return a-t>1&&e.setMonth(a-1),this.getDateObj(e)}getDateObj(e){return e=me(e),{fullDate:le(e=new Date(e)),year:e.getFullYear(),month:se(e.getMonth()+1),date:se(e.getDate()),day:e.getDay()}}getPreMonthDays(e,t){const a=[];for(let n=e-1;n>=0;n--){const e=t.month-1;a.push({date:new Date(t.year,e,-n).getDate(),month:e,disable:!0})}return a}getCurrentMonthDays(e,t){const a=[],n=this.date.fullDate;for(let i=1;i<=e;i++){const e=`${t.year}-${t.month}-${se(i)}`,l=n===e,o=this.selected&&this.selected.find((t=>{if(this.dateEqual(e,t.date))return t}));this.startDate&&ce(this.startDate,e),this.endDate&&ce(e,this.endDate);let s=this.multipleStatus.data,r=-1;this.range&&s&&(r=s.findIndex((t=>this.dateEqual(t,e))));const c=-1!==r;a.push({fullDate:e,year:t.year,date:i,multiple:!!this.range&&c,beforeMultiple:this.isLogicBefore(e,this.multipleStatus.before,this.multipleStatus.after),afterMultiple:this.isLogicAfter(e,this.multipleStatus.before,this.multipleStatus.after),month:t.month,disable:this.startDate&&!ce(this.startDate,e)||this.endDate&&!ce(e,this.endDate),isToday:l,userChecked:!1,extraInfo:o})}return a}_getNextMonthDays(e,t){const a=[],n=t.month+1;for(let i=1;i<=e;i++)a.push({date:i,month:n,disable:!0});return a}getInfo(e){return e||(e=new Date),this.calendar.find((t=>t.fullDate===this.getDateObj(e).fullDate))}dateEqual(e,t){return e=new Date(me(e)),t=new Date(me(t)),e.valueOf()===t.valueOf()}isLogicBefore(e,t,a){let n=t;return t&&a&&(n=ce(t,a)?t:a),this.dateEqual(n,e)}isLogicAfter(e,t,a){let n=a;return t&&a&&(n=ce(t,a)?a:t),this.dateEqual(n,e)}geDateAll(e,t){var a=[],n=e.split("-"),i=t.split("-"),l=new Date;l.setFullYear(n[0],n[1]-1,n[2]);var o=new Date;o.setFullYear(i[0],i[1]-1,i[2]);for(var s=l.getTime()-864e5,r=o.getTime()-864e5,c=s;c<=r;)c+=864e5,a.push(this.getDateObj(new Date(parseInt(c))).fullDate);return a}setMultiple(e){if(!this.range)return;let{before:t,after:a}=this.multipleStatus;if(t&&a){if(!this.lastHover)return void(this.lastHover=!0);this.multipleStatus.before=e,this.multipleStatus.after="",this.multipleStatus.data=[],this.multipleStatus.fulldate="",this.lastHover=!1}else t?(this.multipleStatus.after=e,ce(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before),this.lastHover=!0):(this.multipleStatus.before=e,this.multipleStatus.after=void 0,this.lastHover=!1);this.getWeeks(e)}setHoverMultiple(e){if(!this.range||this.lastHover)return;const{before:t}=this.multipleStatus;t?(this.multipleStatus.after=e,ce(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before)):this.multipleStatus.before=e,this.getWeeks(e)}setDefaultMultiple(e,t){this.multipleStatus.before=e,this.multipleStatus.after=t,e&&t&&(ce(e,t)?(this.multipleStatus.data=this.geDateAll(e,t),this.getWeeks(t)):(this.multipleStatus.data=this.geDateAll(t,e),this.getWeeks(e)))}getWeeks(e){const{year:t,month:a}=this.getDateObj(e),n=new Date(t,a-1,1).getDay(),i=this.getPreMonthDays(n,this.getDateObj(e)),l=new Date(t,a,0).getDate(),o=42-n-l,s=[...i,...this.getCurrentMonthDays(l,this.getDateObj(e)),...this._getNextMonthDays(o,this.getDateObj(e))],r=new Array(6);for(let c=0;c<s.length;c++){const e=Math.floor(c/7);r[e]||(r[e]=new Array(7)),r[e][c%7]=s[c]}this.calendar=s,this.weeks=r}}({selected:this.selected,startDate:this.startDate,endDate:this.endDate,range:this.range}),this.init(this.date)},methods:{leaveCale(){this.firstEnter=!0},handleMouse(e){if(e.disable)return;if(this.cale.lastHover)return;let{before:t,after:a}=this.cale.multipleStatus;t&&(this.calendar=e,this.cale.setHoverMultiple(this.calendar.fullDate),this.weeks=this.cale.weeks,this.firstEnter&&(this.$emit("firstEnterCale",this.cale.multipleStatus),this.firstEnter=!1))},rangeWithinMonth(e,t){const[a,n]=e.split("-"),[i,l]=t.split("-");return a===i&&n===l},maskClick(){this.close(),this.$emit("maskClose")},clearCalender(){this.range?(this.timeRange.startTime="",this.timeRange.endTime="",this.tempRange.before="",this.tempRange.after="",this.cale.multipleStatus.before="",this.cale.multipleStatus.after="",this.cale.multipleStatus.data=[],this.cale.lastHover=!1):(this.time="",this.tempSingleDate=""),this.calendar.fullDate="",this.setDate(new Date)},bindDateChange(e){const t=e.detail.value+"-1";this.setDate(t)},init(e){if(this.cale&&(this.cale.setDate(e||new Date),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(e),this.calendar={...this.nowDate},!e&&(this.calendar.fullDate="",this.defaultValue&&!this.range))){const e=new Date(this.defaultValue),t=le(e),a=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),l=e.getDay();this.calendar={fullDate:t,year:a,month:n,date:i,day:l},this.tempSingleDate=t,this.time=oe(e,this.hideSecond)}},open(){this.clearDate&&!this.insert&&(this.cale.cleanMultipleStatus(),this.init(this.date)),this.show=!0,this.$nextTick((()=>{setTimeout((()=>{this.aniMaskShow=!0}),50)}))},close(){this.aniMaskShow=!1,this.$nextTick((()=>{setTimeout((()=>{this.show=!1,this.$emit("close")}),300)}))},confirm(){this.setEmit("confirm"),this.close()},change(e){(this.insert||e)&&this.setEmit("change")},monthSwitch(){let{year:e,month:t}=this.nowDate;this.$emit("monthSwitch",{year:e,month:Number(t)})},setEmit(e){this.range||(this.calendar.fullDate||(this.calendar=this.cale.getInfo(new Date),this.tempSingleDate=this.calendar.fullDate),this.hasTime&&!this.time&&(this.time=oe(new Date,this.hideSecond)));let{year:t,month:a,date:n,fullDate:i,extraInfo:l}=this.calendar;this.$emit(e,{range:this.cale.multipleStatus,year:t,month:a,date:n,time:this.time,timeRange:this.timeRange,fulldate:i,extraInfo:l||{}})},choiceDate(e){if(e.disable)return;this.calendar=e,this.calendar.userChecked=!0,this.cale.setMultiple(this.calendar.fullDate,!0),this.weeks=this.cale.weeks,this.tempSingleDate=this.calendar.fullDate;const t=new Date(this.cale.multipleStatus.before).getTime(),a=new Date(this.cale.multipleStatus.after).getTime();t>a&&a?(this.tempRange.before=this.cale.multipleStatus.after,this.tempRange.after=this.cale.multipleStatus.before):(this.tempRange.before=this.cale.multipleStatus.before,this.tempRange.after=this.cale.multipleStatus.after),this.change(!0)},changeMonth(e){let t;"pre"===e?t=this.cale.getPreMonthObj(this.nowDate.fullDate).fullDate:"next"===e&&(t=this.cale.getNextMonthObj(this.nowDate.fullDate).fullDate),this.setDate(t),this.monthSwitch()},setDate(e){this.cale.setDate(e),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(e)}}},[["render",function(t,n,i,l,o,s){const r=e.resolveComponent("calendar-item"),c=e.resolveComponent("time-picker"),d=a(e.resolveDynamicComponent("uni-icons"),ee);return e.openBlock(),e.createElementBlock("view",{class:"uni-calendar",onMouseleave:n[9]||(n[9]=(...e)=>s.leaveCale&&s.leaveCale(...e))},[!i.insert&&o.show?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-calendar__mask",{"uni-calendar--mask-show":o.aniMaskShow}]),onClick:n[0]||(n[0]=(...e)=>s.maskClick&&s.maskClick(...e))},null,2)):e.createCommentVNode("",!0),i.insert||o.show?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["uni-calendar__content",{"uni-calendar--fixed":!i.insert,"uni-calendar--ani-show":o.aniMaskShow,"uni-calendar__content-mobile":o.aniMaskShow}])},[e.createElementVNode("view",{class:e.normalizeClass(["uni-calendar__header",{"uni-calendar__header-mobile":!i.insert}])},[e.createElementVNode("view",{class:"uni-calendar__header-btn-box",onClick:n[1]||(n[1]=e.withModifiers((e=>s.changeMonth("pre")),["stop"]))},[e.createElementVNode("view",{class:"uni-calendar__header-btn uni-calendar--left"})]),e.createElementVNode("picker",{mode:"date",value:i.date,fields:"month",onChange:n[2]||(n[2]=(...e)=>s.bindDateChange&&s.bindDateChange(...e))},[e.createElementVNode("text",{class:"uni-calendar__header-text"},e.toDisplayString((o.nowDate.year||"")+s.yearText+(o.nowDate.month||"")+s.monthText),1)],40,["value"]),e.createElementVNode("view",{class:"uni-calendar__header-btn-box",onClick:n[3]||(n[3]=e.withModifiers((e=>s.changeMonth("next")),["stop"]))},[e.createElementVNode("view",{class:"uni-calendar__header-btn uni-calendar--right"})]),i.insert?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"dialog-close",onClick:n[4]||(n[4]=(...e)=>s.maskClick&&s.maskClick(...e))},[e.createElementVNode("view",{class:"dialog-close-plus","data-id":"close"}),e.createElementVNode("view",{class:"dialog-close-plus dialog-close-rotate","data-id":"close"})]))],2),e.createElementVNode("view",{class:"uni-calendar__box"},[i.showMonth?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-calendar__box-bg"},[e.createElementVNode("text",{class:"uni-calendar__box-bg-text"},e.toDisplayString(o.nowDate.month),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-calendar__weeks",style:{"padding-bottom":"7px"}},[e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(s.SUNText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(s.MONText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(s.TUEText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(s.WEDText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(s.THUText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(s.FRIText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(s.SATText),1)])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.weeks,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-calendar__weeks",key:a},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-calendar__weeks-item",key:a},[e.createVNode(r,{class:"uni-calendar-item--hook",weeks:t,calendar:o.calendar,selected:i.selected,checkHover:i.range,onChange:s.choiceDate,onHandleMouse:s.handleMouse},null,8,["weeks","calendar","selected","checkHover","onChange","onHandleMouse"])])))),128))])))),128))]),i.insert||i.range||!i.hasTime?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-changed uni-calendar--fixed-top",style:{padding:"0 80px"}},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(o.tempSingleDate?o.tempSingleDate:s.selectDateText),1),e.createVNode(c,{type:"time",start:s.timepickerStartTime,end:s.timepickerEndTime,modelValue:o.time,"onUpdate:modelValue":n[5]||(n[5]=e=>o.time=e),disabled:!o.tempSingleDate,border:!1,"hide-second":i.hideSecond,class:"time-picker-style"},null,8,["start","end","modelValue","disabled","hide-second"])])),!i.insert&&i.range&&i.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-changed uni-calendar--fixed-top"},[e.createElementVNode("view",{class:"uni-date-changed--time-start"},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(o.tempRange.before?o.tempRange.before:s.startDateText),1),e.createVNode(c,{type:"time",start:s.timepickerStartTime,modelValue:o.timeRange.startTime,"onUpdate:modelValue":n[6]||(n[6]=e=>o.timeRange.startTime=e),border:!1,"hide-second":i.hideSecond,disabled:!o.tempRange.before,class:"time-picker-style"},null,8,["start","modelValue","hide-second","disabled"])]),e.createElementVNode("view",{style:{"line-height":"50px"}},[e.createVNode(d,{type:"arrowthinright",color:"#999"})]),e.createElementVNode("view",{class:"uni-date-changed--time-end"},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(o.tempRange.after?o.tempRange.after:s.endDateText),1),e.createVNode(c,{type:"time",end:s.timepickerEndTime,modelValue:o.timeRange.endTime,"onUpdate:modelValue":n[7]||(n[7]=e=>o.timeRange.endTime=e),border:!1,"hide-second":i.hideSecond,disabled:!o.tempRange.after,class:"time-picker-style"},null,8,["end","modelValue","hide-second","disabled"])])])):e.createCommentVNode("",!0),i.insert?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"uni-date-changed uni-date-btn--ok"},[e.createElementVNode("view",{class:"uni-datetime-picker--btn",onClick:n[8]||(n[8]=(...e)=>s.confirm&&s.confirm(...e))},e.toDisplayString(s.confirmText),1)]))],2)):e.createCommentVNode("",!0)],32)}],["__scopeId","data-v-f219fc6e"]]),TimePicker:fe},data:()=>({isRange:!1,hasTime:!1,displayValue:"",inputDate:"",calendarDate:"",pickerTime:"",calendarRange:{startDate:"",startTime:"",endDate:"",endTime:""},displayRangeValue:{startDate:"",endDate:""},tempRange:{startDate:"",startTime:"",endDate:"",endTime:""},startMultipleStatus:{before:"",after:"",data:[],fulldate:""},endMultipleStatus:{before:"",after:"",data:[],fulldate:""},pickerVisible:!1,pickerPositionStyle:null,isEmitValue:!1,isPhone:!1,isFirstShow:!0,i18nT:()=>{}}),props:{type:{type:String,default:"datetime"},value:{type:[String,Number,Array,Date],default:""},modelValue:{type:[String,Number,Array,Date],default:""},start:{type:[Number,String],default:""},end:{type:[Number,String],default:""},returnType:{type:String,default:"string"},placeholder:{type:String,default:""},startPlaceholder:{type:String,default:""},endPlaceholder:{type:String,default:""},rangeSeparator:{type:String,default:"-"},border:{type:[Boolean],default:!0},disabled:{type:[Boolean],default:!1},clearIcon:{type:[Boolean],default:!0},hideSecond:{type:[Boolean],default:!1},defaultValue:{type:[String,Object,Array],default:""}},watch:{type:{immediate:!0,handler(e){this.hasTime=-1!==e.indexOf("time"),this.isRange=-1!==e.indexOf("range")}},modelValue:{immediate:!0,handler(e){this.isEmitValue?this.isEmitValue=!1:this.initPicker(e)}},start:{immediate:!0,handler(e){e&&(this.calendarRange.startDate=le(e),this.hasTime&&(this.calendarRange.startTime=oe(e)))}},end:{immediate:!0,handler(e){e&&(this.calendarRange.endDate=le(e),this.hasTime&&(this.calendarRange.endTime=oe(e,this.hideSecond)))}}},computed:{timepickerStartTime(){return(this.isRange?this.tempRange.startDate:this.inputDate)===this.calendarRange.startDate?this.calendarRange.startTime:""},timepickerEndTime(){return(this.isRange?this.tempRange.endDate:this.inputDate)===this.calendarRange.endDate?this.calendarRange.endTime:""},mobileCalendarTime(){const e={start:this.tempRange.startTime,end:this.tempRange.endTime};return this.isRange?e:this.pickerTime},mobSelectableTime(){return{start:this.calendarRange.startTime,end:this.calendarRange.endTime}},datePopupWidth(){return this.isRange?653:301},singlePlaceholderText(){return this.placeholder||("date"===this.type?this.selectDateText:this.selectDateTimeText)},startPlaceholderText(){return this.startPlaceholder||this.startDateText},endPlaceholderText(){return this.endPlaceholder||this.endDateText},selectDateText(){return this.i18nT("uni-datetime-picker.selectDate")},selectDateTimeText(){return this.i18nT("uni-datetime-picker.selectDateTime")},selectTimeText(){return this.i18nT("uni-datetime-picker.selectTime")},startDateText(){return this.startPlaceholder||this.i18nT("uni-datetime-picker.startDate")},startTimeText(){return this.i18nT("uni-datetime-picker.startTime")},endDateText(){return this.endPlaceholder||this.i18nT("uni-datetime-picker.endDate")},endTimeText(){return this.i18nT("uni-datetime-picker.endTime")},okText(){return this.i18nT("uni-datetime-picker.ok")},clearText(){return this.i18nT("uni-datetime-picker.clear")},showClearIcon(){return this.clearIcon&&!this.disabled&&(this.displayValue||this.displayRangeValue.startDate&&this.displayRangeValue.endDate)}},created(){this.initI18nT(),this.platform()},methods:{initI18nT(){const e=G(he);this.i18nT=e.t},initPicker(e){if(!e&&!this.defaultValue||Array.isArray(e)&&!e.length)this.$nextTick((()=>{this.clear(!1)}));else if(Array.isArray(e)||this.isRange){const[t,a]=e;if(!t&&!a)return;const n=le(t),i=oe(t,this.hideSecond),l=le(a),o=oe(a,this.hideSecond),s=n,r=l;this.displayRangeValue.startDate=this.tempRange.startDate=s,this.displayRangeValue.endDate=this.tempRange.endDate=r,this.hasTime&&(this.displayRangeValue.startDate=`${n} ${i}`,this.displayRangeValue.endDate=`${l} ${o}`,this.tempRange.startTime=i,this.tempRange.endTime=o);const c={before:n,after:l};this.startMultipleStatus=Object.assign({},this.startMultipleStatus,c,{which:"right"}),this.endMultipleStatus=Object.assign({},this.endMultipleStatus,c,{which:"left"})}else e?(this.displayValue=this.inputDate=this.calendarDate=le(e),this.hasTime&&(this.pickerTime=oe(e,this.hideSecond),this.displayValue=`${this.displayValue} ${this.pickerTime}`)):this.defaultValue&&(this.inputDate=this.calendarDate=le(this.defaultValue),this.hasTime&&(this.pickerTime=oe(this.defaultValue,this.hideSecond)))},updateLeftCale(e){const t=this.$refs.left;t.cale.setHoverMultiple(e.after),t.setDate(this.$refs.left.nowDate.fullDate)},updateRightCale(e){const t=this.$refs.right;t.cale.setHoverMultiple(e.after),t.setDate(this.$refs.right.nowDate.fullDate)},platform(){if("undefined"!=typeof navigator)return void(this.isPhone=-1!==navigator.userAgent.toLowerCase().indexOf("mobile"));const{windowWidth:e}=uni.getSystemInfoSync();this.isPhone=e<=500,this.windowWidth=e},show(){if(this.$emit("show"),this.disabled)return;if(this.platform(),this.isPhone)return void setTimeout((()=>{this.$refs.mobile.open()}),0);this.pickerPositionStyle={top:"10px"};uni.createSelectorQuery().in(this).select(".uni-date-editor").boundingClientRect((e=>{this.windowWidth-e.left<this.datePopupWidth&&(this.pickerPositionStyle.right=0)})).exec(),setTimeout((()=>{if(this.pickerVisible=!this.pickerVisible,!this.isPhone&&this.isRange&&this.isFirstShow){this.isFirstShow=!1;const{startDate:e,endDate:t}=this.calendarRange;e&&t?this.diffDate(e,t)<30&&this.$refs.right.changeMonth("pre"):this.isPhone&&(this.$refs.right.cale.lastHover=!1)}}),50)},close(){setTimeout((()=>{this.pickerVisible=!1,this.$emit("maskClick",this.value),this.$refs.mobile&&this.$refs.mobile.close()}),20)},setEmit(e){"timestamp"!==this.returnType&&"date"!==this.returnType||(Array.isArray(e)?(this.hasTime||(e[0]=e[0]+" 00:00:00",e[1]=e[1]+" 00:00:00"),e[0]=this.createTimestamp(e[0]),e[1]=this.createTimestamp(e[1]),"date"===this.returnType&&(e[0]=new Date(e[0]),e[1]=new Date(e[1]))):(this.hasTime||(e+=" 00:00:00"),e=this.createTimestamp(e),"date"===this.returnType&&(e=new Date(e)))),this.$emit("update:modelValue",e),this.$emit("input",e),this.$emit("change",e),this.isEmitValue=!0},createTimestamp:e=>(e=me(e),Date.parse(new Date(e))),singleChange(e){this.calendarDate=this.inputDate=e.fulldate,this.hasTime||this.confirmSingleChange()},confirmSingleChange(){if(!de(this.inputDate)){const e=new Date;this.calendarDate=this.inputDate=le(e),this.pickerTime=oe(e,this.hideSecond)}let e,t,a=!1;if(this.start){let n=this.start;"number"==typeof this.start&&(n=ie(this.start,this.hideSecond)),[e,t]=n.split(" "),this.start&&!ce(e,this.inputDate)&&(a=!0,this.inputDate=e)}let n,i,l=!1;if(this.end){let e=this.end;"number"==typeof this.end&&(e=ie(this.end,this.hideSecond)),[n,i]=e.split(" "),this.end&&!ce(this.inputDate,n)&&(l=!0,this.inputDate=n)}this.hasTime?(a&&(this.pickerTime=t||re(this.hideSecond)),l&&(this.pickerTime=i||re(this.hideSecond)),this.pickerTime||(this.pickerTime=oe(Date.now(),this.hideSecond)),this.displayValue=`${this.inputDate} ${this.pickerTime}`):this.displayValue=this.inputDate,this.setEmit(this.displayValue),this.pickerVisible=!1},leftChange(e){const{before:t,after:a}=e.range;this.rangeChange(t,a);const n={before:e.range.before,after:e.range.after,data:e.range.data,fulldate:e.fulldate};this.startMultipleStatus=Object.assign({},this.startMultipleStatus,n),this.$emit("calendarClick",e)},rightChange(e){const{before:t,after:a}=e.range;this.rangeChange(t,a);const n={before:e.range.before,after:e.range.after,data:e.range.data,fulldate:e.fulldate};this.endMultipleStatus=Object.assign({},this.endMultipleStatus,n),this.$emit("calendarClick",e)},mobileChange(e){if(this.isRange){const{before:t,after:a}=e.range;if(!t)return;if(this.handleStartAndEnd(t,a,!0),this.hasTime){const{startTime:t,endTime:a}=e.timeRange;this.tempRange.startTime=t,this.tempRange.endTime=a}this.confirmRangeChange()}else this.hasTime?this.displayValue=e.fulldate+" "+e.time:this.displayValue=e.fulldate,this.setEmit(this.displayValue);this.$refs.mobile.close()},rangeChange(e,t){e&&t&&(this.handleStartAndEnd(e,t,!0),this.hasTime||this.confirmRangeChange())},confirmRangeChange(){if(!this.tempRange.startDate||!this.tempRange.endDate)return void(this.pickerVisible=!1);let e,t;de(this.tempRange.startDate)||(this.tempRange.startDate=le(Date.now())),de(this.tempRange.endDate)||(this.tempRange.endDate=le(Date.now()));let a,n,i=!1,l=!1;if(this.start){let e=this.start;"number"==typeof this.start&&(e=ie(this.start,this.hideSecond)),[a,n]=e.split(" "),this.start&&!ce(this.start,this.tempRange.startDate)&&(i=!0,this.tempRange.startDate=a),this.start&&!ce(this.start,this.tempRange.endDate)&&(l=!0,this.tempRange.endDate=a)}let o,s,r=!1,c=!1;if(this.end){let e=this.end;"number"==typeof this.end&&(e=ie(this.end,this.hideSecond)),[o,s]=e.split(" "),this.end&&!ce(this.tempRange.startDate,this.end)&&(r=!0,this.tempRange.startDate=o),this.end&&!ce(this.tempRange.endDate,this.end)&&(c=!0,this.tempRange.endDate=o)}this.hasTime?(i?this.tempRange.startTime=n||re(this.hideSecond):r&&(this.tempRange.startTime=s||re(this.hideSecond)),this.tempRange.startTime||(this.tempRange.startTime=oe(Date.now(),this.hideSecond)),l?this.tempRange.endTime=n||re(this.hideSecond):c&&(this.tempRange.endTime=s||re(this.hideSecond)),this.tempRange.endTime||(this.tempRange.endTime=oe(Date.now(),this.hideSecond)),e=this.displayRangeValue.startDate=`${this.tempRange.startDate} ${this.tempRange.startTime}`,t=this.displayRangeValue.endDate=`${this.tempRange.endDate} ${this.tempRange.endTime}`):(e=this.displayRangeValue.startDate=this.tempRange.startDate,t=this.displayRangeValue.endDate=this.tempRange.endDate),ce(e,t)||([e,t]=[t,e]),this.displayRangeValue.startDate=e,this.displayRangeValue.endDate=t;const d=[e,t];this.setEmit(d),this.pickerVisible=!1},handleStartAndEnd(e,t,a=!1){if(!e)return;t||(t=e);const n=a?"tempRange":"range",i=ce(e,t);this[n].startDate=i?e:t,this[n].endDate=i?t:e},dateCompare:(e,t)=>(e=new Date(e.replace("-","/").replace("-","/")))<=(t=new Date(t.replace("-","/").replace("-","/"))),diffDate(e,t){e=new Date(e.replace("-","/").replace("-","/"));const a=((t=new Date(t.replace("-","/").replace("-","/")))-e)/864e5;return Math.abs(a)},clear(e=!0){this.isRange?(this.displayRangeValue.startDate="",this.displayRangeValue.endDate="",this.tempRange.startDate="",this.tempRange.startTime="",this.tempRange.endDate="",this.tempRange.endTime="",this.isPhone?this.$refs.mobile&&this.$refs.mobile.clearCalender():(this.$refs.left&&this.$refs.left.clearCalender(),this.$refs.right&&this.$refs.right.clearCalender(),this.$refs.right&&this.$refs.right.changeMonth("next")),e&&(this.$emit("change",[]),this.$emit("input",[]),this.$emit("update:modelValue",[]))):(this.displayValue="",this.inputDate="",this.pickerTime="",this.isPhone?this.$refs.mobile&&this.$refs.mobile.clearCalender():this.$refs.pcSingle&&this.$refs.pcSingle.clearCalender(),e&&(this.$emit("change",""),this.$emit("input",""),this.$emit("update:modelValue","")))},calendarClick(e){this.$emit("calendarClick",e)}}},[["render",function(t,n,i,l,o,s){const r=a(e.resolveDynamicComponent("uni-icons"),ee),c=e.resolveComponent("time-picker"),d=e.resolveComponent("Calendar");return e.openBlock(),e.createElementBlock("view",{class:"uni-date"},[e.createElementVNode("view",{class:"uni-date-editor",onClick:n[1]||(n[1]=(...e)=>s.show&&s.show(...e))},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-date-editor--x",{"uni-date-editor--x__disabled":i.disabled,"uni-date-x--border":i.border}])},[o.isRange?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-x uni-date-range"},[e.createVNode(r,{class:"icon-calendar",type:"calendar",color:"#c0c4cc",size:"22"}),e.createElementVNode("view",{class:"uni-date__x-input text-center"},e.toDisplayString(o.displayRangeValue.startDate||s.startPlaceholderText),1),e.createElementVNode("view",{class:"range-separator"},e.toDisplayString(i.rangeSeparator),1),e.createElementVNode("view",{class:"uni-date__x-input text-center"},e.toDisplayString(o.displayRangeValue.endDate||s.endPlaceholderText),1)])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-x uni-date-single"},[e.createVNode(r,{class:"icon-calendar",type:"calendar",color:"#c0c4cc",size:"22"}),e.createElementVNode("view",{class:"uni-date__x-input"},e.toDisplayString(o.displayValue||s.singlePlaceholderText),1)])),s.showClearIcon?(e.openBlock(),e.createElementBlock("view",{key:2,class:"uni-date__icon-clear",onClick:n[0]||(n[0]=e.withModifiers(((...e)=>s.clear&&s.clear(...e)),["stop"]))},[e.createVNode(r,{type:"clear",color:"#c0c4cc",size:"22"})])):e.createCommentVNode("",!0)],2)]),!0)]),e.withDirectives(e.createElementVNode("view",{class:"uni-date-mask--pc",onClick:n[2]||(n[2]=(...e)=>s.close&&s.close(...e))},null,512),[[e.vShow,o.pickerVisible]]),o.isPhone?e.createCommentVNode("",!0):e.withDirectives((e.openBlock(),e.createElementBlock("view",{key:0,ref:"datePicker",class:"uni-date-picker__container"},[o.isRange?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-range--x",style:e.normalizeStyle(o.pickerPositionStyle)},[e.createElementVNode("view",{class:"uni-popper__arrow"}),o.hasTime?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-x-header uni-date-changed"},[e.createElementVNode("view",{class:"popup-x-header--datetime"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":n[7]||(n[7]=e=>o.tempRange.startDate=e),placeholder:s.startDateText},null,8,["placeholder"]),[[e.vModelText,o.tempRange.startDate]]),e.createVNode(c,{type:"time",modelValue:o.tempRange.startTime,"onUpdate:modelValue":n[9]||(n[9]=e=>o.tempRange.startTime=e),start:s.timepickerStartTime,border:!1,disabled:!o.tempRange.startDate,hideSecond:i.hideSecond},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":n[8]||(n[8]=e=>o.tempRange.startTime=e),placeholder:s.startTimeText,disabled:!o.tempRange.startDate},null,8,["placeholder","disabled"]),[[e.vModelText,o.tempRange.startTime]])])),_:1},8,["modelValue","start","disabled","hideSecond"])]),e.createVNode(r,{type:"arrowthinright",color:"#999",style:{"line-height":"40px"}}),e.createElementVNode("view",{class:"popup-x-header--datetime"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":n[10]||(n[10]=e=>o.tempRange.endDate=e),placeholder:s.endDateText},null,8,["placeholder"]),[[e.vModelText,o.tempRange.endDate]]),e.createVNode(c,{type:"time",modelValue:o.tempRange.endTime,"onUpdate:modelValue":n[12]||(n[12]=e=>o.tempRange.endTime=e),end:s.timepickerEndTime,border:!1,disabled:!o.tempRange.endDate,hideSecond:i.hideSecond},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":n[11]||(n[11]=e=>o.tempRange.endTime=e),placeholder:s.endTimeText,disabled:!o.tempRange.endDate},null,8,["placeholder","disabled"]),[[e.vModelText,o.tempRange.endTime]])])),_:1},8,["modelValue","end","disabled","hideSecond"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"popup-x-body"},[e.createVNode(d,{ref:"left",showMonth:!1,"start-date":o.calendarRange.startDate,"end-date":o.calendarRange.endDate,range:!0,pleStatus:o.endMultipleStatus,onChange:s.leftChange,onFirstEnterCale:s.updateRightCale,style:{padding:"0 8px"}},null,8,["start-date","end-date","pleStatus","onChange","onFirstEnterCale"]),e.createVNode(d,{ref:"right",showMonth:!1,"start-date":o.calendarRange.startDate,"end-date":o.calendarRange.endDate,range:!0,onChange:s.rightChange,pleStatus:o.startMultipleStatus,onFirstEnterCale:s.updateLeftCale,style:{padding:"0 8px","border-left":"1px solid #F1F1F1"}},null,8,["start-date","end-date","onChange","pleStatus","onFirstEnterCale"])]),o.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-x-footer"},[e.createElementVNode("text",{onClick:n[13]||(n[13]=(...e)=>s.clear&&s.clear(...e))},e.toDisplayString(s.clearText),1),e.createElementVNode("text",{class:"confirm-text",onClick:n[14]||(n[14]=(...e)=>s.confirmRangeChange&&s.confirmRangeChange(...e))},e.toDisplayString(s.okText),1)])):e.createCommentVNode("",!0)],4)):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-single--x",style:e.normalizeStyle(o.pickerPositionStyle)},[e.createElementVNode("view",{class:"uni-popper__arrow"}),o.hasTime?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-changed popup-x-header"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input text-center",type:"text","onUpdate:modelValue":n[3]||(n[3]=e=>o.inputDate=e),placeholder:s.selectDateText},null,8,["placeholder"]),[[e.vModelText,o.inputDate]]),e.createVNode(c,{type:"time",modelValue:o.pickerTime,"onUpdate:modelValue":n[5]||(n[5]=e=>o.pickerTime=e),border:!1,disabled:!o.inputDate,start:s.timepickerStartTime,end:s.timepickerEndTime,hideSecond:i.hideSecond,style:{width:"100%"}},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input text-center",type:"text","onUpdate:modelValue":n[4]||(n[4]=e=>o.pickerTime=e),placeholder:s.selectTimeText,disabled:!o.inputDate},null,8,["placeholder","disabled"]),[[e.vModelText,o.pickerTime]])])),_:1},8,["modelValue","disabled","start","end","hideSecond"])])):e.createCommentVNode("",!0),e.createVNode(d,{ref:"pcSingle",showMonth:!1,"start-date":o.calendarRange.startDate,"end-date":o.calendarRange.endDate,date:o.calendarDate,onChange:s.singleChange,"default-value":i.defaultValue,style:{padding:"0 8px"}},null,8,["start-date","end-date","date","onChange","default-value"]),o.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-x-footer"},[e.createElementVNode("text",{class:"confirm-text",onClick:n[6]||(n[6]=(...e)=>s.confirmSingleChange&&s.confirmSingleChange(...e))},e.toDisplayString(s.okText),1)])):e.createCommentVNode("",!0)],4))],512)),[[e.vShow,o.pickerVisible]]),o.isPhone?(e.openBlock(),e.createBlock(d,{key:1,ref:"mobile",clearDate:!1,date:o.calendarDate,defTime:s.mobileCalendarTime,"start-date":o.calendarRange.startDate,"end-date":o.calendarRange.endDate,selectableTimes:s.mobSelectableTime,startPlaceholder:i.startPlaceholder,endPlaceholder:i.endPlaceholder,"default-value":i.defaultValue,pleStatus:o.endMultipleStatus,showMonth:!1,range:o.isRange,hasTime:o.hasTime,insert:!1,hideSecond:i.hideSecond,onConfirm:s.mobileChange,onMaskClose:s.close,onChange:s.calendarClick},null,8,["date","defTime","start-date","end-date","selectableTimes","startPlaceholder","endPlaceholder","default-value","pleStatus","range","hasTime","hideSecond","onConfirm","onMaskClose","onChange"])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-d07cfb0c"]]);const ye=C({name:"UniNumberBox",emits:["change","input","update:modelValue","blur","focus"],props:{value:{type:[Number,String],default:1},modelValue:{type:[Number,String],default:1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},background:{type:String,default:"#f5f5f5"},color:{type:String,default:"#333"},disabled:{type:Boolean,default:!1},width:{type:Number,default:40}},data:()=>({inputValue:0}),watch:{value(e){this.inputValue=+e},modelValue(e){this.inputValue=+e}},computed:{widthWithPx(){return this.width+"px"}},created(){1===this.value&&(this.inputValue=+this.modelValue),1===this.modelValue&&(this.inputValue=+this.value)},methods:{_calcValue(e){if(this.disabled)return;const t=this._getDecimalScale();let a=this.inputValue*t,n=this.step*t;if("minus"===e){if(a-=n,a<this.min*t)return;a>this.max*t&&(a=this.max*t)}if("plus"===e){if(a+=n,a>this.max*t)return;a<this.min*t&&(a=this.min*t)}this.inputValue=(a/t).toFixed(String(t).length-1),this.$emit("input",+this.inputValue),this.$emit("update:modelValue",+this.inputValue),this.$emit("change",+this.inputValue)},_getDecimalScale(){let e=1;return~~this.step!==this.step&&(e=Math.pow(10,String(this.step).split(".")[1].length)),e},_onBlur(e){this.$emit("blur",e);let t=e.detail.value;if(isNaN(t))return void(this.inputValue=this.value);t=+t,t>this.max?t=this.max:t<this.min&&(t=this.min);const a=this._getDecimalScale();this.inputValue=t.toFixed(String(a).length-1),this.$emit("input",+this.inputValue),this.$emit("update:modelValue",+this.inputValue),this.$emit("change",+this.inputValue)},_onFocus(e){this.$emit("focus",e)}}},[["render",function(t,a,n,i,l,o){return e.openBlock(),e.createElementBlock("view",{class:"uni-numbox"},[e.createElementVNode("view",{onClick:a[0]||(a[0]=e=>o._calcValue("minus")),class:"uni-numbox__minus uni-numbox-btns",style:e.normalizeStyle({background:n.background})},[e.createElementVNode("text",{class:e.normalizeClass(["uni-numbox--text",{"uni-numbox--disabled":l.inputValue<=n.min||n.disabled}]),style:e.normalizeStyle({color:n.color})},"-",6)],4),e.withDirectives(e.createElementVNode("input",{disabled:n.disabled,onFocus:a[1]||(a[1]=(...e)=>o._onFocus&&o._onFocus(...e)),onBlur:a[2]||(a[2]=(...e)=>o._onBlur&&o._onBlur(...e)),class:"uni-numbox__value",type:n.step<1?"digit":"number","onUpdate:modelValue":a[3]||(a[3]=e=>l.inputValue=e),style:e.normalizeStyle({background:n.background,color:n.color,width:o.widthWithPx})},null,44,["disabled","type"]),[[e.vModelDynamic,l.inputValue]]),e.createElementVNode("view",{onClick:a[4]||(a[4]=e=>o._calcValue("plus")),class:"uni-numbox__plus uni-numbox-btns",style:e.normalizeStyle({background:n.background})},[e.createElementVNode("text",{class:e.normalizeClass(["uni-numbox--text",{"uni-numbox--disabled":l.inputValue>=n.max||n.disabled}]),style:e.normalizeStyle({color:n.color})},"+",6)],4)])}],["__scopeId","data-v-65cea6c0"]]);var ke={email:/^\S+?@\S+?\.\S+?$/,idcard:/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i")};const Ee={int:"integer",bool:"boolean",double:"number",long:"number",password:"string"};function Ve(e,t=""){["label"].forEach((t=>{void 0===e[t]&&(e[t]="")}));let a=t;for(let n in e){let t=new RegExp("{"+n+"}");a=a.replace(t,e[n])}return a}const Ne={integer:e=>Ne.number(e)&&parseInt(e,10)===e,string:e=>"string"==typeof e,number:e=>!isNaN(e)&&"number"==typeof e,boolean:function(e){return"boolean"==typeof e},float:function(e){return Ne.number(e)&&!Ne.integer(e)},array:e=>Array.isArray(e),object:e=>"object"==typeof e&&!Ne.array(e),date:e=>e instanceof Date,timestamp(e){return!(!this.integer(e)||Math.abs(e).toString().length>16)},file:e=>"string"==typeof e.url,email:e=>"string"==typeof e&&!!e.match(ke.email)&&e.length<255,url:e=>"string"==typeof e&&!!e.match(ke.url),pattern(e,t){try{return new RegExp(e).test(t)}catch(a){return!1}},method:e=>"function"==typeof e,idcard:e=>"string"==typeof e&&!!e.match(ke.idcard),"url-https"(e){return this.url(e)&&e.startsWith("https://")},"url-scheme":e=>e.startsWith("://"),"url-web":e=>!1};const xe={required:(e,t,a)=>e.required&&function(e,t){return null==e||"string"==typeof e&&!e||!(!Array.isArray(e)||e.length)||"object"===t&&!Object.keys(e).length}(t,e.format||typeof t)?Ve(e,e.errorMessage||a.required):null,range(e,t,a){const{range:n,errorMessage:i}=e;let l=new Array(n.length);for(let s=0;s<n.length;s++){const e=n[s];Ne.object(e)&&void 0!==e.value?l[s]=e.value:l[s]=e}let o=!1;return Array.isArray(t)?o=new Set(t.concat(l)).size===l.length:l.indexOf(t)>-1&&(o=!0),o?null:Ve(e,i||a.enum)},rangeNumber(e,t,a){if(!Ne.number(t))return Ve(e,e.errorMessage||a.pattern.mismatch);let{minimum:n,maximum:i,exclusiveMinimum:l,exclusiveMaximum:o}=e,s=l?t<=n:t<n,r=o?t>=i:t>i;return void 0!==n&&s?Ve(e,e.errorMessage||a.number[l?"exclusiveMinimum":"minimum"]):void 0!==i&&r?Ve(e,e.errorMessage||a.number[o?"exclusiveMaximum":"maximum"]):void 0!==n&&void 0!==i&&(s||r)?Ve(e,e.errorMessage||a.number.range):null},rangeLength(e,t,a){if(!Ne.string(t)&&!Ne.array(t))return Ve(e,e.errorMessage||a.pattern.mismatch);let n=e.minLength,i=e.maxLength,l=t.length;return void 0!==n&&l<n?Ve(e,e.errorMessage||a.length.minLength):void 0!==i&&l>i?Ve(e,e.errorMessage||a.length.maxLength):void 0!==n&&void 0!==i&&(l<n||l>i)?Ve(e,e.errorMessage||a.length.range):null},pattern:(e,t,a)=>Ne.pattern(e.pattern,t)?null:Ve(e,e.errorMessage||a.pattern.mismatch),format(e,t,a){var n=Object.keys(Ne),i=Ee[e.format]?Ee[e.format]:e.format||e.arrayType;return n.indexOf(i)>-1&&!Ne[i](t)?Ve(e,e.errorMessage||a.typeError):null},arrayTypeFormat(e,t,a){if(!Array.isArray(t))return Ve(e,e.errorMessage||a.typeError);for(let n=0;n<t.length;n++){const i=t[n];let l=this.format(e,i,a);if(null!==l)return l}return null}};class be extends class{constructor(e){this._message=e}async validateRule(e,t,a,n,i){var l=null;let o=t.rules;if(o.findIndex((e=>e.required))<0){if(null==a)return l;if("string"==typeof a&&!a.length)return l}var s=this._message;if(void 0===o)return s.default;for(var r=0;r<o.length;r++){let c=o[r],d=this._getValidateType(c);if(Object.assign(c,{label:t.label||`["${e}"]`}),xe[d]&&null!=(l=xe[d](c,a,s)))break;if(c.validateExpr){let e=Date.now();if(!1===c.validateExpr(a,i,e)){l=this._getMessage(c,c.errorMessage||this._message.default);break}}if(c.validateFunction&&null!==(l=await this.validateFunction(c,a,n,i,d)))break}return null!==l&&(l=s.TAG+l),l}async validateFunction(e,t,a,n,i){let l=null;try{let o=null;const s=await e.validateFunction(e,t,n||a,(e=>{o=e}));(o||"string"==typeof s&&s||!1===s)&&(l=this._getMessage(e,o||s,i))}catch(o){l=this._getMessage(e,o.message,i)}return l}_getMessage(e,t,a){return Ve(e,t||e.errorMessage||this._message[a]||t.default)}_getValidateType(e){var t="";return e.required?t="required":e.format?t="format":e.arrayType?t="arrayTypeFormat":e.range?t="range":void 0!==e.maximum||void 0!==e.minimum?t="rangeNumber":void 0!==e.maxLength||void 0!==e.minLength?t="rangeLength":e.pattern?t="pattern":e.validateFunction&&(t="validateFunction"),t}}{constructor(e,t){super(be.message),this._schema=e,this._options=t||null}updateSchema(e){this._schema=e}async validate(e,t){let a=this._checkFieldInSchema(e);return a||(a=await this.invokeValidate(e,!1,t)),a.length?a[0]:null}async validateAll(e,t){let a=this._checkFieldInSchema(e);return a||(a=await this.invokeValidate(e,!0,t)),a}async validateUpdate(e,t){let a=this._checkFieldInSchema(e);return a||(a=await this.invokeValidateUpdate(e,!1,t)),a.length?a[0]:null}async invokeValidate(e,t,a){let n=[],i=this._schema;for(let l in i){let o=i[l],s=await this.validateRule(l,o,e[l],e,a);if(null!=s&&(n.push({key:l,errorMessage:s}),!t))break}return n}async invokeValidateUpdate(e,t,a){let n=[];for(let i in e){let l=await this.validateRule(i,this._schema[i],e[i],e,a);if(null!=l&&(n.push({key:i,errorMessage:l}),!t))break}return n}_checkFieldInSchema(e){var t=Object.keys(e),a=Object.keys(this._schema);if(new Set(t.concat(a)).size===a.length)return"";var n=t.filter((e=>a.indexOf(e)<0));return[{key:"invalid",errorMessage:Ve({field:JSON.stringify(n)},be.message.TAG+be.message.defaultInvalid)}]}}be.message=new function(){return{TAG:"",default:"验证错误",defaultInvalid:"提交的字段{field}在数据库中并不存在",validateFunction:"验证无效",required:"{label}必填",enum:"{label}超出范围",timestamp:"{label}格式无效",whitespace:"{label}不能为空",typeError:"{label}类型无效",date:{format:"{label}日期{value}格式无效",parse:"{label}日期无法解析,{value}无效",invalid:"{label}日期{value}无效"},length:{minLength:"{label}长度不能少于{minLength}",maxLength:"{label}长度不能超过{maxLength}",range:"{label}必须介于{minLength}和{maxLength}之间"},number:{minimum:"{label}不能小于{minimum}",maximum:"{label}不能大于{maximum}",exclusiveMinimum:"{label}不能小于等于{minimum}",exclusiveMaximum:"{label}不能大于等于{maximum}",range:"{label}必须介于{minimum}and{maximum}之间"},pattern:{mismatch:"{label}格式不匹配"}}};const Te=(e,t,a)=>{const n=a.find((e=>{return e.format&&("int"===(t=e.format)||"double"===t||"number"===t||"timestamp"===t);var t})),i=a.find((e=>e.format&&"boolean"===e.format||"bool"===e.format));return n&&(t=t||0===t?Ie(Number(t))?Number(t):t:null),i&&(t=!!Ae(t)&&t),t},Se=(e,t)=>Me(t,e),Ce=(e,t={})=>{const a=_e(e);if("object"==typeof a&&Array.isArray(a)&&a.length>1){return a.reduce(((e,t)=>e+`#${t}`),"_formdata_")}return a[0]||e},De=e=>{let t=e.replace("_formdata_#","");return t=t.split("#").map((e=>Ie(e)?Number(e):e)),t},Be=(e,t,a)=>("object"!=typeof e||_e(t).reduce(((e,t,n,i)=>n===i.length-1?(e[t]=a,null):(t in e||(e[t]=/^[0-9]{1,}$/.test(i[n+1])?[]:{}),e[t])),e),e);function _e(e){return Array.isArray(e)?e:e.replace(/\[/g,".").replace(/\]/g,"").split(".")}const Me=(e,t,a="undefined")=>{let n=_e(t).reduce(((e,t)=>(e||{})[t]),e);return n&&void 0===n?a:n},Ie=e=>!isNaN(Number(e)),Ae=e=>"boolean"==typeof e;const Re=C({name:"uniForms",emits:["validate","submit"],options:{virtualHost:!0},props:{value:{type:Object,default:()=>null},modelValue:{type:Object,default:()=>null},model:{type:Object,default:()=>null},rules:{type:Object,default:()=>({})},errShowType:{type:String,default:"undertext"},validateTrigger:{type:String,default:"submit"},labelPosition:{type:String,default:"left"},labelWidth:{type:[String,Number],default:""},labelAlign:{type:String,default:"left"},border:{type:Boolean,default:!1}},provide(){return{uniForm:this}},data:()=>({formData:{},formRules:{}}),computed:{localData(){const e=this.model||this.modelValue||this.value;return e?(t=e,JSON.parse(JSON.stringify(t))):{};var t}},watch:{rules:{handler:function(e,t){this.setRules(e)},deep:!0,immediate:!0}},created(){getApp().$vm.$.appContext.config.globalProperties.binddata||(getApp().$vm.$.appContext.config.globalProperties.binddata=function(e,a,n){if(n)this.$refs[n].setValue(e,a);else{let n;for(let e in this.$refs){const t=this.$refs[e];if(t&&t.$options&&"uniForms"===t.$options.name){n=t;break}}if(!n)return t("error","at uni_modules/uni-forms/components/uni-forms/uni-forms.vue:182","当前 uni-froms 组件缺少 ref 属性");n.setValue(e,a)}}),this.childrens=[],this.inputChildrens=[],this.setRules(this.rules)},methods:{setRules(e){this.formRules=Object.assign({},this.formRules,e),this.validator=new be(e)},setValue(e,t){let a=this.childrens.find((t=>t.name===e));return a?(this.formData[e]=Te(0,t,this.formRules[e]&&this.formRules[e].rules||[]),a.onFieldChange(this.formData[e])):null},validate(e,t){return this.checkAll(this.formData,e,t)},validateField(e=[],t){e=[].concat(e);let a={};return this.childrens.forEach((t=>{const n=Ce(t.name);-1!==e.indexOf(n)&&(a=Object.assign({},a,{[n]:this.formData[n]}))})),this.checkAll(a,[],t)},clearValidate(e=[]){e=[].concat(e),this.childrens.forEach((t=>{if(0===e.length)t.errMsg="";else{const a=Ce(t.name);-1!==e.indexOf(a)&&(t.errMsg="")}}))},submit(e,a,n){for(let t in this.dataValue){this.childrens.find((e=>e.name===t))&&void 0===this.formData[t]&&(this.formData[t]=this._getValue(t,this.dataValue[t]))}return n||t("warn","at uni_modules/uni-forms/components/uni-forms/uni-forms.vue:289","submit 方法即将废弃，请使用validate方法代替！"),this.checkAll(this.formData,e,a,"submit")},async checkAll(e,t,a,n){if(!this.validator)return;let i,l=[];for(let c in e){const e=this.childrens.find((e=>Ce(e.name)===c));e&&l.push(e)}a||"function"!=typeof t||(a=t),!a&&"function"!=typeof a&&Promise&&(i=new Promise(((e,t)=>{a=function(a,n){a?t(a):e(n)}})));let o=[],s=JSON.parse(JSON.stringify(e));for(let c in l){const e=l[c];let t=Ce(e.name);const a=await e.onFieldChange(s[t]);if(a&&(o.push(a),"toast"===this.errShowType||"modal"===this.errShowType))break}Array.isArray(o)&&0===o.length&&(o=null),Array.isArray(t)&&t.forEach((e=>{let t=Ce(e),a=Se(e,this.localData);void 0!==a&&(s[t]=a)})),"submit"===n?this.$emit("submit",{detail:{value:s,errors:o}}):this.$emit("validate",o);let r={};return r=((e={},t)=>{let a=JSON.parse(JSON.stringify(e)),n={};for(let i in a){let e=De(i);Be(n,e,a[i])}return n})(s,this.name),a&&"function"==typeof a&&a(o,r),i&&a?i:null},validateCheck(e){this.$emit("validate",e)},_getValue:Te,_isRequiredField:e=>{let t=!1;for(let a=0;a<e.length;a++){if(e[a].required){t=!0;break}}return t},_setDataValue:(e,t,a)=>(t[e]=a,a||""),_getDataValue:Se,_realName:Ce,_isRealName:e=>/^_formdata_#*/.test(e),_isEqual:(e,t)=>{if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;var a=toString.call(e);if(a!==toString.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}if("[object Object]"==a){var n=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);if(n.length!=i.length)return!1;for(var l=0;l<n.length;l++){var o=n[l];if(e[o]!==t[o])return!1}return!0}return"[object Array]"==a?e.toString()==t.toString():void 0}}},[["render",function(t,a,n,i,l,o){return e.openBlock(),e.createElementBlock("view",{class:"uni-forms"},[e.createElementVNode("form",null,[e.renderSlot(t.$slots,"default",{},void 0,!0)])])}],["__scopeId","data-v-d0b7151e"]]),Pe=n.baseUrl;const Le={__name:"create",setup(n){const i=e.reactive({title:"",description:"",categoryId:"",requirements:"",rewardTypeId:1,rewardAmount:"",deadline:"",maxParticipants:1,location:"",contactInfo:{qq:"",wechat:"",email:""}}),l=e.ref([]),o=e.ref([]),s=[{title:"基本信息",validate:["title","categoryId","description","requirements"]},{title:"任务设置",validate:["deadline","location","maxParticipants","rewardTypeId","rewardAmount"]},{title:"联系方式",validate:[]},{title:"确认提交",validate:[]}],r=e.ref(0);e.onMounted((async()=>{try{const e=await d({url:`${Pe}/taskCategories`,method:"GET"});200===e.code?l.value=e.data:l.value=[{id:1,name:"问卷调查",iconUrl:"/icons/survey.png"},{id:2,name:"数据收集",iconUrl:"/icons/data.png"},{id:3,name:"实验参与",iconUrl:"/icons/experiment.png"},{id:4,name:"校园活动",iconUrl:"/icons/activity.png"},{id:5,name:"学术研究",iconUrl:"/icons/research.png"},{id:6,name:"志愿服务",iconUrl:"/icons/volunteer.png"},{id:7,name:"实习兼职",iconUrl:"/icons/internship.png"},{id:8,name:"竞赛协助",iconUrl:"/icons/competition.png"},{id:9,name:"技术支持",iconUrl:"/icons/tech.png"},{id:10,name:"其他",iconUrl:"/icons/other.png"}];const t=await d({url:`${Pe}/rewardTypes`,method:"GET"});200===t.code?o.value=t.data:o.value=[{id:1,name:"现金",unit:"元"},{id:2,name:"学分",unit:"分"},{id:3,name:"志愿服务",unit:"小时"},{id:4,name:"实习机会",unit:"天"},{id:5,name:"礼品",unit:"件"},{id:6,name:"证书",unit:"张"}]}catch(e){t("error","at pages/task-square/create.vue:321","获取数据失败",e),l.value=[{id:1,name:"问卷调查",iconUrl:"/icons/survey.png"},{id:2,name:"数据收集",iconUrl:"/icons/data.png"},{id:3,name:"实验参与",iconUrl:"/icons/experiment.png"},{id:4,name:"校园活动",iconUrl:"/icons/activity.png"},{id:5,name:"学术研究",iconUrl:"/icons/research.png"},{id:6,name:"志愿服务",iconUrl:"/icons/volunteer.png"},{id:7,name:"实习兼职",iconUrl:"/icons/internship.png"},{id:8,name:"竞赛协助",iconUrl:"/icons/competition.png"},{id:9,name:"技术支持",iconUrl:"/icons/tech.png"},{id:10,name:"其他",iconUrl:"/icons/other.png"}],o.value=[{id:1,name:"现金",unit:"元"},{id:2,name:"学分",unit:"分"},{id:3,name:"志愿服务",unit:"小时"},{id:4,name:"实习机会",unit:"天"},{id:5,name:"礼品",unit:"件"},{id:6,name:"证书",unit:"张"}],uni.showToast({title:"获取数据失败，使用默认配置",icon:"none"})}}));const c={title:{rules:[{required:!0,errorMessage:"请输入任务标题"}]},categoryId:{rules:[{required:!0,errorMessage:"请选择任务类别"}]},description:{rules:[{required:!0,errorMessage:"请输入任务描述"},{minLength:20,errorMessage:"任务描述至少20个字符"}]},requirements:{rules:[{required:!0,errorMessage:"请输入任务需求"}]},deadline:{rules:[{required:!0,errorMessage:"请选择截止日期"}]},location:{rules:[{required:!0,errorMessage:"请输入任务地点"}]},rewardAmount:{rules:[{required:!0,errorMessage:"请输入报酬金额"}]},maxParticipants:{rules:[{required:!0,errorMessage:"请输入最大参与人数"}]}},u=e.ref(null),m=e.computed((()=>(new Date).toISOString().split("T")[0])),p=e.computed((()=>{const e=new Date;return new Date(e.setFullYear(e.getFullYear()+1)).toISOString().split("T")[0]}));function h(e){i.deadline=e}function g(e){const t=l.value.find((t=>t.id===e));return t?t.name:""}function f(e){const t=o.value.find((t=>t.id===e));return t?t.name:""}function v(e){const t=o.value.find((t=>t.id===e));return t?t.unit:""}function w(e){if(!e)return"";try{const t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")} ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`}catch(t){return e}}async function y(){const e=s[r.value].validate;if(e.length>0)try{await u.value.validateField(e),r.value++}catch(t){uni.showToast({title:"请完成必填项",icon:"none"})}else r.value++}function k(){r.value>0&&r.value--}function E(){u.value.validate().then((e=>{uni.showToast({title:"预览功能开发中",icon:"none"})})).catch((e=>{t("log","at pages/task-square/create.vue:502","表单错误：",e)}))}async function V(){try{await u.value.validate(),t("log","at pages/task-square/create.vue:511","表单数据：",i),uni.showLoading({title:"提交中..."});const a={title:i.title,description:i.description,categoryId:i.categoryId,requirements:i.requirements,rewardTypeId:i.rewardTypeId,rewardAmount:Number(i.rewardAmount),deadline:N(i.deadline),maxParticipants:Number(i.maxParticipants),location:i.location,contactInfo:i.contactInfo};t("log","at pages/task-square/create.vue:532","提交数据：",JSON.stringify(a,null,2));const n=await(e=a,d({url:`${Pe}/tasks`,method:"POST",data:e}));if(uni.hideLoading(),200===n.code)uni.showModal({title:"发布成功",content:"任务已成功发布",showCancel:!1,success:e=>{e.confirm&&uni.navigateBack()}});else{let e=n.message||"发布失败";n.message&&n.message.includes("LocalDateTime")&&(e="日期格式错误，请重新选择截止日期"),uni.showModal({title:"提交失败",content:e,showCancel:!1})}}catch(a){uni.hideLoading(),t("log","at pages/task-square/create.vue:568","表单错误：",a),uni.showToast({title:"表单验证失败，请检查输入",icon:"none"})}var e}function N(e){if(!e)return"";if(e.length<=10)return`${e}T23:59:59`;return new Date(e).toISOString().replace(".000Z","")}function x(){uni.showModal({title:"提示",content:"是否放弃编辑？",success:e=>{e.confirm&&uni.navigateBack()}})}return(t,n)=>{const d=a(e.resolveDynamicComponent("uni-easyinput"),ae),N=a(e.resolveDynamicComponent("uni-forms-item"),ne),b=a(e.resolveDynamicComponent("uni-datetime-picker"),we),T=a(e.resolveDynamicComponent("uni-number-box"),ye),S=a(e.resolveDynamicComponent("uni-forms"),Re);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"navbar"},[e.createElementVNode("view",{class:"back-btn",onClick:x},[e.createElementVNode("text",{class:"iconfont icon-back"})]),e.createElementVNode("view",{class:"title"},"发布任务"),e.createElementVNode("view",{class:"right-btns"},[e.createElementVNode("view",{class:"preview-btn",onClick:E},"预览")])]),e.createElementVNode("view",{class:"steps-indicator"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(s,((t,a)=>e.createElementVNode("view",{key:a,class:e.normalizeClass(["step-item",r.value>=a?"step-active":""]),onClick:e=>function(e){e<r.value&&(r.value=e)}(a)},[e.createElementVNode("view",{class:"step-circle"},e.toDisplayString(a+1),1),e.createElementVNode("text",{class:"step-text"},e.toDisplayString(t.title),1)],10,["onClick"]))),64))])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"form-scroll"},[e.createVNode(S,{ref_key:"taskForm",ref:u,modelValue:i,rules:c,"label-position":"top","label-width":"80px"},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"section-title"},"基本信息"),e.createVNode(N,{name:"title",label:"任务标题"},{default:e.withCtx((()=>[e.createVNode(d,{modelValue:i.title,"onUpdate:modelValue":n[0]||(n[0]=e=>i.title=e),placeholder:"请输入任务标题（15字以内）",maxlength:"15"},null,8,["modelValue"])])),_:1}),e.createVNode(N,{name:"categoryId",label:"任务类别"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"category-tags"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["category-tag",i.categoryId===t.id?"category-tag-active":""]),onClick:e=>{return a=t.id,void(i.categoryId=a);var a}},e.toDisplayString(t.name),11,["onClick"])))),128))])])),_:1}),e.createVNode(N,{name:"description",label:"任务描述"},{default:e.withCtx((()=>[e.createVNode(d,{modelValue:i.description,"onUpdate:modelValue":n[1]||(n[1]=e=>i.description=e),type:"textarea",placeholder:"请详细描述任务内容、要求等信息",maxlength:"500",autoHeight:!0,inputBorder:!0},null,8,["modelValue"]),e.createElementVNode("text",{class:"text-count"},e.toDisplayString(i.description.length)+"/500",1)])),_:1}),e.createVNode(N,{name:"requirements",label:"任务需求"},{default:e.withCtx((()=>[e.createVNode(d,{modelValue:i.requirements,"onUpdate:modelValue":n[2]||(n[2]=e=>i.requirements=e),type:"textarea",placeholder:"请详细描述任务需要的能力、条件等",maxlength:"300",autoHeight:!0,inputBorder:!0},null,8,["modelValue"]),e.createElementVNode("text",{class:"text-count"},e.toDisplayString(i.requirements.length)+"/300",1)])),_:1})],512),[[e.vShow,0===r.value]]),e.withDirectives(e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"section-title"},"任务设置"),e.createVNode(N,{name:"deadline",label:"截止日期"},{default:e.withCtx((()=>[e.createVNode(b,{modelValue:i.deadline,"onUpdate:modelValue":n[3]||(n[3]=e=>i.deadline=e),type:"datetime",start:m.value,end:p.value,format:"yyyy-MM-dd HH:mm",onChange:h},null,8,["modelValue","start","end"])])),_:1}),e.createVNode(N,{name:"location",label:"任务地点"},{default:e.withCtx((()=>[e.createVNode(d,{modelValue:i.location,"onUpdate:modelValue":n[4]||(n[4]=e=>i.location=e),placeholder:"请输入任务地点"},null,8,["modelValue"])])),_:1}),e.createVNode(N,{name:"maxParticipants",label:"参与人数",class:"nowrap-label"},{default:e.withCtx((()=>[e.createVNode(T,{modelValue:i.maxParticipants,"onUpdate:modelValue":n[5]||(n[5]=e=>i.maxParticipants=e),min:1,max:100},null,8,["modelValue"])])),_:1}),e.createVNode(N,{name:"rewardTypeId",label:"报酬类型"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"reward-types"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["reward-type-tag",i.rewardTypeId===t.id?"reward-type-active":""]),onClick:e=>{return a=t.id,void(i.rewardTypeId=a);var a}},e.toDisplayString(t.name),11,["onClick"])))),128))])])),_:1}),e.createVNode(N,{name:"rewardAmount",label:"报酬金额"},{default:e.withCtx((()=>{var t;return[e.createElementVNode("view",{class:"money-input-container"},[e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":n[6]||(n[6]=e=>i.rewardAmount=e),placeholder:"请输入数量",maxlength:"10",class:"money-field"},null,512),[[e.vModelText,i.rewardAmount]]),e.createElementVNode("text",{class:"money-unit"},e.toDisplayString((null==(t=o.value.find((e=>e.id===i.rewardTypeId)))?void 0:t.unit)||"元"),1)])]})),_:1})],512),[[e.vShow,1===r.value]]),e.withDirectives(e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"section-title"},"联系方式"),e.createVNode(N,{name:"contactInfo.qq",label:"联系QQ"},{default:e.withCtx((()=>[e.createVNode(d,{modelValue:i.contactInfo.qq,"onUpdate:modelValue":n[7]||(n[7]=e=>i.contactInfo.qq=e),placeholder:"请输入联系QQ(选填)"},null,8,["modelValue"])])),_:1}),e.createVNode(N,{name:"contactInfo.wechat",label:"联系微信"},{default:e.withCtx((()=>[e.createVNode(d,{modelValue:i.contactInfo.wechat,"onUpdate:modelValue":n[8]||(n[8]=e=>i.contactInfo.wechat=e),placeholder:"请输入微信号(选填)"},null,8,["modelValue"])])),_:1}),e.createVNode(N,{name:"contactInfo.email",label:"联系邮箱"},{default:e.withCtx((()=>[e.createVNode(d,{modelValue:i.contactInfo.email,"onUpdate:modelValue":n[9]||(n[9]=e=>i.contactInfo.email=e),placeholder:"请输入电子邮箱(选填)"},null,8,["modelValue"])])),_:1})],512),[[e.vShow,2===r.value]]),e.withDirectives(e.createElementVNode("view",{class:"form-section review-section"},[e.createElementVNode("view",{class:"section-title"},"确认信息"),e.createElementVNode("view",{class:"review-item"},[e.createElementVNode("text",{class:"review-label"},"任务标题："),e.createElementVNode("text",{class:"review-value"},e.toDisplayString(i.title),1)]),e.createElementVNode("view",{class:"review-item"},[e.createElementVNode("text",{class:"review-label"},"任务类别："),e.createElementVNode("text",{class:"review-value"},e.toDisplayString(g(i.categoryId)),1)]),e.createElementVNode("view",{class:"review-item"},[e.createElementVNode("text",{class:"review-label"},"截止日期："),e.createElementVNode("text",{class:"review-value"},e.toDisplayString(w(i.deadline)),1)]),e.createElementVNode("view",{class:"review-item"},[e.createElementVNode("text",{class:"review-label"},"任务地点："),e.createElementVNode("text",{class:"review-value"},e.toDisplayString(i.location),1)]),e.createElementVNode("view",{class:"review-item"},[e.createElementVNode("text",{class:"review-label"},"最大参与人数："),e.createElementVNode("text",{class:"review-value"},e.toDisplayString(i.maxParticipants)+" 人",1)]),e.createElementVNode("view",{class:"review-item"},[e.createElementVNode("text",{class:"review-label"},"报酬类型："),e.createElementVNode("text",{class:"review-value"},e.toDisplayString(f(i.rewardTypeId)),1)]),e.createElementVNode("view",{class:"review-item"},[e.createElementVNode("text",{class:"review-label"},"报酬金额："),e.createElementVNode("text",{class:"review-value"},e.toDisplayString(i.rewardAmount)+" "+e.toDisplayString(v(i.rewardTypeId)),1)]),e.createElementVNode("view",{class:"review-info"},[e.createElementVNode("text",null,'请确认以上信息无误，点击"提交"按钮发布任务')])],512),[[e.vShow,3===r.value]])])),_:1},8,["modelValue"])]),e.createElementVNode("view",{class:"step-actions"},[r.value>0?(e.openBlock(),e.createElementBlock("button",{key:0,class:"prev-btn",onClick:k},"上一步")):e.createCommentVNode("",!0),r.value<s.length-1?(e.openBlock(),e.createElementBlock("button",{key:1,class:"next-btn",onClick:y},"下一步")):e.createCommentVNode("",!0),r.value===s.length-1?(e.openBlock(),e.createElementBlock("button",{key:2,class:"submit-btn",onClick:V},"提交")):e.createCommentVNode("",!0)])])}}};const $e=C({data:()=>({defaultAvatar:"/static/images/default-avatar.png",teamId:null,teamInfo:{},teamMembers:[],showPhone:!1,isLoading:!0,userInfo:null,hasApplied:!1,isTeamMember:!1,isTeamLeader:!1,applyLoading:!1}),computed:{hasAvailableRoles(){return!!this.teamInfo.roles&&this.teamInfo.roles.some((e=>e.currentCount<e.requiredCount))}},onLoad(e){t("log","at pages/team/detail.vue:193","队伍详情页面参数:",e),e&&e.id?(this.teamId=e.id,this.getUserInfo(),this.getTeamDetail()):(uni.showToast({title:"队伍ID不能为空",icon:"none"}),setTimeout((()=>{uni.navigateBack()}),1500))},onShow(){this.getUserInfo(),this.teamId&&this.checkTeamStatus()},methods:{getUserInfo(){const e=uni.getStorageSync("userInfo");e&&(this.userInfo="string"==typeof e?JSON.parse(e):e)},async checkTeamStatus(){if(this.userInfo&&this.userInfo.userId)try{const e=await m.checkTeamStatus(this.teamId);200===e.code&&(this.hasApplied=!0===e.data)}catch(e){t("error","at pages/team/detail.vue:236","检查团队状态失败",e)}},getStatusClass(e){switch(e){case"0":default:return"status-recruiting";case"1":return"status-filled";case"2":return"status-disbanded"}},getStatusIcon(e){switch(e){case"0":default:return"icon-check-circle";case"1":return"icon-hourglass";case"2":return"icon-times-circle"}},hidePhone:e=>e?e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):"",togglePhone(){this.showPhone=!this.showPhone},copyText(e){uni.setClipboardData({data:e,success:()=>{uni.showToast({title:"复制成功",icon:"success"})}})},goBack(){uni.navigateBack()},goToCompetition(e){e&&uni.navigateTo({url:`/pages/competition/detail?id=${e}`})},async applyRole(e){this.hasApplied?uni.showToast({title:"您已申请或已加入该团队",icon:"none"}):uni.showModal({title:"申请加入理由",content:"",editable:!0,placeholderText:"我希望加入团队参与...",success:async a=>{if(a.confirm){const i=a.content||"希望能加入团队，与大家一起学习成长。";this.applyLoading=!0;try{const t={teamId:this.teamId,roleId:e,message:i},a=await m.applyTeam(t);200===a.code?(uni.showToast({title:"申请已提交",icon:"success"}),this.hasApplied=!0,setTimeout((()=>{uni.showModal({title:"申请已提交",content:"您可以在申请管理中查看申请状态",confirmText:"查看申请",cancelText:"稍后再看",success:e=>{e.confirm&&uni.navigateTo({url:"/pages/team/applications"})}})}),1500)):uni.showToast({title:a.message||"申请提交失败",icon:"none"})}catch(n){t("error","at pages/team/detail.vue:350","申请失败",n),uni.showToast({title:"网络异常，请稍后重试",icon:"none"})}finally{this.applyLoading=!1}}}})},showApplyOptions(){if(this.userInfo&&this.userInfo.userId)if(this.hasApplied)uni.showToast({title:"您已申请或已加入该团队",icon:"none"});else if(this.teamInfo.roles&&this.teamInfo.roles.length>0){const e=this.teamInfo.roles.filter((e=>e.currentCount<e.requiredCount));if(e.length>1){const t=e.map((e=>`${e.name}（${e.currentCount}/${e.requiredCount}）`));uni.showActionSheet({itemList:t,success:t=>{this.applyRole(e[t.tapIndex].id)}})}else 1===e.length?this.applyRole(e[0].id):uni.showToast({title:"当前没有可申请的角色",icon:"none"})}else uni.showToast({title:"当前没有可申请的角色",icon:"none"});else uni.showModal({title:"提示",content:"请先登录后再申请加入团队",confirmText:"去登录",success:e=>{e.confirm&&uni.navigateTo({url:"/pages/login/login"})}})},editTeam(){uni.navigateTo({url:`/pages/team/edit?id=${this.teamId}`})},async disbandTeam(){uni.showModal({title:"解散队伍",content:"确定要解散该队伍吗？此操作不可撤销",confirmColor:"#f56c6c",success:async e=>{if(e.confirm)try{const e=await m.disbandTeam(this.teamId);200===e.code?(uni.showToast({title:"队伍已解散",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)):uni.showToast({title:e.message||"解散队伍失败",icon:"none"})}catch(a){t("error","at pages/team/detail.vue:449","解散队伍失败",a),uni.showToast({title:"网络异常，请稍后重试",icon:"none"})}}})},async leaveTeam(){uni.showModal({title:"退出队伍",content:"确定要退出该队伍吗？",confirmColor:"#f56c6c",success:async e=>{if(e.confirm)try{const e=await m.leaveTeam(this.teamId);200===e.code?(uni.showToast({title:"已退出队伍",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)):uni.showToast({title:e.message||"退出失败",icon:"none"})}catch(a){t("error","at pages/team/detail.vue:484","退出队伍失败",a),uni.showToast({title:"网络异常，请稍后重试",icon:"none"})}}})},async getTeamMembers(){try{const e=await m.getTeamMembers(this.teamId);if(e&&200===e.code&&e.data){if(this.teamMembers=e.data,this.userInfo&&this.userInfo.userId){const e=this.userInfo.userId,t=this.teamMembers.some((t=>t.userId===e)),a=t&&this.teamMembers.some((t=>t.userId===e&&t.isLeader));this.isTeamMember=t,this.isTeamLeader=a}t("log","at pages/team/detail.vue:512","获取到队伍成员:",this.teamMembers)}else t("log","at pages/team/detail.vue:514","获取队伍成员失败:",null==e?void 0:e.message)}catch(e){t("error","at pages/team/detail.vue:517","获取队伍成员出错",e)}},async getTeamDetail(){this.isLoading=!0;try{const e=await m.getTeamDetail(this.teamId);e&&200===e.code&&e.data?(this.teamInfo=e.data,t("log","at pages/team/detail.vue:528","获取到队伍详情:",this.teamInfo),this.userInfo&&this.userInfo.userId&&this.teamInfo.leaderId===this.userInfo.userId&&(this.isTeamLeader=!0,this.isTeamMember=!0),this.getTeamMembers(),this.checkTeamStatus()):(uni.showToast({title:(null==e?void 0:e.message)||"获取队伍详情失败",icon:"none"}),t("log","at pages/team/detail.vue:546","获取队伍详情失败:",e))}catch(e){t("error","at pages/team/detail.vue:549","获取队伍详情出错",e),uni.showToast({title:"网络异常，请稍后重试",icon:"none"})}finally{this.isLoading=!1}}}},[["render",function(t,a,n,i,l,o){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"top-bar"},[e.createElementVNode("view",{class:"flex-between px-4 py-3"},[e.createElementVNode("view",{class:"back-btn",onClick:a[0]||(a[0]=(...e)=>o.goBack&&o.goBack(...e))},[e.createElementVNode("text",{class:"iconfont icon-arrow-left"})]),e.createElementVNode("text",{class:"page-title"},e.toDisplayString(l.teamInfo.name||"队伍详情"),1),e.createElementVNode("view",{class:"header-actions"},[e.createElementVNode("text",{class:"iconfont icon-star mr-3"}),e.createElementVNode("text",{class:"iconfont icon-share"})])])]),e.createElementVNode("view",{class:"info-card"},[e.createElementVNode("view",{class:"flex-between mb-3"},[e.createElementVNode("view",{class:"competition-link",onClick:a[1]||(a[1]=e=>o.goToCompetition(l.teamInfo.competitionId))},[e.createElementVNode("text",{class:"iconfont icon-trophy mr-1 blue-text"}),e.createElementVNode("view",{class:"blue-text"},"关联竞赛："+e.toDisplayString(l.teamInfo.competitionName),1)])]),e.createElementVNode("view",{class:"leader-info"},[e.createElementVNode("image",{class:"leader-avatar",src:l.teamInfo.leaderAvatarUrl||l.defaultAvatar},null,8,["src"]),e.createElementVNode("view",{class:"leader-detail"},[e.createElementVNode("text",{class:"leader-name"},"队长："+e.toDisplayString(l.teamInfo.leaderName),1),e.createElementVNode("text",{class:"leader-major"},e.toDisplayString(l.teamInfo.leaderMajor||"未设置专业"),1)]),e.createElementVNode("view",{class:e.normalizeClass(["status-tag",o.getStatusClass(l.teamInfo.status)])},[e.createElementVNode("text",null,e.toDisplayString(l.teamInfo.statusText),1)],2)]),l.teamInfo.direction?(e.openBlock(),e.createElementBlock("view",{key:0,class:"research-direction"},[e.createElementVNode("text",{class:"section-title"},"队伍方向"),e.createElementVNode("text",{class:"desc-text"},e.toDisplayString(l.teamInfo.direction),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"team-desc-section"},[e.createElementVNode("text",{class:"section-title"},"队伍描述"),e.createElementVNode("text",{class:"desc-text"},e.toDisplayString(l.teamInfo.description),1)]),e.createElementVNode("view",{class:"team-meta"},[e.createElementVNode("text",{class:"meta-item"},"组队截止："+e.toDisplayString(l.teamInfo.recruitmentDeadlineFormatted),1),e.createElementVNode("view",{class:"view-count"},[e.createElementVNode("text",{class:"iconfont icon-eye"}),e.createElementVNode("text",null,"浏览次数："+e.toDisplayString(l.teamInfo.viewCount),1)])])]),e.createElementVNode("view",{class:"section-card"},[e.createElementVNode("text",{class:"section-header"},"招募角色"),e.createElementVNode("view",{class:"role-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.teamInfo.roles,(t=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["role-card",{"role-filled":t.currentCount>=t.requiredCount}]),key:t.id},[e.createElementVNode("view",{class:"flex-between mb-2"},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"role-title"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"role-count"},"需求："+e.toDisplayString(t.requiredCount)+"人 / 已招募："+e.toDisplayString(t.currentCount)+"人",1)]),e.createElementVNode("view",{class:e.normalizeClass(["role-status-tag",t.currentCount>=t.requiredCount?"filled-tag":"recruiting-tag"])},e.toDisplayString(t.currentCount>=t.requiredCount?"已满员":"招募中"),3)]),e.createElementVNode("text",{class:"role-desc"},e.toDisplayString(t.description),1),e.createElementVNode("view",{class:"skill-section"},[e.createElementVNode("text",{class:"skill-header"},"技能要求:"),e.createElementVNode("view",{class:"skill-tags"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.skillRequirements,((t,a)=>(e.openBlock(),e.createElementBlock("text",{class:"skill-tag",key:a},e.toDisplayString(t),1)))),128))])]),e.createElementVNode("button",{class:e.normalizeClass(["apply-btn",t.currentCount>=t.requiredCount?"disabled-btn":"active-btn"]),disabled:t.currentCount>=t.requiredCount,onClick:e=>o.applyRole(t.id)},[t.currentCount<t.requiredCount?(e.openBlock(),e.createElementBlock("text",{key:0,class:"iconfont icon-paper-plane"})):e.createCommentVNode("",!0),e.createTextVNode(" 申请加入 ")],10,["disabled","onClick"])],2)))),128))])]),l.teamMembers.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-card"},[e.createElementVNode("text",{class:"section-header"},"队伍成员 ("+e.toDisplayString(l.teamMembers.length)+")",1),e.createElementVNode("view",{class:"member-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.teamMembers,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"member-item",key:a},[e.createElementVNode("image",{class:e.normalizeClass(["member-avatar",{"leader-border2":t.isLeader}]),src:t.userAvatarUrl||l.defaultAvatar},null,10,["src"]),e.createElementVNode("text",{class:"member-name"},[e.createTextVNode(e.toDisplayString(t.userName)+" ",1),t.roleName?(e.openBlock(),e.createElementBlock("view",{key:0,class:"member-role"},"("+e.toDisplayString(t.roleName)+")",1)):e.createCommentVNode("",!0),t.isLeader?(e.openBlock(),e.createElementBlock("view",{key:1,class:"leader-label"},"(队长)")):e.createCommentVNode("",!0)]),t.userMajor?(e.openBlock(),e.createElementBlock("text",{key:0,class:"member-major"},e.toDisplayString(t.userMajor),1)):e.createCommentVNode("",!0)])))),128))])])):e.createCommentVNode("",!0),l.teamInfo.teachers&&l.teamInfo.teachers.length>0?(e.openBlock(),e.createElementBlock("view",{key:1,class:"info-card"},[e.createElementVNode("text",{class:"section-header"},"指导老师"),e.createElementVNode("view",{class:"member-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.teamInfo.teachers,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"member-item",key:a},[e.createElementVNode("image",{class:"member-avatar",src:t.avatarUrl||l.defaultAvatar},null,8,["src"]),e.createElementVNode("text",{class:"member-name"},e.toDisplayString(t.name),1),t.major?(e.openBlock(),e.createElementBlock("text",{key:0,class:"teacher-major"},e.toDisplayString(t.major),1)):e.createCommentVNode("",!0)])))),128))])])):e.createCommentVNode("",!0),l.teamInfo.contactInfo?(e.openBlock(),e.createElementBlock("view",{key:2,class:"info-card"},[e.createElementVNode("text",{class:"section-header"},"联系方式"),e.createElementVNode("view",{class:"contact-list"},[l.teamInfo.contactInfo.wechat?(e.openBlock(),e.createElementBlock("view",{key:0,class:"contact-item"},[e.createElementVNode("text",{class:"iconfont icon-weixin contact-icon wechat-color"}),e.createElementVNode("text",{class:"contact-text"},"微信："+e.toDisplayString(l.teamInfo.contactInfo.wechat),1),e.createElementVNode("text",{class:"copy-btn",onClick:a[2]||(a[2]=e=>o.copyText(l.teamInfo.contactInfo.wechat))},"复制")])):e.createCommentVNode("",!0),l.teamInfo.contactInfo.phone?(e.openBlock(),e.createElementBlock("view",{key:1,class:"contact-item"},[e.createElementVNode("text",{class:"iconfont icon-phone contact-icon phone-color"}),e.createElementVNode("text",{class:"contact-text"},"电话："+e.toDisplayString(l.showPhone?l.teamInfo.contactInfo.phone:o.hidePhone(l.teamInfo.contactInfo.phone)),1),e.createElementVNode("text",{class:"copy-btn",onClick:a[3]||(a[3]=(...e)=>o.togglePhone&&o.togglePhone(...e))},e.toDisplayString(l.showPhone?"隐藏":"查看"),1)])):e.createCommentVNode("",!0),l.teamInfo.contactInfo.qq?(e.openBlock(),e.createElementBlock("view",{key:2,class:"contact-item"},[e.createElementVNode("text",{class:"iconfont icon-qq contact-icon qq-color"}),e.createElementVNode("text",{class:"contact-text"},"QQ群："+e.toDisplayString(l.teamInfo.contactInfo.qq),1),e.createElementVNode("text",{class:"copy-btn",onClick:a[4]||(a[4]=e=>o.copyText(l.teamInfo.contactInfo.qq))},"复制")])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)])}]]),Fe={__name:"list",setup(a){const n=e.ref(["全部队伍","学科竞赛","创新创业","体育竞赛","文艺比赛"]),i=e.ref(0),l=e.ref(null),o=e.computed((()=>l.value&&l.value.headerHeight?l.value.headerHeight+"rpx":n.value&&n.value.length>0?"200rpx":"120rpx")),s=e.reactive({pageNum:1,pageSize:10,total:0,pages:0,list:[],hasPrevious:!1,hasNext:!1}),r=e.ref(!1),c=e.ref(!1),d=e.ref(!1),u=e.ref(!1),p=e.reactive({pageNum:1,pageSize:10,keyword:"",orderByViewCount:!1});async function h(e=!1){e?(p.pageNum=1,c.value=!0):r.value=!0;try{const a={};Object.keys(p).forEach((e=>{null!==p[e]&&void 0!==p[e]&&""!==p[e]&&(a[e]=p[e])})),t("log","at pages/team/list.vue:136","请求参数:",a);const n=await m.getTeamList(a);t("log","at pages/team/list.vue:138","响应结果:",n),200===n.code&&n.data?(s.list=e?n.data.list||[]:[...s.list,...n.data.list||[]],s.pageNum=n.data.pageNum,s.pageSize=n.data.pageSize,s.total=n.data.total,s.pages=n.data.pages,s.hasPrevious=n.data.hasPrevious,s.hasNext=n.data.hasNext,u.value=!n.data.hasNext):uni.showToast({title:(null==n?void 0:n.message)||"获取团队列表失败",icon:"none"})}catch(a){t("error","at pages/team/list.vue:163","获取团队列表出错",a),401===a.statusCode||403===a.statusCode?uni.showModal({title:"登录已过期",content:"请重新登录后查看",confirmText:"去登录",success:function(e){e.confirm&&(uni.removeStorageSync("token"),uni.navigateTo({url:"/pages/login/login"}))}}):uni.showToast({title:"网络异常，请稍后重试",icon:"none"})}finally{r.value=!1,c.value=!1,d.value=!1}}function g(){d.value||u.value||(s.hasNext?(d.value=!0,p.pageNum+=1,h()):u.value=!0)}function f(e){i.value!==e&&(i.value=e,0===e?delete p.categoryId:p.categoryId=e,h(!0))}function v(e){uni.navigateTo({url:`/pages/team/detail?id=${e}`})}function w(e){uni.getStorageSync("token")?m.checkTeamStatus(e).then((t=>{200===t.code&&(!0===t.data?uni.showToast({title:"您已申请或已加入该团队",icon:"none"}):uni.navigateTo({url:`/pages/team/detail?id=${e}`}))})).catch((a=>{t("error","at pages/team/list.vue:304","检查团队状态失败",a),uni.navigateTo({url:`/pages/team/detail?id=${e}`})})):uni.showModal({title:"提示",content:"请先登录后再申请加入团队",confirmText:"去登录",success:function(e){e.confirm&&uni.navigateTo({url:"/pages/login/login"})}})}function y(e){"home"===e?uni.switchTab({url:"/pages/index/index"}):"competition"===e?uni.switchTab({url:"/pages/competition/index"}):"profile"===e&&uni.switchTab({url:"/pages/profile/index"})}function k(){uni.showActionSheet({itemList:["创建新团队","招募队友","发布项目展示"],success:function(e){0===e.tapIndex?uni.navigateTo({url:"/pages/team/create"}):uni.showToast({title:`选择了: ${e.tapIndex}`,icon:"none"})}})}function E(){uni.navigateTo({url:"/pages/search/index"})}function V(){uni.showActionSheet({itemList:["最新发布","热门团队","即将截止"],success:function(e){uni.showToast({title:`选择了筛选: ${e.tapIndex}`,icon:"none"})}})}return e.onMounted((()=>{t("log","at pages/team/list.vue:237","组队列表页面加载");uni.getStorageSync("token")?h():uni.showModal({title:"提示",content:"请先登录后查看团队列表",confirmText:"去登录",success:function(e){e.confirm&&uni.navigateTo({url:"/pages/login/login"})}})})),(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(I,{ref_key:"headerBarRef",ref:l,title:"组队广场",categories:n.value,"default-category":i.value,"show-filter":"true",onSearch:E,onFilter:V,onCategoryChange:f},null,8,["categories","default-category"]),e.createElementVNode("view",{class:"header-placeholder",style:e.normalizeStyle({height:o.value})},null,4),e.createElementVNode("scroll-view",{"scroll-y":"true",class:"team-list",onScrolltolower:g},[s.list&&s.list.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(s.list,((t,a)=>(e.openBlock(),e.createBlock(_,{key:t.id,team:t,index:a,onDetail:v,onApply:w},null,8,["team","index"])))),128)):r.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-state"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"加载中...")])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"empty-state"},[e.createElementVNode("text",{class:"empty-text"},"暂无团队数据")])),s.list&&s.list.length>0?(e.openBlock(),e.createElementBlock("view",{key:3,class:"load-more"},[d.value?(e.openBlock(),e.createElementBlock("text",{key:0},"正在加载更多...")):s.hasNext?(e.openBlock(),e.createElementBlock("text",{key:1,onClick:g},"点击加载更多")):(e.openBlock(),e.createElementBlock("text",{key:2},"— 没有更多数据了 —"))])):e.createCommentVNode("",!0)],32),e.createVNode(M,{"active-tab":"team",onTabChange:y,onPublish:k})]))}},ze={__name:"create",setup(i){const l=e.ref(null),o=e.ref(null),s=e.ref(null),r=n.baseUrl,c=e.reactive({competitionId:"",teamName:"",researchDirection:"",description:"",recruitDeadline:"",email:"",wechat:"",qq:"",teachers:[],roles:[]}),d=e.ref([]),u=e.ref([]),h=e.ref([]),g=e.ref(0),f=e.ref([]),v=e.ref([]),w=e.ref([]),y=e.ref(0),k=e.ref(null),E=e.ref({}),V=e.ref([]),N=e.ref("全部"),x=e.ref(null),b=e.ref(""),T=e.ref([]);e.reactive({});const S=e.ref(""),C=e.computed((()=>{const e=d.value.find((e=>e.id===c.competitionId));return e?e.title:""}));function D(e){y.value=e,S.value="",v.value=0===e?[...f.value]:f.value.filter((t=>t.major===e))}function _(){uni.navigateBack()}function M(){l.value.open()}function I(){l.value.close()}function A(){I()}function R(){o.value.close(),S.value="",D(y.value)}function P(){R()}function L(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${$(t.getMonth()+1)}-${$(t.getDate())} ${$(t.getHours())}:${$(t.getMinutes())}`}function $(e){return e<10?`0${e}`:e}function F(){c.teachers.push({id:"",name:"",role:""})}function z(){c.roles.push({name:"",count:1,description:"",skills:[]})}function U(e){uni.showToast({title:e,icon:"none"})}async function j(){if(function(){if(!c.competitionId)return U("请选择关联竞赛"),!1;if(!c.teamName)return U("请输入团队名称"),!1;if(!c.researchDirection)return U("请输入研究方向"),!1;if(!c.description)return U("请输入团队描述"),!1;if(!c.recruitDeadline)return U("请选择招募截止日期"),!1;if(!c.email)return U("请输入电子邮箱"),!1;for(let e=0;e<c.teachers.length;e++)if(!c.teachers[e].id)return U(`请完善指导老师${e+1}的信息`),!1;return 0!==c.roles.length||(U("请至少添加一个招募角色"),!1)}()){uni.showLoading({title:"提交中..."});try{const e={competitionId:c.competitionId,name:c.teamName,description:c.description,direction:c.researchDirection,recruitmentDeadline:new Date(c.recruitDeadline).toISOString(),contactInfo:{phone:c.phone||"",email:c.email||"",wechat:c.wechat||"",qq:c.qq||""},teacherIds:c.teachers.map((e=>e.id)),teacherRoles:c.teachers.map((e=>e.role)),roles:c.roles.map((e=>({name:e.name,requiredCount:parseInt(e.count)||1,description:e.description,skillRequirements:e.skills||[]})))};t("log","at pages/team/create.vue:846","提交数据:",e);const a=await m.createTeam(e);t("log","at pages/team/create.vue:850",a),uni.hideLoading(),200===a.code?(uni.showToast({title:"创建成功",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)):U(a.message||"创建失败")}catch(e){t("error","at pages/team/create.vue:866","创建团队失败:",e),uni.hideLoading(),U("创建失败，请稍后重试")}}}function q(e){switch(e){case 1:return"category-programming";case 2:return"category-math";case 3:return"category-electronics";case 4:return"category-robotics";case 5:return"category-innovation";default:return""}}function H(e){return(null===k.value||c.teachers[k.value].id!==e)&&c.teachers.some((t=>t.id===e&&""!==t.id))}function O(){if(!S.value.trim())return void D(y.value);const e=S.value.toLowerCase().trim();let t=0===y.value?f.value:f.value.filter((e=>e.major===y.value));v.value=t.filter((t=>t.name.toLowerCase().includes(e)))}function G(){S.value="",D(y.value)}function W(){s.value.close(),b.value="",Y(N.value)}function Y(e){if(N.value=e,b.value="",t("log","at pages/team/create.vue:999","筛选分类:",e),t("log","at pages/team/create.vue:1000","所有技能标签数据:",E.value),"全部"===e){const e=[];Object.entries(E.value).forEach((([t,a])=>{a.forEach((a=>{e.push({...a,category:t})}))})),T.value=e}else{const t=E.value[e]||[];T.value=t.map((t=>({...t,category:e})))}t("log","at pages/team/create.vue:1023","筛选后的技能标签:",T.value)}function J(){W()}function Q(e){return c.roles[x.value].skills.includes(e)}function Z(e){if(c.roles[x.value].skills.includes(e))return!1;for(let t=0;t<c.roles.length;t++)if(t!==x.value&&c.roles[t].skills.includes(e))return!0;return!1}function X(){if(t("log","at pages/team/create.vue:1067","搜索技能:",b.value),!b.value.trim())return void Y(N.value);const e=b.value.toLowerCase().trim();let a=[];if("全部"===N.value)Object.entries(E.value).forEach((([e,t])=>{t.forEach((t=>{a.push({...t,category:e})}))}));else{const e=E.value[N.value]||[];a=e.map((e=>({...e,category:N.value})))}T.value=a.filter((t=>t.tagName.toLowerCase().includes(e)||t.description&&t.description.toLowerCase().includes(e))),t("log","at pages/team/create.vue:1105","搜索结果:",T.value)}function K(){b.value="",Y(N.value)}function ee(){if(null===x.value)return 0;const e=c.roles[x.value];return e.skills?e.skills.length:0}return e.onMounted((()=>{!async function(){try{uni.showLoading({title:"加载中..."});const e=await p.getCompetitionsBasicInfo();if(e&&200===e.code&&e.data){d.value=e.data,u.value=[...e.data];const t=new Map;t.set(0,{id:0,name:"全部分类"}),e.data.forEach((e=>{t.has(e.categoryId)||t.set(e.categoryId,{id:e.categoryId,name:e.categoryName})})),h.value=Array.from(t.values())}else U("获取竞赛列表失败")}catch(e){t("error","at pages/team/create.vue:558","获取竞赛列表失败:",e),U("获取竞赛列表失败")}finally{uni.hideLoading()}}(),async function(){try{uni.showLoading({title:"加载中..."});const e=await uni.request({url:`${r}/api/teachers/list`,method:"GET"});if(e&&200===e.statusCode&&e.data&&200===e.data.code){f.value=e.data.data,v.value=[...e.data.data];const t=new Map;t.set(0,{id:0,name:"全部专业"}),e.data.data.forEach((e=>{e.major&&!t.has(e.major)&&t.set(e.major,{id:e.major,name:e.major})})),w.value=Array.from(t.values())}else U("获取教师列表失败")}catch(e){t("error","at pages/team/create.vue:600","获取教师列表失败:",e),U("获取教师列表失败")}finally{uni.hideLoading()}}(),async function(){try{uni.showLoading({title:"加载中..."});const e=await uni.request({url:`${r}/api/skill-tags/group-by-category`,method:"GET"});if(e&&200===e.statusCode&&e.data&&200===e.data.code){E.value=e.data.data;const a=["全部",...Object.keys(e.data.data)];V.value=a;const n=[];Object.entries(e.data.data).forEach((([e,t])=>{t.forEach((t=>{n.push({...t,category:e})}))})),T.value=n,t("log","at pages/team/create.vue:981","所有技能标签:",n),t("log","at pages/team/create.vue:982","分类:",a)}else U("获取技能标签失败")}catch(e){t("error","at pages/team/create.vue:987","获取技能标签失败:",e),U("获取技能标签失败")}finally{uni.hideLoading()}}()})),(t,n)=>{const i=a(e.resolveDynamicComponent("uni-popup"),B),r=a(e.resolveDynamicComponent("uni-datetime-picker"),we);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"sticky-header"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-btn",onClick:_},[e.createElementVNode("text",{class:"iconfont icon-arrow-left"})]),e.createElementVNode("text",{class:"page-title"},"创建团队"),e.createElementVNode("view",{class:"help-btn"},[e.createElementVNode("text",{class:"iconfont icon-help"})])])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"form-content"},[e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"iconfont icon-trophy section-icon"}),e.createElementVNode("text",{class:"section-title"},"基本信息")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("关联竞赛"),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"select-box",onClick:M},[c.competitionId?(e.openBlock(),e.createElementBlock("text",{key:0,class:"select-text"},e.toDisplayString(C.value),1)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"placeholder-text"},"请选择竞赛")),e.createElementVNode("text",{class:"iconfont icon-arrow-left select-arrow"})])]),e.createVNode(i,{ref_key:"competitionPopup",ref:l,type:"bottom"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"popup-container"},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"选择竞赛"),e.createElementVNode("text",{class:"popup-close",onClick:I},"关闭")]),e.createElementVNode("scroll-view",{"scroll-x":"true",class:"category-scroll"},[e.createElementVNode("view",{class:"category-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["category-tag",{"active-category":g.value===t.id}]),onClick:e=>{return a=t.id,g.value=a,void(u.value=0===a?[...d.value]:d.value.filter((e=>e.categoryId===a)));var a}},[e.createElementVNode("text",null,e.toDisplayString(t.name),1)],10,["onClick"])))),128))])]),e.createElementVNode("scroll-view",{"scroll-y":"true",class:"competitions-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["competition-item",{"active-competition":c.competitionId===t.id}]),onClick:e=>function(e){c.competitionId=e.id}(t)},[e.createElementVNode("view",{class:"competition-info"},[e.createElementVNode("text",{class:"competition-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:e.normalizeClass(["competition-category",q(t.categoryId)])},e.toDisplayString(t.categoryName),3)]),1===t.isHot?(e.openBlock(),e.createElementBlock("text",{key:0,class:"hot-tag"},"热门")):e.createCommentVNode("",!0),c.competitionId===t.id?(e.openBlock(),e.createElementBlock("text",{key:1,class:"iconfont icon-check"})):e.createCommentVNode("",!0)],10,["onClick"])))),128)),0===u.value.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-tip"},[e.createElementVNode("text",null,"该分类下暂无竞赛")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"popup-footer"},[e.createElementVNode("button",{class:"confirm-btn",onClick:A},"确定")])])])),_:1},512),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("团队名称"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=e=>c.teamName=e),placeholder:"请输入团队名称",class:"form-input"},null,512),[[e.vModelText,c.teamName]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("研究方向"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=e=>c.researchDirection=e),placeholder:"请输入研究方向",class:"form-input"},null,512),[[e.vModelText,c.researchDirection]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("团队描述"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":n[2]||(n[2]=e=>c.description=e),placeholder:"请简要描述团队情况和目标",class:"form-textarea"},null,512),[[e.vModelText,c.description]])])]),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"iconfont icon-calendar section-icon"}),e.createElementVNode("text",{class:"section-title"},"招募信息")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("招募截止日期"),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"date-picker-box"},[e.createVNode(r,{type:"datetime",modelValue:c.recruitDeadline,"onUpdate:modelValue":n[3]||(n[3]=e=>c.recruitDeadline=e),"clear-icon":!1,"return-type":"timestamp"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"picker-view"},[c.recruitDeadline?(e.openBlock(),e.createElementBlock("text",{key:0,class:"select-text"},e.toDisplayString(L(c.recruitDeadline)),1)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"placeholder-text"},"请选择截止日期")),e.createElementVNode("text",{class:"iconfont icon-calendar picker-icon"})])])),_:1},8,["modelValue"])])])]),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"iconfont icon-phone section-icon"}),e.createElementVNode("text",{class:"section-title"},"联系方式")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("电子邮箱"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[4]||(n[4]=e=>c.email=e),placeholder:"请输入电子邮箱",class:"form-input"},null,512),[[e.vModelText,c.email]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"微信"),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[5]||(n[5]=e=>c.wechat=e),placeholder:"请输入微信号",class:"form-input"},null,512),[[e.vModelText,c.wechat]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"QQ"),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[6]||(n[6]=e=>c.qq=e),placeholder:"请输入QQ号",class:"form-input"},null,512),[[e.vModelText,c.qq]])])]),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"iconfont icon-graduation section-icon"}),e.createElementVNode("text",{class:"section-title"},"指导老师")]),c.teachers.length>0?(e.openBlock(),e.createElementBlock("view",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.teachers,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"teacher-item"},[e.createElementVNode("view",{class:"item-header"},[e.createElementVNode("text",{class:"item-title"},"指导老师 "+e.toDisplayString(a+1),1),e.createElementVNode("view",{class:"delete-btn",onClick:e=>function(e){c.teachers.splice(e,1)}(a)},[e.createElementVNode("text",{class:"iconfont icon-trash"})],8,["onClick"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("选择老师"),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"select-box",onClick:e=>function(e){o.value.open(),k.value=e}(a)},[t.name?(e.openBlock(),e.createElementBlock("text",{key:0,class:"select-text"},e.toDisplayString(t.name),1)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"placeholder-text"},"请选择老师")),e.createElementVNode("text",{class:"iconfont icon-arrow-left select-arrow"})],8,["onClick"])])])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"add-item-btn",onClick:F},[e.createElementVNode("text",{class:"iconfont icon-plus"}),e.createElementVNode("text",null,"添加指导老师")])]),e.createVNode(i,{ref_key:"teacherPopup",ref:o,type:"bottom"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"popup-container"},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"选择指导老师"),e.createElementVNode("text",{class:"popup-close",onClick:R},"关闭")]),e.createElementVNode("view",{class:"search-box"},[e.createElementVNode("view",{class:"search-input-wrapper"},[e.createElementVNode("text",{class:"iconfont icon-search"}),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[7]||(n[7]=e=>S.value=e),placeholder:"搜索教师姓名",class:"search-input",onInput:O},null,544),[[e.vModelText,S.value]]),S.value?(e.openBlock(),e.createElementBlock("text",{key:0,class:"iconfont icon-times-circle clear-btn",onClick:G})):e.createCommentVNode("",!0)])]),e.createElementVNode("scroll-view",{"scroll-x":"true",class:"category-scroll"},[e.createElementVNode("view",{class:"category-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["category-tag",{"active-category":y.value===t.id}]),onClick:e=>D(t.id)},[e.createElementVNode("text",null,e.toDisplayString(t.name),1)],10,["onClick"])))),128))])]),e.createElementVNode("scroll-view",{"scroll-y":"true",class:"competitions-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(v.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["teacher-item-select",{"active-teacher":null!==k.value&&c.teachers[k.value].id===t.id,"disabled-teacher":H(t.id)}]),onClick:e=>function(e){H(e.id)?uni.showToast({title:"该教师已被选择",icon:"none"}):(c.teachers[k.value].id=e.id,c.teachers[k.value].name=e.name)}(t)},[e.createElementVNode("view",{class:"teacher-info"},[e.createElementVNode("image",{class:"teacher-avatar",src:t.avatarUrl,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"teacher-detail"},[e.createElementVNode("text",{class:"teacher-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"teacher-major"},e.toDisplayString(t.major),1)])]),e.createElementVNode("view",{class:"teacher-status"},[H(t.id)?(e.openBlock(),e.createElementBlock("text",{key:0,class:"selected-tag"},"已选择")):null!==k.value&&c.teachers[k.value].id===t.id?(e.openBlock(),e.createElementBlock("text",{key:1,class:"iconfont icon-check"})):e.createCommentVNode("",!0)])],10,["onClick"])))),128)),0===v.value.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-tip"},[e.createElementVNode("text",null,e.toDisplayString(S.value?"没有找到相关教师":"该专业下暂无教师"),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"popup-footer"},[e.createElementVNode("button",{class:"confirm-btn",onClick:P},"确定")])])])),_:1},512),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"iconfont icon-team section-icon"}),e.createElementVNode("text",{class:"section-title"},"招募角色")]),c.roles.length>0?(e.openBlock(),e.createElementBlock("view",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.roles,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"role-item"},[e.createElementVNode("view",{class:"item-header"},[e.createElementVNode("text",{class:"item-title"},"角色 "+e.toDisplayString(a+1),1),e.createElementVNode("view",{class:"delete-btn",onClick:e=>function(e){c.roles.splice(e,1)}(a)},[e.createElementVNode("text",{class:"iconfont icon-trash"})],8,["onClick"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("角色名称"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":e=>t.name=e,placeholder:"如：算法工程师",class:"form-input"},null,8,["onUpdate:modelValue"]),[[e.vModelText,t.name]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("招募人数"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":e=>t.count=e,placeholder:"请输入招募人数",class:"form-input"},null,8,["onUpdate:modelValue"]),[[e.vModelText,t.count]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},[e.createTextVNode("角色描述"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":e=>t.description=e,placeholder:"请描述该角色的职责",class:"form-textarea"},null,8,["onUpdate:modelValue"]),[[e.vModelText,t.description]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"技能要求"),e.createElementVNode("view",{class:"skill-tags"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.skills,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:"skill-tag"},[e.createElementVNode("text",null,e.toDisplayString(t),1),e.createElementVNode("text",{class:"iconfont icon-times-circle",onClick:e.withModifiers((e=>function(e,t){c.roles[e].skills.splice(t,1)}(a,n)),["stop"])},null,8,["onClick"])])))),128))]),e.createElementVNode("view",{class:"skill-select-btn",onClick:e=>{return t=a,s.value.open(),void(x.value=t);var t}},[e.createElementVNode("text",{class:"iconfont icon-tag"}),e.createElementVNode("text",null,"选择技能标签"),e.createElementVNode("text",{class:"iconfont icon-arrow-right"})],8,["onClick"])])])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"add-item-btn",onClick:z},[e.createElementVNode("text",{class:"iconfont icon-plus"}),e.createElementVNode("text",null,"添加招募角色")])])]),e.createElementVNode("view",{class:"submit-bar"},[e.createElementVNode("button",{class:"submit-btn",onClick:j},"创建团队")]),e.createVNode(i,{ref_key:"skillPopup",ref:s,type:"bottom"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"popup-container"},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"选择技能标签"),e.createElementVNode("text",{class:"popup-close",onClick:W},"关闭")]),e.createElementVNode("view",{class:"search-box"},[e.createElementVNode("view",{class:"search-input-wrapper"},[e.createElementVNode("text",{class:"iconfont icon-search"}),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[8]||(n[8]=e=>b.value=e),placeholder:"搜索技能标签",class:"search-input",onInput:X},null,544),[[e.vModelText,b.value]]),b.value?(e.openBlock(),e.createElementBlock("text",{key:0,class:"iconfont icon-times-circle clear-btn",onClick:K})):e.createCommentVNode("",!0)])]),e.createElementVNode("scroll-view",{"scroll-x":"true",class:"category-scroll"},[e.createElementVNode("view",{class:"category-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t,class:e.normalizeClass(["category-tag",{"active-category":N.value===t}]),onClick:e=>Y(t)},[e.createElementVNode("text",null,e.toDisplayString(t),1)],10,["onClick"])))),128))])]),e.createElementVNode("scroll-view",{"scroll-y":"true",class:"competitions-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(T.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["skill-item-select",{"active-skill":Q(t.tagName),"disabled-skill":Z(t.tagName)}]),onClick:e=>function(e){const t=c.roles[x.value];Q(e.tagName)?t.skills=t.skills.filter((t=>t!==e.tagName)):t.skills.push(e.tagName)}(t)},[e.createElementVNode("view",{class:"skill-info"},[e.createElementVNode("text",{class:"skill-name"},e.toDisplayString(t.tagName),1),t.description?(e.openBlock(),e.createElementBlock("text",{key:0,class:"skill-desc"},e.toDisplayString(t.description),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"skill-check"},[e.createElementVNode("text",{class:e.normalizeClass(["selection-indicator",{selected:Q(t.tagName)}])},e.toDisplayString(Q(t.tagName)?"已选":"选择"),3)])],10,["onClick"])))),128)),0===T.value.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-tip"},[e.createElementVNode("text",null,e.toDisplayString(b.value?"没有找到相关技能":"该分类下暂无技能标签"),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"popup-footer"},[e.createElementVNode("view",{class:"selected-count"},[e.createTextVNode(" 已选: "),e.createElementVNode("text",{class:"count-highlight"},e.toDisplayString(ee()),1),e.createTextVNode(" 个技能 ")]),e.createElementVNode("button",{class:"confirm-btn",onClick:J},"确定")])])])),_:1},512)])}}};const Ue=C({components:{TabBar:M,HeaderBar:I},data:()=>({categories:["全部竞赛","学科竞赛","创新创业","科技竞赛","文体竞赛"],currentCategory:0,loading:!1,hasMore:!0,currentPage:1,pageSize:10,hotCompetitions:[],competitionList:[],currentHotIndex:0,headerPlaceholderHeight:"200rpx"}),onLoad(){this.getHotCompetitions(),this.getCompetitionList(),this.updateHeaderHeight()},mounted(){setTimeout((()=>{this.updateHeaderHeight()}),300)},onPullDownRefresh(){this.onRefresh()},onReachBottom(){this.loadMore()},methods:{updateHeaderHeight(){const e=this.$refs.headerBarRef;e&&e.headerHeight?this.headerPlaceholderHeight=e.headerHeight+"rpx":this.headerPlaceholderHeight=this.categories.length>0?"200rpx":"120rpx"},onSwiperChange(e){this.currentHotIndex=e.detail.current},switchToSlide(e){this.currentHotIndex=e},async getHotCompetitions(){try{this.loading=!0;const e=await N.competitions.getCompetitionsList({pageSize:3,isHot:!0});e&&200===e.code&&e.data&&Array.isArray(e.data.list)&&(this.hotCompetitions=e.data.list)}catch(e){t("error","at pages/competition/index.vue:227","获取热门竞赛失败:",e),uni.showToast({title:"获取热门竞赛失败",icon:"none"}),this.hotCompetitions=[]}finally{this.loading=!1}},async getCompetitionList(e=!0){try{if(e&&(this.currentPage=1,this.competitionList=[]),!this.hasMore&&!e)return;this.loading=!0;const t={pageNum:this.currentPage,pageSize:this.pageSize};if(this.currentCategory>0){const e=[null,1,2,3,4];t.categoryId=e[this.currentCategory]}const a=await N.competitions.getCompetitionsList(t);a&&200===a.code&&a.data&&(e?this.competitionList=Array.isArray(a.data.list)?a.data.list:[]:Array.isArray(a.data.list)&&(this.competitionList=[...this.competitionList,...a.data.list]),this.hasMore=a.data.hasNext||!1,0===this.competitionList.length&&uni.showToast({title:"暂无竞赛数据",icon:"none"}))}catch(a){t("error","at pages/competition/index.vue:287","获取竞赛列表失败:",a),uni.showToast({title:"获取竞赛列表失败",icon:"none"}),e&&(this.competitionList=[])}finally{this.loading=!1}},loadMore(){!this.loading&&this.hasMore&&(this.currentPage++,this.getCompetitionList(!1))},onRefresh(){this.getCompetitionList(!0),this.getHotCompetitions(),uni.stopPullDownRefresh()},getCategoryClass(e){switch(e){case"创新创业":return"tag-orange";case"学科竞赛":return"tag-green";case"科技竞赛":return"tag-blue";case"文体竞赛":return"tag-purple";default:return""}},getStatusClass(e){switch(e){case"0":return"status-upcoming";case"1":return"status-active";case"2":return"status-ongoing";case"3":return"status-ended";default:return""}},formatDate(e){if(!e)return"";const t=new Date(e);return`${t.getMonth()+1}月${t.getDate()}日`},isUpcoming:e=>"0"===e.status,selectCategory(e){this.currentCategory!==e&&(this.currentCategory=e,this.getCompetitionList(!0))},viewDetail(e){uni.navigateTo({url:`/pages/competition/detail?id=${e}`})},handleTabChange(e){"home"===e?uni.switchTab({url:"/pages/index/index"}):"team"===e?uni.switchTab({url:"/pages/team/list"}):"profile"===e&&uni.switchTab({url:"/pages/profile/index"})},goToNotification(){uni.navigateTo({url:"/pages/Xiaoxi/Xiaoxi"})},goToSearch(){uni.navigateTo({url:"/pages/search/index"})},showPublishOptions(){uni.showActionSheet({itemList:["发布竞赛信息","招募队友","发布项目展示"],success:function(e){uni.showToast({title:`选择了: ${e.tapIndex}`,icon:"none"})}})},getActionText(e){switch(e){case"0":return"提醒我";case"1":case"2":default:return"查看详情";case"3":return"查看结果"}}}},[["render",function(t,a,n,i,l,o){const s=e.resolveComponent("header-bar"),r=e.resolveComponent("tab-bar");return e.openBlock(),e.createElementBlock("view",{class:"container",ref:"instance"},[e.createVNode(s,{ref:"headerBarRef",title:"竞赛广场",categories:l.categories,"default-category":l.currentCategory,"show-filter":"true",onSearch:o.goToSearch,onFilter:o.goToNotification,onCategoryChange:o.selectCategory},null,8,["categories","default-category","onSearch","onFilter","onCategoryChange"]),e.createElementVNode("view",{class:"header-placeholder",style:e.normalizeStyle({height:l.headerPlaceholderHeight})},null,4),e.createElementVNode("scroll-view",{"scroll-y":"true",class:"competition-content",onScrolltolower:a[2]||(a[2]=(...e)=>o.loadMore&&o.loadMore(...e))},[l.hotCompetitions&&l.hotCompetitions.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"热门竞赛")]),e.createElementVNode("swiper",{class:"hot-swiper",indicator:!1,autoplay:!0,interval:3e3,duration:500,circular:!0,current:l.currentHotIndex,onChange:a[0]||(a[0]=(...e)=>o.onSwiperChange&&o.onSwiperChange(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.hotCompetitions,((t,a)=>(e.openBlock(),e.createElementBlock("swiper-item",{key:a,class:"hot-swiper-item"},[e.createElementVNode("view",{class:"hot-item",onClick:e=>o.viewDetail(t.id)},[e.createElementVNode("image",{class:"hot-img",src:t.coverImageUrl,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"hot-overlay"},[e.createElementVNode("text",{class:"hot-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"hot-desc"},e.toDisplayString(t.shortDescription),1),e.createElementVNode("view",{class:"hot-info"},[e.createElementVNode("view",{class:"hot-info-item"},[e.createElementVNode("text",{class:"iconfont icon-calendar"}),e.createElementVNode("text",{class:"hot-date"},"报名截止: "+e.toDisplayString(o.formatDate(t.registrationDeadline)),1)]),e.createElementVNode("view",{class:"hot-info-item"},[e.createElementVNode("text",{class:"iconfont icon-team"}),e.createElementVNode("text",{class:"hot-team"},e.toDisplayString(t.teamSize)+"~"+e.toDisplayString(t.teamMax)+"人",1)])])])],8,["onClick"])])))),128))],40,["current"]),e.createElementVNode("view",{class:"dots-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.hotCompetitions,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["dot",{"active-dot":l.currentHotIndex===a}]),onClick:e=>o.switchToSlide(a)},null,10,["onClick"])))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"最新竞赛")]),e.createElementVNode("view",{class:"competition-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.competitionList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"competition-card",key:a,onClick:e=>o.viewDetail(t.id)},[e.createElementVNode("view",{class:"card-image-wrapper"},[e.createElementVNode("image",{class:"card-image",src:t.coverImageUrl,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:e.normalizeClass(["status-badge",o.getStatusClass(t.status)])},e.toDisplayString(t.statusText),3)]),e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("text",{class:"card-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"card-desc"},e.toDisplayString(t.shortDescription),1),e.createElementVNode("view",{class:"card-tags"},[e.createElementVNode("text",{class:e.normalizeClass(["category-tag",o.getCategoryClass(t.categoryName)])},e.toDisplayString(t.categoryName),3),e.createElementVNode("text",{class:"level-tag"},e.toDisplayString(t.level),1),e.createElementVNode("text",{class:"team-tag"},[e.createElementVNode("text",{class:"iconfont icon-team"}),e.createTextVNode(" "+e.toDisplayString(t.teamSize)+"~"+e.toDisplayString(t.teamMax)+"人 ",1)])]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("view",{class:"date-info"},[e.createElementVNode("text",{class:"iconfont icon-calendar"}),e.createElementVNode("text",{class:"date-text"},e.toDisplayString(o.isUpcoming(t)?"报名开始":"报名截止")+": "+e.toDisplayString(o.formatDate(o.isUpcoming(t)?t.registrationStart:t.registrationDeadline)),1)]),e.createElementVNode("view",{class:e.normalizeClass(["action-btn",{"disabled-btn":"0"===t.status||"3"===t.status}])},e.toDisplayString(o.getActionText(t.status)),3)])])],8,["onClick"])))),128)),l.competitionList.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-more"},[l.loading?(e.openBlock(),e.createElementBlock("text",{key:0},"加载中...")):l.hasMore?(e.openBlock(),e.createElementBlock("text",{key:1,onClick:a[1]||(a[1]=(...e)=>o.loadMore&&o.loadMore(...e))},"点击加载更多")):(e.openBlock(),e.createElementBlock("text",{key:2},"没有更多竞赛了"))])):e.createCommentVNode("",!0),0!==l.competitionList.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("text",{class:"empty-text"},"暂无竞赛数据")]))])])],32),e.createVNode(r,{"active-tab":"competition",onTabChange:o.handleTabChange,onPublish:o.showPublishOptions},null,8,["onTabChange","onPublish"])],512)}]]),je={__name:"create",setup(n){const i=e.reactive({title:"",categoryId:null,level:"",shortDescription:"",description:"",requirements:"",registrationStart:"",registrationEnd:"",teamMin:"",teamMax:"",isHot:!1,websiteUrl:"",name:"",contactQQ:"",contactEmail:"",coverUrl:"",coverFile:null,attachments:[]}),l=e.ref([]),o=["国家级","省级","市级","校级"];function s(e){return{"计算机类":"iconfont icon-computer","设计类":"iconfont icon-palette","创新创业":"iconfont icon-lightbulb","学科竞赛":"iconfont icon-book","科技竞赛":"iconfont icon-chip","文化艺术":"iconfont icon-palette","体育竞赛":"iconfont icon-running"}[e]||"iconfont icon-more"}function r(){l.value=[{label:"创新创业",value:2,icon:"iconfont icon-lightbulb",id:2},{label:"学科竞赛",value:1,icon:"iconfont icon-book",id:1},{label:"科技竞赛",value:3,icon:"iconfont icon-chip",id:3},{label:"文化艺术",value:4,icon:"iconfont icon-palette",id:4},{label:"体育竞赛",value:5,icon:"iconfont icon-running",id:5},{label:"其他",value:6,icon:"iconfont icon-more",id:6}]}function c(){uni.showToast({title:"只有管理员才能发布竞赛",icon:"none"}),setTimeout((()=>{uni.navigateBack()}),1500)}function d(){uni.navigateBack()}function m(){if(!i.title)return uni.showToast({title:"请输入竞赛标题",icon:"none"});w(0)}function h(){uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:e=>{i.coverUrl=e.tempFilePaths[0],i.coverFile=e.tempFiles[0]}})}function g(){uni.chooseFile({count:5,type:"all",extension:[".pdf",".doc",".docx",".ppt",".pptx",".xls",".xlsx",".zip"],success:e=>{const t=e.tempFiles.map((e=>({name:e.name||"未命名文件",path:e.path,size:e.size,file:e})));i.attachments=[...i.attachments,...t]}})}function f(){(function(){if(!i.title)return v("请输入竞赛标题"),!1;if(!i.categoryId)return v("请选择竞赛分类"),!1;if(!i.level)return v("请选择竞赛级别"),!1;if(!i.shortDescription)return v("请填写竞赛简介"),!1;if(!i.description)return v("请填写竞赛介绍"),!1;if(!i.requirements)return v("请填写参赛要求"),!1;if(!i.registrationStart||!i.registrationEnd)return v("请选择竞赛时间"),!1;if(!i.teamMin||!i.teamMax)return v("请填写团队人数"),!1;if(!i.name||!i.contactEmail)return v("请填写联系方式"),!1;if(!i.coverUrl)return v("请上传竞赛封面"),!1;return!0})()&&w(1)}function v(e){uni.showToast({title:e,icon:"none"})}async function w(e){const a={title:i.title,categoryId:i.categoryId,level:i.level,shortDescription:i.shortDescription,description:i.description,requirements:i.requirements,registrationStart:i.registrationStart+"T00:00:00",registrationDeadline:i.registrationEnd+"T23:59:59",teamSize:parseInt(i.teamMin)||1,teamMax:parseInt(i.teamMax)||5,status:e.toString(),organizer:"主办方名称",websiteUrl:i.websiteUrl,contactInfo:{email:i.contactEmail,qq:i.contactQQ,name:i.name}};uni.showLoading({title:0===e?"保存中...":"发布中..."});try{const t=new FormData;t.append("competitionData",JSON.stringify(a)),i.coverFile&&t.append("coverImage",i.coverFile),i.attachments.forEach(((e,a)=>{e.file&&t.append("attachmentFiles",e.file)}));const n=uni.getStorageSync("token"),l=await new Promise(((e,t)=>{uni.uploadFile({url:"http://localhost:8080/competitions/with-files",files:i.attachments.map((e=>({name:"attachmentFiles",file:e.file}))),filePath:i.coverUrl,name:"coverImage",formData:{competitionData:JSON.stringify(a)},header:{Authorization:"Bearer "+n},success:t=>{let a;try{a=JSON.parse(t.data)}catch(n){a={code:-1,message:"返回数据解析失败"}}e(a)},fail:e=>{t(e)}})}));200===l.code?(uni.showToast({title:0===e?"保存成功":"发布成功",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)):uni.showToast({title:l.message||"操作失败",icon:"none"})}catch(n){t("error","at pages/competition/create.vue:669","操作失败:",n),uni.showToast({title:"操作失败，请重试",icon:"none"})}finally{uni.hideLoading()}}return e.onMounted((async()=>{await async function(){try{const e=uni.getStorageSync("token");if(!e)return void c();const t=await u.getUserRole(e);200===t.code&&"admin"===t.data||c()}catch(e){t("error","at pages/competition/create.vue:400","获取角色失败:",e),c()}}(),await async function(){try{const e=await p.getCompetitionCategories();200===e.code&&e.data&&Array.isArray(e.data)?l.value=e.data.map((e=>({label:e.name,value:e.id,icon:s(e.name),id:e.id}))):(t("error","at pages/competition/create.vue:350","获取分类失败:",e),r())}catch(e){t("error","at pages/competition/create.vue:354","获取分类出错:",e),r()}}()})),(t,n)=>{const s=a(e.resolveDynamicComponent("uni-easyinput"),ae);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"sticky-header"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-btn",onClick:d},[e.createElementVNode("text",{class:"iconfont icon-arrow-left"})]),e.createElementVNode("text",{class:"page-title"},"发布竞赛"),e.createElementVNode("view",{class:"draft-btn",onClick:m},"草稿箱")])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"form-content"},[e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("text",{class:"section-title"},"基本信息"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"竞赛标题"),e.createElementVNode("text",{class:"required"},"*")]),e.createVNode(s,{type:"text",modelValue:i.title,"onUpdate:modelValue":n[0]||(n[0]=e=>i.title=e),placeholder:"请输入竞赛名称（5-50字",clearable:!1},null,8,["modelValue"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"竞赛分类"),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"category-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["category-item",{"category-active":i.categoryId===t.id}]),onClick:e=>i.categoryId=t.id},[e.createElementVNode("text",{class:e.normalizeClass(["category-icon",t.icon])},null,2),e.createElementVNode("text",null,e.toDisplayString(t.label),1)],10,["onClick"])))),128))])]),e.createElementVNode("view",null,[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"竞赛级别"),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("scroll-view",{class:"level-scroll","scroll-x":""},[e.createElementVNode("view",{class:"level-list"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(o,((t,a)=>e.createElementVNode("view",{key:a,class:e.normalizeClass(["level-item",{"level-active":i.level===t}]),onClick:e=>i.level=t},[e.createElementVNode("text",null,e.toDisplayString(t),1)],10,["onClick"]))),64))])])])]),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("text",{class:"section-title"},"竞赛详情"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"竞赛简介"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":n[1]||(n[1]=e=>i.shortDescription=e),placeholder:"请填写竞赛简介（10-30个字）",class:"form-textarea",maxlength:"140"},null,512),[[e.vModelText,i.shortDescription]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"竞赛介绍"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":n[2]||(n[2]=e=>i.description=e),placeholder:"请详细描述竞赛背景、目的和意义（50-1000字）",class:"form-textarea",maxlength:"2000"},null,512),[[e.vModelText,i.description]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"参赛要求"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":n[3]||(n[3]=e=>i.requirements=e),placeholder:"请说明参赛资格、人数限制等要求（20-500字）",class:"form-textarea form-textarea-medium",maxlength:"1000"},null,512),[[e.vModelText,i.requirements]])])]),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("text",{class:"section-title"},"时间与团队"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"竞赛时间"),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"time-grid"},[e.createElementVNode("view",{class:"time-column"},[e.createElementVNode("text",{class:"time-label"},"报名开始时间"),e.createElementVNode("picker",{mode:"date",value:i.registrationStart,onChange:n[4]||(n[4]=e=>i.registrationStart=e.detail.value),class:"date-picker"},[e.createElementVNode("view",{class:"picker-view"},[i.registrationStart?(e.openBlock(),e.createElementBlock("text",{key:0},e.toDisplayString(i.registrationStart),1)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"placeholder-text"},"选择日期"))])],40,["value"])]),e.createElementVNode("view",{class:"time-column"},[e.createElementVNode("text",{class:"time-label"},"报名截止时间"),e.createElementVNode("picker",{mode:"date",value:i.registrationEnd,onChange:n[5]||(n[5]=e=>i.registrationEnd=e.detail.value),class:"date-picker"},[e.createElementVNode("view",{class:"picker-view"},[i.registrationEnd?(e.openBlock(),e.createElementBlock("text",{key:0},e.toDisplayString(i.registrationEnd),1)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"placeholder-text"},"选择日期"))])],40,["value"])])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"团队人数"),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"time-grid"},[e.createElementVNode("view",{class:"time-column"},[e.createElementVNode("text",{class:"time-label"},"最少人数"),e.createVNode(s,{type:"number",modelValue:i.teamMin,"onUpdate:modelValue":n[6]||(n[6]=e=>i.teamMin=e),placeholder:"输入人数",clearable:!1},null,8,["modelValue"])]),e.createElementVNode("view",{class:"time-column"},[e.createElementVNode("text",{class:"time-label"},"最多人数"),e.createVNode(s,{type:"number",modelValue:i.teamMax,"onUpdate:modelValue":n[7]||(n[7]=e=>i.teamMax=e),placeholder:"输入人数",clearable:!1},null,8,["modelValue"])])])]),e.createElementVNode("view",{class:"hot-toggle"},[e.createElementVNode("view",{class:"hot-info"},[e.createElementVNode("text",{class:"hot-title"},"设为热门竞赛"),e.createElementVNode("text",{class:"hot-desc"},"热门竞赛将在首页和竞赛列表优先展示")]),e.createElementVNode("switch",{checked:i.isHot,onChange:n[8]||(n[8]=e=>i.isHot=e.detail.value),color:"#00aaff"},null,40,["checked"])])]),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("text",{class:"section-title"},"联系方式与附件"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"官方网站（可选）")]),e.createVNode(s,{type:"text",modelValue:i.websiteUrl,"onUpdate:modelValue":n[9]||(n[9]=e=>i.websiteUrl=e),placeholder:"输入网站",clearable:!1},null,8,["modelValue"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"联系方式"),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"contact-grid"},[e.createElementVNode("view",{class:"contact-row"},[e.createElementVNode("view",{class:"contact-input"},[e.createElementVNode("text",{class:"contact-icon iconfont icon-user"}),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[10]||(n[10]=e=>i.name=e),placeholder:"联系人"},null,512),[[e.vModelText,i.name]])]),e.createElementVNode("view",{class:"contact-input"},[e.createElementVNode("text",{class:"contact-icon iconfont icon-qq"}),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[11]||(n[11]=e=>i.contactQQ=e),placeholder:"QQ群"},null,512),[[e.vModelText,i.contactQQ]])])]),e.createElementVNode("view",{class:"contact-input contact-email"},[e.createElementVNode("text",{class:"contact-icon iconfont icon-email"}),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[12]||(n[12]=e=>i.contactEmail=e),placeholder:"联系邮箱"},null,512),[[e.vModelText,i.contactEmail]])])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"竞赛封面"),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"upload-box",onClick:h},[i.coverUrl?(e.openBlock(),e.createElementBlock("image",{key:1,src:i.coverUrl,mode:"aspectFill",class:"cover-image"},null,8,["src"])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"upload-placeholder"},[e.createElementVNode("text",{class:"upload-icon iconfont icon-image"}),e.createElementVNode("text",{class:"upload-text"},"点击上传或拖拽图片至此处"),e.createElementVNode("text",{class:"upload-tip"},"建议尺寸：800x400，文件大小不超过2MB")]))])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},[e.createElementVNode("text",null,"竞赛附件（可选）")]),e.createElementVNode("view",{class:"upload-box",onClick:g},[0===i.attachments.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"upload-placeholder"},[e.createElementVNode("text",{class:"upload-icon iconfont icon-file"}),e.createElementVNode("text",{class:"upload-text"},"点击上传或拖拽文件至此处"),e.createElementVNode("text",{class:"upload-tip"},"支持PDF、Word、PPT等格式，单个文件不超过10MB")])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"file-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.attachments,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"file-item"},[e.createElementVNode("text",{class:"file-icon iconfont icon-file"}),e.createElementVNode("text",{class:"file-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"delete-icon iconfont icon-close",onClick:e.withModifiers((e=>function(e){i.attachments.splice(e,1)}(a)),["stop"])},null,8,["onClick"])])))),128))]))])])])]),e.createElementVNode("view",{class:"action-bar"},[e.createElementVNode("view",{class:"action-grid"},[e.createElementVNode("button",{class:"draft-button",onClick:m},"保存草稿"),e.createElementVNode("button",{class:"publish-button",onClick:f},[e.createElementVNode("text",{class:"iconfont icon-send"}),e.createElementVNode("text",null,"发布竞赛")])])])])}}},qe={__name:"detail",setup(a){const n=e.ref(null),i=e.ref(!1),l=e.ref("details"),o=e.ref({id:null,title:"",category:"",level:"国家级",status:"",statusCode:"",image:"",registrationPeriod:"",registrationStart:"",registrationDeadline:"",competitionPeriod:"",location:"线上初赛 + 线下决赛",teamRequirement:"",description:"",shortDescription:"",requirements:"",organizer:{name:"",description:"",logo:""},contactInfo:{phone:"",email:""},teamSize:0,teamMax:0,websiteUrl:"",viewCount:0,attachments:[],categoryNames:[],coverImageUrl:""}),s=e.ref([{title:"报名阶段",period:"",description:"在此阶段，参赛团队需完成在线报名，提交团队基本信息和项目概述。报名成功后，团队可以开始准备初赛材料。",status:"进行中",active:!0},{title:"初赛阶段",period:"",description:"各参赛团队需提交商业计划书和项目PPT。评审委员会将对所有参赛项目进行评审，选拔优秀项目进入复赛。",status:"未开始",active:!1},{title:"复赛阶段",period:"",description:"入围复赛的团队将进行现场路演和答辩。评委将从项目创新性、商业模式、团队能力等多方面进行评估。",status:"未开始",active:!1},{title:"总决赛",period:"",description:"决赛将在北京举行，入围团队将进行最终路演和展示。评审团将评选出金、银、铜奖项目，并举行颁奖典礼。",status:"未开始",active:!1}]),r=e.ref([{title:"挑战杯创业计划大赛",image:"https://images.unsplash.com/photo-1523240795612-9a054b0db644?w=500",deadline:"6月10日"},{title:"创青春创业大赛",image:"https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=500",deadline:"7月5日"}]),c=e.ref([]),d=e.ref(!1),u=e.ref(1),m=e.ref(10),p=e.ref(!0),h=e.ref("");async function g(e){i.value=!0;try{const a=await N.competitions.getCompetitionDetail(e);if(a&&200===a.code&&a.data){const e=a.data;o.value={...o.value,id:e.id,title:e.title,category:e.categoryNames&&e.categoryNames.length>0?e.categoryNames[0]:"",level:e.level||"国家级",status:f(e.status),statusCode:e.status,image:e.coverImageUrl||"https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?w=800",registrationStart:e.registrationStart,registrationDeadline:e.registrationDeadline,registrationPeriod:v(e.registrationStart,e.registrationDeadline),description:e.description||e.shortDescription||"",shortDescription:e.shortDescription||"",requirements:e.requirements||"",teamRequirement:`${e.teamSize}~${e.teamMax}人/队`,teamSize:e.teamSize,teamMax:e.teamMax,organizer:{name:e.organizer||"未知主办方",description:"",logo:""},contactInfo:e.contactInfo||{phone:"暂无联系方式",email:""},websiteUrl:e.websiteUrl||"",viewCount:e.viewCount||0,attachments:e.attachments||[],categoryNames:e.categoryNames||[],coverImageUrl:e.coverImageUrl||""},function(e){if(e.registrationStart&&e.registrationDeadline){s.value[0].period=v(e.registrationStart,e.registrationDeadline);const t=new Date,a=new Date(e.registrationStart),n=new Date(e.registrationDeadline);t<a?(s.value[0].status="未开始",s.value[0].active=!1):t>=a&&t<=n?(s.value[0].status="进行中",s.value[0].active=!0):(s.value[0].status="已结束",s.value[0].active=!1),"2"===e.status?(s.value[1].active=!0,s.value[1].status="进行中",s.value[0].status="已结束"):"3"===e.status&&(s.value[0].status="已结束",s.value[1].status="已结束",s.value[2].status="已结束",s.value[3].status="已结束")}}(e),t("log","at pages/competition/detail.vue:409","竞赛详情数据:",o.value)}else uni.showToast({title:"获取竞赛详情失败",icon:"none"})}catch(a){t("error","at pages/competition/detail.vue:417","获取竞赛详情错误:",a),uni.showToast({title:"获取竞赛详情失败",icon:"none"})}finally{i.value=!1}}function f(e){switch(e){case"0":return"未开始";case"1":return"报名中";case"2":return"进行中";case"3":return"已截止";default:return"未知状态"}}function v(e,t){if(!e||!t)return"";const a=e=>{const t=new Date(e);return`${t.getFullYear()}年${t.getMonth()+1}月${t.getDate()}日`};return`${a(e)} - ${a(t)}`}async function w(e=!0){if(e&&(u.value=1,c.value=[]),p.value||e){d.value=!0;try{const t=await N.team.getTeamList({pageNum:u.value,pageSize:m.value,competitionId:n.value});if(200===t.code&&t.data){const a=(t.data.list||[]).map((e=>{let t=[];e.teamMemberAvatars&&("string"==typeof e.teamMemberAvatars?t=e.teamMemberAvatars.split(",").filter((e=>e)):Array.isArray(e.teamMemberAvatars)&&(t=e.teamMemberAvatars.filter((e=>e))));let a="#6B7280";"0"===e.status||"招募中"===e.statusText?a="#2563EB":"1"===e.status||"进行中"===e.statusText?a="#10B981":"2"!==e.status&&"已完成"!==e.statusText||(a="#059669");const n=e.memberCount||e.currentMemberCount||0,i=e.maxMemberCount||0,l=Math.max(0,i-n),o=function(e){const t=["#2563EB","#10B981","#8B5CF6","#EC4899","#F59E0B","#EF4444"];let a=0;if(0===e.length)return t[0];for(let n=0;n<e.length;n++)a=e.charCodeAt(n)+((a<<5)-a),a&=a;return a=Math.abs(a)%t.length,t[a]}(e.faculty||e.direction||"");let s=[];return e.roles&&e.roles.length>0&&(s=e.roles.map((e=>({id:e.id||0,name:e.name||"未知角色",description:e.description||"",currentCount:e.currentCount||0,requiredCount:e.requiredCount||1,isFilled:(e.currentCount||0)>=(e.requiredCount||1)})))),{...e,avatars:t.slice(0,3),statusColor:a,memberCount:n,remainingCount:l,actionText:"0"===e.status?"申请加入":"查看详情",facultyColor:o,faculty:e.direction||"未知方向",roles:s}}));c.value=e?a:[...c.value,...a],p.value=t.data.hasNext||!1,0!==c.value.length||e||uni.showToast({title:"没有更多团队了",icon:"none"})}else e&&uni.showToast({title:"暂无参赛队伍",icon:"none"})}catch(a){t("error","at pages/competition/detail.vue:590","获取竞赛队伍列表失败:",a),uni.showToast({title:"获取队伍列表失败",icon:"none"})}finally{d.value=!1}}}function y(){!d.value&&p.value&&(u.value++,w(!1))}function k(e){l.value=e,"teams"===e&&0===c.value.length&&w()}function E(e){switch(e){case"创新创业":return"orange-tag";case"学科竞赛":return"green-tag";case"科技竞赛":return"blue-tag";case"文体竞赛":return"purple-tag";default:return"gray-tag"}}function V(e){switch(e){case"未开始":case"已截止":default:return"status-badge bg-gray-500";case"报名中":return"status-badge bg-green-500";case"进行中":return"status-badge bg-blue-500"}}function x(){switch(o.value.status){case"未开始":return"提醒我";case"报名中":return"寻找队伍";case"进行中":return"查看队伍";case"已截止":return"查看结果";default:return"了解详情"}}function b(){if(o.value.registrationDeadline){const e=new Date(o.value.registrationDeadline);return`${e.getFullYear()}年${e.getMonth()+1}月${e.getDate()}日`}if(o.value.registrationPeriod){const e=o.value.registrationPeriod.split(" - ");return e.length>1?e[1]:o.value.registrationPeriod}return"暂无截止日期"}function T(){uni.navigateBack()}function S(){h.value=""}function C(){t("log","at pages/competition/detail.vue:750","打开筛选选项")}return e.onMounted((()=>{const e=getCurrentPages(),t=e[e.length-1];t.$page&&t.$page.options?(n.value=t.$page.options.id,n.value?g(n.value).finally((()=>{uni.hideLoading()})):(uni.hideLoading(),uni.showToast({title:"竞赛ID不存在",icon:"none"}))):uni.hideLoading()})),(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[i.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"spinner"}),e.createElementVNode("text",{class:"loading-text"},"加载中...")])):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createElementVNode("view",{class:"sticky-header"},[e.createElementVNode("view",{class:"flex-row px-4 py-3"},[e.createElementVNode("view",{class:"mr-3",onClick:T},[e.createElementVNode("text",{class:"iconfont icon-arrow-left text-gray-600"})]),e.createElementVNode("text",{class:"text-xl font-bold text-gray-800"},"竞赛详情"),e.createElementVNode("view",{class:"ml-auto flex-row space-x-3"},[e.createElementVNode("view",{class:"p-2 rounded-full bg-gray-100"},[e.createElementVNode("text",{class:"iconfont icon-bookmark-outline text-gray-600"})]),e.createElementVNode("view",{class:"p-2 rounded-full bg-gray-100"},[e.createElementVNode("text",{class:"iconfont icon-share text-gray-600"})])])])]),e.createElementVNode("view",{class:"relative"},[e.createElementVNode("image",{class:"cover-image",src:o.value.image,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"cover-overlay"},[e.createElementVNode("view",{class:e.normalizeClass(V(o.value.status))},e.toDisplayString(o.value.status),3),e.createElementVNode("text",{class:"text-white text-2xl font-bold"},e.toDisplayString(o.value.title),1),e.createElementVNode("view",{class:"flex-row items-center mt-1 space-x-2"},[e.createElementVNode("text",{class:e.normalizeClass(["category-tag",E(o.value.category)])},e.toDisplayString(o.value.category),3)])])]),e.createElementVNode("view",{class:"bg-white p-4 shadow-sm"},[e.createElementVNode("view",{class:"flex-row justify-between items-center"},[e.createElementVNode("view",{class:"flex-row items-center space-x-2"},[e.createElementVNode("text",{class:"iconfont icon-calendar info-icon"}),e.createElementVNode("text",{class:"text-sm text-gray-700"},"报名截止: "+e.toDisplayString(b()),1)]),e.createElementVNode("view",{class:"flex-row items-center space-x-2"},[e.createElementVNode("text",{class:"iconfont icon-users info-icon"}),e.createElementVNode("text",{class:"text-sm text-gray-700"},e.toDisplayString(o.value.teamRequirement),1)])]),e.createElementVNode("view",{class:"flex-row justify-between items-center mt-3"},[e.createElementVNode("view",{class:"flex-row items-center space-x-2",style:{width:"60%"}},[e.createElementVNode("text",{class:"iconfont icon-university info-icon"}),e.createElementVNode("text",{class:"text-sm text-gray-700"},"主办方: "+e.toDisplayString(o.value.organizer.name),1)]),e.createElementVNode("view",{class:"flex-row items-center space-x-2"},[e.createElementVNode("text",{class:"iconfont icon-trophy info-icon"}),e.createElementVNode("text",{class:"text-sm text-gray-700"},e.toDisplayString(o.value.level),1)])])]),e.createElementVNode("view",{class:"bg-white mt-2 shadow-sm"},[e.createElementVNode("view",{class:"flex-row border-b"},[e.createElementVNode("view",{class:e.normalizeClass(["flex-1 py-3 text-center text-sm font-medium","details"===l.value?"tab-active":"text-gray-500"]),onClick:a[0]||(a[0]=e=>k("details"))},"竞赛详情",2),e.createElementVNode("view",{class:e.normalizeClass(["flex-1 py-3 text-center text-sm font-medium","schedule"===l.value?"tab-active":"text-gray-500"]),onClick:a[1]||(a[1]=e=>k("schedule"))},"赛程安排",2),e.createElementVNode("view",{class:e.normalizeClass(["flex-1 py-3 text-center text-sm font-medium","teams"===l.value?"tab-active":"text-gray-500"]),onClick:a[2]||(a[2]=e=>k("teams"))},"参赛队伍",2)])]),"details"===l.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"bg-white p-4 mt-2 shadow-sm"},[e.createElementVNode("view",{class:"font-bold text-lg text-gray-800 mb-3"},"竞赛简介"),e.createElementVNode("text",{class:"text-gray-700 text-sm leading-relaxed"},e.toDisplayString(o.value.description),1),o.value.requirements?(e.openBlock(),e.createElementBlock("view",{key:0,class:"font-bold text-lg text-gray-800 mt-6 mb-3"},"参赛要求")):e.createCommentVNode("",!0),o.value.requirements?(e.openBlock(),e.createElementBlock("text",{key:1,class:"text-gray-700 text-sm leading-relaxed"},e.toDisplayString(o.value.requirements),1)):(e.openBlock(),e.createElementBlock("view",{key:2,class:"text-gray-700 text-sm space-y-2 list-disc pl-5 mt-6"},[e.createElementVNode("view",{class:"list-item"},"参赛项目须为本校在校生，允许跨校组队"),e.createElementVNode("view",{class:"list-item"},"参赛团队成员"+e.toDisplayString(o.value.teamRequirement),1),e.createElementVNode("view",{class:"list-item"},"参赛项目需具有创新性、可行性和商业价值"),e.createElementVNode("view",{class:"list-item"},"参赛项目需提交商业计划书和路演PPT"),e.createElementVNode("view",{class:"list-item"},"参赛项目需在报名截止前完成在线提交")])),e.createElementVNode("view",{class:"font-bold text-lg text-gray-800 mt-6 mb-3"},"联系方式"),e.createElementVNode("view",{class:"space-y-2 text-sm text-gray-700"},[o.value.contactInfo.phone?(e.openBlock(),e.createElementBlock("text",{key:0},"联系电话："+e.toDisplayString(o.value.contactInfo.phone),1)):(e.openBlock(),e.createElementBlock("text",{key:1},"联系人：竞赛组委会")),o.value.contactInfo.email?(e.openBlock(),e.createElementBlock("view",{key:2},"邮箱："+e.toDisplayString(o.value.contactInfo.email),1)):e.createCommentVNode("",!0),o.value.websiteUrl?(e.openBlock(),e.createElementBlock("view",{key:3},"官网："+e.toDisplayString(o.value.websiteUrl),1)):e.createCommentVNode("",!0)]),o.value.attachments&&o.value.attachments.length>0?(e.openBlock(),e.createElementBlock("view",{key:3,class:"mt-6"},[e.createElementVNode("view",{class:"font-bold text-lg text-gray-800 mb-3"},"相关资料"),e.createElementVNode("view",null,"无"),e.createElementVNode("view",{class:"space-y-3"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value.attachments,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"flex-row items-center p-3 bg-gray-50 rounded-lg"},[e.createElementVNode("text",{class:"iconfont icon-file text-blue-500 mr-2"}),e.createElementVNode("text",{class:"flex-1 text-sm text-gray-700"},e.toDisplayString(t.fileName),1),e.createElementVNode("view",{class:"px-3 py-1 bg-blue-500 rounded-full"},[e.createElementVNode("text",{class:"text-xs text-white"},"下载")])])))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"mt-6"},[e.createElementVNode("view",{class:"font-bold text-lg text-gray-800 mb-3"},"相关竞赛"),e.createElementVNode("view",{class:"related-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"related-card"},[e.createElementVNode("view",{class:"related-image-container"},[e.createElementVNode("image",{src:t.image,class:"related-image"},null,8,["src"])]),e.createElementVNode("view",{class:"p-3"},[e.createElementVNode("text",{class:"font-bold text-sm text-gray-800"},e.toDisplayString(t.title),1),e.createElementVNode("view",{class:"flex-row items-center mt-1"},[e.createElementVNode("text",{class:"text-xs text-gray-500"},"报名截止: "+e.toDisplayString(t.deadline),1)])])])))),128))])])])):e.createCommentVNode("",!0),"schedule"===l.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"bg-white p-4 mt-2 shadow-sm"},[e.createElementVNode("view",{class:"relative"},[e.createElementVNode("view",{class:"timeline-line"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"timeline-item"},[e.createElementVNode("view",{class:"timeline-dot-container"},[e.createElementVNode("view",{class:e.normalizeClass(["timeline-dot",t.active?"active-dot":""])},[e.createElementVNode("text",{class:"timeline-dot-text"},e.toDisplayString(a+1),1)],2)]),e.createElementVNode("view",{class:e.normalizeClass(["timeline-content",t.active?"active-content":""])},[e.createElementVNode("view",{class:"flex-row justify-between items-center mb-2"},[e.createElementVNode("text",{class:e.normalizeClass(["font-bold",t.active?"text-blue-800":"text-gray-700"])},e.toDisplayString(t.title),3),e.createElementVNode("text",{class:e.normalizeClass(["status-text",t.active?"active-status":"inactive-status"])},e.toDisplayString(t.status),3)]),e.createElementVNode("text",{class:"text-sm text-gray-700 mb-2"},e.toDisplayString(t.period),1),e.createElementVNode("text",{class:"text-xs text-gray-600"},e.toDisplayString(t.description),1)],2)])))),128))])])):e.createCommentVNode("",!0),"teams"===l.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"bg-white p-4 mt-2 shadow-sm"},[e.createElementVNode("view",{class:"search-filter-container"},[e.createElementVNode("view",{class:"search-box"},[e.createElementVNode("text",{class:"iconfont icon-search search-icon"}),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"搜索队伍",class:"search-input","onUpdate:modelValue":a[3]||(a[3]=e=>h.value=e)},null,512),[[e.vModelText,h.value]]),h.value?(e.openBlock(),e.createElementBlock("text",{key:0,class:"iconfont icon-close-circle clear-icon",onClick:S})):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"filter-btn",onClick:C},[e.createElementVNode("text",{class:"iconfont icon-filter filter-icon"}),e.createElementVNode("text",{class:"filter-text"},"筛选")])]),c.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"space-y-4"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"team-card",onClick:e=>{return a=t.id,void uni.navigateTo({url:`/pages/team/detail?id=${a}`});var a}},[e.createElementVNode("view",{class:"flex-row justify-between items-start"},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"font-bold text-gray-800"},e.toDisplayString(t.name),1),e.createElementVNode("view",{class:"flex-row items-center mt-1"},[e.createElementVNode("text",{class:"faculty-tag",style:e.normalizeStyle({backgroundColor:t.facultyColor+"20",color:t.facultyColor})},e.toDisplayString(t.faculty),5),e.createElementVNode("text",{class:"text-xs text-gray-500"},e.toDisplayString(t.memberCount)+"人团队",1)])]),e.createElementVNode("view",{class:"team-status",style:e.normalizeStyle({backgroundColor:t.statusColor+"20",color:t.statusColor})},e.toDisplayString(t.statusText),5)]),e.createElementVNode("text",{class:"text-sm text-gray-600 mt-3"},"项目简介："+e.toDisplayString(t.description),1),t.roles&&t.roles.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"role-tags mt-3"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.roles,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["role-tag",t.isFilled?"role-filled":"role-recruiting"])},[e.createElementVNode("text",{class:"role-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"role-count"},e.toDisplayString(t.currentCount||0)+"/"+e.toDisplayString(t.requiredCount||1),1)],2)))),128))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"flex-row items-center justify-between mt-3"},[e.createElementVNode("view",{class:"flex-row member-avatars"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.avatars,((t,a)=>(e.openBlock(),e.createElementBlock("image",{key:a,src:t||"/static/images/default-avatar.png",class:"member-avatar"},null,8,["src"])))),128)),t.remainingCount>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"member-avatar-more"},"+"+e.toDisplayString(t.remainingCount),1)):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"text-blue-500 text-sm"},e.toDisplayString(t.actionText),1)])],8,["onClick"])))),128))])):d.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("text",{class:"text-gray-500"},"暂无参赛队伍")])),d.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"loading-state"},[e.createElementVNode("view",{class:"spinner-sm"}),e.createElementVNode("text",{class:"text-sm text-gray-500 ml-2"},"加载中...")])):e.createCommentVNode("",!0),c.value.length>0&&p.value?(e.openBlock(),e.createElementBlock("view",{key:3,class:"text-center mt-6"},[e.createElementVNode("button",{class:"load-more-btn",onClick:y},"加载更多")])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"fixed-bottom"},[e.createElementVNode("button",{class:"team-btn"},[e.createElementVNode("text",{class:"iconfont icon-users mr-1"}),e.createElementVNode("text",null,"创建队伍")]),e.createElementVNode("button",{class:e.normalizeClass(["register-btn",{"disabled-btn":"0"===o.value.statusCode||"3"===o.value.statusCode}]),disabled:"0"===o.value.statusCode||"3"===o.value.statusCode},e.toDisplayString(x()),11,["disabled"])])],64))]))}},He={__name:"index",setup(t){function a(e){"applications"!==e?uni.showToast({title:`跳转到${e}`,icon:"none"}):uni.navigateTo({url:"/pages/application/application"})}function n(){uni.showModal({title:"退出确认",content:"确定要退出登录吗？",success:function(e){e.confirm&&uni.showToast({title:"已退出登录",icon:"success",success:()=>{setTimeout((()=>{uni.redirectTo({url:"/pages/login/login"})}),1500)}})}})}function i(){uni.navigateTo({url:"/pages/Xiaoxi/Xiaoxi"})}function l(e){"home"===e?uni.switchTab({url:"/pages/index/index"}):"competition"===e?uni.switchTab({url:"/pages/competition/index"}):"team"===e&&uni.switchTab({url:"/pages/team/list"})}function o(){uni.showActionSheet({itemList:["发布竞赛信息","招募队友","发布项目展示"],success:function(e){uni.showToast({title:`选择了: ${e.tapIndex}`,icon:"none"})}})}return(t,s)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"user-info-section"},[e.createElementVNode("view",{class:"user-header"},[e.createElementVNode("image",{class:"user-avatar",src:"https://images.unsplash.com/photo-1547425260-76bcadfb4f2c?w=200",mode:"aspectFill"}),e.createElementVNode("view",{class:"user-details"},[e.createElementVNode("text",{class:"user-name"},"李明"),e.createElementVNode("text",{class:"user-id"},"学号: 2023114514")]),e.createElementVNode("view",{class:"edit-btn",onClick:i},[e.createElementVNode("text",{class:"iconfont icon-edit"})])]),e.createElementVNode("view",{class:"user-stats"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},"4"),e.createElementVNode("text",{class:"stat-label"},"参与竞赛")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},"2"),e.createElementVNode("text",{class:"stat-label"},"我的团队")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},"1"),e.createElementVNode("text",{class:"stat-label"},"获得奖项")])])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-group"},[e.createElementVNode("view",{class:"menu-item",onClick:s[0]||(s[0]=e=>a("myCompetitions"))},[e.createElementVNode("text",{class:"iconfont icon-trophy menu-icon"}),e.createElementVNode("text",{class:"menu-text"},"我的竞赛"),e.createElementVNode("text",{class:"iconfont icon-arrow-left menu-arrow"})]),e.createElementVNode("view",{class:"menu-item",onClick:s[1]||(s[1]=e=>a("myTeams"))},[e.createElementVNode("text",{class:"iconfont icon-users menu-icon"}),e.createElementVNode("text",{class:"menu-text"},"我的团队"),e.createElementVNode("text",{class:"iconfont icon-arrow-left menu-arrow"})]),e.createElementVNode("view",{class:"menu-item",onClick:s[2]||(s[2]=e=>a("myAwards"))},[e.createElementVNode("text",{class:"iconfont icon-star menu-icon"}),e.createElementVNode("text",{class:"menu-text"},"我的获奖"),e.createElementVNode("text",{class:"iconfont icon-arrow-left menu-arrow"})]),e.createElementVNode("view",{class:"menu-item",onClick:s[3]||(s[3]=e=>a("applications"))},[e.createElementVNode("text",{class:"iconfont icon-paper-plane menu-icon"}),e.createElementVNode("text",{class:"menu-text"},"申请管理"),e.createElementVNode("text",{class:"iconfont icon-arrow-left menu-arrow"})])]),e.createElementVNode("view",{class:"menu-group"},[e.createElementVNode("view",{class:"menu-item",onClick:s[4]||(s[4]=e=>a("settings"))},[e.createElementVNode("text",{class:"iconfont icon-settings menu-icon"}),e.createElementVNode("text",{class:"menu-text"},"账号设置"),e.createElementVNode("text",{class:"iconfont icon-arrow-left menu-arrow"})]),e.createElementVNode("view",{class:"menu-item",onClick:s[5]||(s[5]=e=>a("feedback"))},[e.createElementVNode("text",{class:"iconfont icon-feedback menu-icon"}),e.createElementVNode("text",{class:"menu-text"},"意见反馈"),e.createElementVNode("text",{class:"iconfont icon-arrow-left menu-arrow"})]),e.createElementVNode("view",{class:"menu-item",onClick:s[6]||(s[6]=e=>a("about"))},[e.createElementVNode("text",{class:"iconfont icon-info-circle menu-icon"}),e.createElementVNode("text",{class:"menu-text"},"关于我们"),e.createElementVNode("text",{class:"iconfont icon-arrow-left menu-arrow"})])])]),e.createElementVNode("view",{class:"logout-btn",onClick:n},[e.createElementVNode("text",null,"退出登录")]),e.createVNode(M,{"active-tab":"profile",onTabChange:l,onPublish:o})]))}},Oe={__name:"Xiaoxi",setup(a){const n=e.ref("unread"),i=e.ref(2),l=e.ref([{id:1,type:"团队邀请",message:'张明邀请你加入"创新先锋队"参加创新创业大赛',time:"10分钟前",avatar:"/static/avatars/zhang.png",actions:[{name:"接受",type:"accept",primary:!0},{name:"拒绝",type:"reject",primary:!1}]},{id:2,type:"新消息",message:'李华在"代码助手"团队中@你：能否帮忙解决一下这个问题？',time:"30分钟前",avatar:"/static/avatars/li.png",actions:[{name:"查看",type:"view",primary:!0}]}]),o=e.ref([...l.value,{id:3,type:"系统通知",message:'您的团队"创业先锋"已审核通过，请及时查看',time:"2天前",avatar:"/static/avatars/system.png",read:!0,actions:[{name:"查看",type:"view",primary:!0}]},{id:4,type:"好友申请",message:"王芳申请添加您为好友",time:"3天前",avatar:"/static/avatars/wang.png",read:!0,actions:[{name:"同意",type:"accept",primary:!0},{name:"拒绝",type:"reject",primary:!1}]}]);function s(){l.value.forEach((e=>{const t=o.value.findIndex((t=>t.id===e.id));-1!==t&&(o.value[t].read=!0)})),l.value=[],i.value=0,uni.showToast({title:"已全部标记为已读",icon:"success"})}function r(e,t){"accept"===e&&1===t?uni.showModal({title:"团队邀请",content:'确定接受加入"创新先锋队"？',success:function(e){e.confirm&&(c(t),uni.showToast({title:"已加入团队",icon:"success"}))}}):"reject"===e&&1===t?uni.showModal({title:"团队邀请",content:'确定拒绝加入"创新先锋队"？',success:function(e){e.confirm&&(c(t),uni.showToast({title:"已拒绝邀请",icon:"none"}))}}):"view"===e&&(2===t?(uni.navigateTo({url:"/pages/team/chat?id=代码助手"}),c(t)):uni.navigateTo({url:"/pages/notification/detail?id="+t}))}function c(e){const t=l.value.findIndex((t=>t.id===e));if(-1!==t){l.value.splice(t,1),i.value--;const a=o.value.findIndex((t=>t.id===e));-1!==a&&(o.value[a].read=!0)}}return e.onMounted((()=>{t("log","at pages/Xiaoxi/Xiaoxi.vue:239","通知页面加载完成")})),(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"navbar"},[e.createElementVNode("view",{class:"title"},"通知"),e.createElementVNode("view",{class:"mark-read",onClick:s},[e.createElementVNode("text",{class:"iconfont icon-check"}),e.createElementVNode("text",{class:"mark-text"},"全部标记为已读")])])]),e.createElementVNode("view",{class:"tabs"},[e.createElementVNode("view",{class:e.normalizeClass(["tab-item","unread"===n.value?"tab-active":""]),onClick:a[0]||(a[0]=e=>n.value="unread")},[e.createElementVNode("text",null,"未读"),i.value>0?(e.openBlock(),e.createElementBlock("text",{key:0,class:"badge"},e.toDisplayString(i.value),1)):e.createCommentVNode("",!0)],2),e.createElementVNode("view",{class:e.normalizeClass(["tab-item","all"===n.value?"tab-active":""]),onClick:a[1]||(a[1]=e=>n.value="all")},[e.createElementVNode("text",null,"全部")],2)]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"notification-list"},["unread"===n.value?(e.openBlock(),e.createElementBlock("view",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"notification-item",key:a},[e.createElementVNode("view",{class:"notification-avatar"},[e.createElementVNode("image",{src:t.avatar||"/static/default-avatar.png",mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"notification-content"},[e.createElementVNode("view",{class:"notification-type"},e.toDisplayString(t.type),1),e.createElementVNode("view",{class:"notification-message"},e.toDisplayString(t.message),1),e.createElementVNode("view",{class:"notification-time"},e.toDisplayString(t.time),1),t.actions?(e.openBlock(),e.createElementBlock("view",{key:0,class:"notification-actions"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.actions,((a,n)=>(e.openBlock(),e.createElementBlock("button",{key:n,class:e.normalizeClass(["action-btn",a.primary?"btn-primary":"btn-default"]),onClick:e=>r(a.type,t.id)},e.toDisplayString(a.name),11,["onClick"])))),128))])):e.createCommentVNode("",!0)])])))),128))])):e.createCommentVNode("",!0),"all"===n.value?(e.openBlock(),e.createElementBlock("view",{key:1},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"notification-item",key:a},[e.createElementVNode("view",{class:"notification-avatar"},[e.createElementVNode("image",{src:t.avatar||"/static/default-avatar.png",mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"notification-content"},[e.createElementVNode("view",{class:"notification-type"},e.toDisplayString(t.type),1),e.createElementVNode("view",{class:"notification-message"},e.toDisplayString(t.message),1),e.createElementVNode("view",{class:"notification-time"},e.toDisplayString(t.time),1),t.actions?(e.openBlock(),e.createElementBlock("view",{key:0,class:"notification-actions"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.actions,((a,n)=>(e.openBlock(),e.createElementBlock("button",{key:n,class:e.normalizeClass(["action-btn",a.primary?"btn-primary":"btn-default"]),onClick:e=>r(a.type,t.id)},e.toDisplayString(a.name),11,["onClick"])))),128))])):e.createCommentVNode("",!0)])])))),128))])):e.createCommentVNode("",!0),"unread"===n.value&&0===l.value.length||"all"===n.value&&0===o.value.length?(e.openBlock(),e.createElementBlock("view",{key:2,class:"empty-state"},[e.createElementVNode("image",{class:"empty-image",src:"/static/empty-notification.png",mode:"aspectFit"}),e.createElementVNode("text",{class:"empty-text"},"暂无"+e.toDisplayString("unread"===n.value?"未读":"")+"通知",1)])):e.createCommentVNode("",!0)])]))}},Ge={__name:"application",setup(i){const l=n.baseUrl,o=e.ref(!1),s=e.ref(!1),r=e.ref(!1),c=e.ref(1),d=e.ref(10),u={contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"已经到底啦"},p=e.ref("applicant"),h=e.ref([{name:"我发起的",badge:0,role:"applicant"},{name:"待我处理",badge:0,role:"creator"},{name:"全部",badge:0,role:"all"}]),g=e.ref(0),f=e.ref([{label:"全部",value:"all"},{label:"任务申请",value:"task"},{label:"队伍申请",value:"team"},{label:"徽章申请",value:"badge"}]),v=e.computed((()=>1===g.value?f.value.filter((e=>"badge"!==e.value)):f.value)),w=e.ref([{label:"全部",value:"all"},{label:"待处理",value:"pending"},{label:"已通过",value:"approved"},{label:"已拒绝",value:"rejected"},{label:"已取消",value:"canceled"}]),y=e.ref([{label:"全部",value:"all"},{label:"未处理",value:"pending"},{label:"已处理",value:"processed"}]),k=e.ref("all"),V=e.ref("all"),N=e.ref([]),x=e.computed((()=>{let e=N.value.map((e=>{let t="";switch(e.status){case"pending":t="待处理";break;case"approved":t="已通过";break;case"rejected":t="已拒绝";break;case"canceled":t="已取消";break;case"returned":t="已退回";break;default:t="未知状态"}return{...e,statusText:t}}));return"all"!==V.value&&(e="processed"===V.value?e.filter((e=>"approved"===e.status||"rejected"===e.status||"canceled"===e.status)):e.filter((e=>e.status===V.value))),"all"!==k.value&&(e=e.filter((e=>e.type===k.value))),e}));function b(e){return e&&e.type?"task"===e.type?e.taskTitle||"任务申请":"team"===e.type?e.teamName||"队伍申请":"badge"===e.type?e.badgeTitle||"徽章申请":"申请":"申请"}function T(e){return"task"===e?"task-type":"team"===e?"team-type":"badge"===e?"badge-type":""}async function S(e=!1){if(e&&(c.value=1,r.value=!1,N.value=[]),!s.value){s.value=!0;try{0===g.value?p.value="applicant":1===g.value?p.value="creator":p.value="all","all"!==k.value&&"task"!==k.value||await async function(e){try{const a={pageNum:c.value,pageSize:d.value};"all"!==V.value&&"processed"!==V.value&&(a.status=V.value),"all"!==p.value&&(a.role=p.value);const n=await E.getTaskApplicationList(a);if(200===n.code&&n.data){const a=(n.data.list||[]).map((e=>({...e,type:"task"})));e?("task"===k.value||"all"===k.value)&&(N.value=a):N.value=[...N.value,...a],void 0!==n.data.pendingCount&&(h.value[1].badge=n.data.pendingCount),"task"===k.value&&(r.value=!n.data.hasNext),t("log","at pages/application/application.vue:435","任务申请列表:",a)}}catch(a){t("error","at pages/application/application.vue:438","获取任务申请列表失败:",a),uni.showToast({title:"获取任务申请失败",icon:"none"})}}(e),"all"!==k.value&&"team"!==k.value||await async function(e){try{const a={pageNum:c.value,pageSize:d.value};let n;if("all"!==V.value&&"processed"!==V.value&&(a.status=V.value),n="applicant"===p.value?await m.getMyApplications(a):"creator"===p.value||"leader"===p.value?await m.getTeamApplications(a):await m.getMyApplications(a),200===n.code&&n.data){const a=(n.data.list||[]).map((e=>({...e,type:"team"})));if(e?"team"===k.value?N.value=a:"all"===k.value&&(N.value=[...N.value,...a]):N.value=[...N.value,...a],"creator"===p.value||"leader"===p.value){const e=(n.data.list||[]).filter((e=>"pending"===e.status)).length;1===g.value&&(h.value[1].badge+=e)}"team"===k.value?r.value=!n.data.hasNext:"all"===k.value&&(r.value=r.value&&!n.data.hasNext),t("log","at pages/application/application.vue:509","队伍申请列表:",a)}}catch(a){t("error","at pages/application/application.vue:512","获取队伍申请列表失败:",a),uni.showToast({title:"获取队伍申请失败",icon:"none"})}}(e),"all"!==k.value&&"badge"!==k.value||1===g.value||await async function(e){try{const a={pageNum:c.value,pageSize:d.value};"all"!==V.value&&"processed"!==V.value&&(a.status=V.value);const n=await uni.request({url:`${l}/badge/approvals/my-applications`,method:"GET",data:a,header:{Authorization:`Bearer ${uni.getStorageSync("token")}`}});if(200===n.statusCode&&n.data&&200===n.data.code){const a=(n.data.data.records||[]).map((e=>({...e,id:e.approvalId,type:"badge",status:e.currentStatus,appliedAt:e.createdAt,reviewedAt:e.updatedAt,message:e.reviewMessage,reviewNotes:e.adminFeedback,badgeTitle:"徽章申请 "+(e.requestedBadge?`#${e.requestedBadge}`:""),applicantName:"team"===e.applicantType?"团队申请":"个人申请"})));if(e?"badge"===k.value?N.value=a:"all"===k.value&&(N.value=[...N.value,...a]):N.value=[...N.value,...a],"badge"===k.value){const e=Math.ceil(n.data.data.total/d.value);r.value=c.value>=e}t("log","at pages/application/application.vue:580","徽章申请列表:",a)}}catch(a){t("error","at pages/application/application.vue:583","获取徽章申请列表失败:",a),uni.showToast({title:"获取徽章申请失败",icon:"none"})}}(e),t("log","at pages/application/application.vue:367","加载完成的应用列表数据：",N.value)}catch(a){t("error","at pages/application/application.vue:370","获取申请列表失败:",a),uni.showToast({title:"网络异常，请稍后重试",icon:"none"})}finally{s.value=!1,o.value&&(o.value=!1)}}}function C(){o.value=!0,S(!0)}function D(){s.value||r.value||(c.value++,S(!1))}function B(e){V.value!==e&&(V.value=e,S(!0))}function _(e){switch(e){case"pending":return"status-pending";case"approved":return"status-approved";case"rejected":return"status-rejected";case"canceled":return"status-canceled";default:return""}}function M(e){if(!e)return"-";try{const t=new Date(e),a=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),l=String(t.getHours()).padStart(2,"0");return`${a}-${n}-${i} ${l}:${String(t.getMinutes()).padStart(2,"0")}`}catch(t){return e}}async function I(e,a,n){e&&n?"badge"!==n?uni.showModal({title:"approved"===a?"通过申请":"拒绝申请",content:"approved"===a?"确定通过该申请吗？":"确定拒绝该申请吗？",success:async i=>{if(i.confirm)try{let t;if(uni.showLoading({title:"处理中..."}),"task"===n)t=await E.updateTaskApplication(e,{status:a,reviewNotes:"approved"===a?"申请已通过":"申请已拒绝"});else{if("team"!==n)throw new Error("未知的申请类型");t=await m.handleApplication(e,{status:a,reviewNotes:"approved"===a?"申请已通过":"申请已拒绝"})}uni.hideLoading(),t&&200===t.code&&t.data&&t.data.success?(uni.showToast({title:"approved"===a?"已通过申请":"已拒绝申请",icon:"success"}),S(!0)):uni.showToast({title:(null==t?void 0:t.message)||"操作失败",icon:"none"})}catch(l){uni.hideLoading(),t("error","at pages/application/application.vue:754","处理申请失败:",l),uni.showToast({title:"网络异常，请稍后重试",icon:"none"})}}}):uni.showToast({title:"徽章申请处理功能开发中",icon:"none"}):uni.showToast({title:"参数错误",icon:"none"})}function A(e){"task"===e.type?uni.navigateTo({url:`/pages/task-square/detail?id=${e.taskId}`}):"team"===e.type?uni.navigateTo({url:`/pages/team/detail?id=${e.teamId}`}):"badge"===e.type&&uni.showToast({title:"徽章申请详情功能开发中",icon:"none"})}function R(){uni.navigateBack()}return e.onMounted((()=>{S(!0)})),(n,i)=>{const l=a(e.resolveDynamicComponent("uni-load-more"),Q);return e.openBlock(),e.createElementBlock("view",{class:"application-container"},[e.createElementVNode("view",{class:"fixed-area"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-btn",onClick:R},[e.createElementVNode("text",{class:"iconfont icon-arrow-left"})]),e.createElementVNode("text",{class:"page-title"},"申请管理"),e.createElementVNode("view",{class:"placeholder-right"})]),e.createElementVNode("view",{class:"tabs"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["tab",{active:g.value===a}]),onClick:e=>function(e){g.value!==e&&(g.value=e,V.value="all",1===e&&"badge"===k.value&&(k.value="all"),p.value=0===e?"applicant":1===e?"creator":"all",S(!0))}(a)},[e.createTextVNode(e.toDisplayString(t.name)+" ",1),t.badge&&t.badge>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"badge"},e.toDisplayString(t.badge),1)):e.createCommentVNode("",!0)],10,["onClick"])))),128))]),e.createElementVNode("view",{class:"filter-tabs"},[e.createElementVNode("view",{class:"filter-options"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(v.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["filter-tab",{active:k.value===t.value}]),onClick:e=>function(e){k.value!==e&&(1!==g.value||"badge"!==e?(k.value=e,c.value=1,r.value=!1,N.value=[],S(!0)):uni.showToast({title:"待处理列表中不包含徽章申请",icon:"none"}))}(t.value)},e.toDisplayString(t.label),11,["onClick"])))),128))])]),e.createElementVNode("view",{class:"filter-tabs status-tabs"},[e.createElementVNode("view",{class:"filter-options"},[1===g.value?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(y.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["filter-tab",{active:V.value===t.value}]),onClick:e=>B(t.value)},e.toDisplayString(t.label),11,["onClick"])))),128)):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(w.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["filter-tab",{active:V.value===t.value}]),onClick:e=>B(t.value)},e.toDisplayString(t.label),11,["onClick"])))),128))])])]),e.createElementVNode("scroll-view",{class:"application-list","scroll-y":"","refresher-enabled":"",onRefresherrefresh:C,"refresher-triggered":o.value,onScrolltolower:D},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(x.value,((a,n)=>{return e.openBlock(),e.createElementBlock("view",{key:n,class:e.normalizeClass(["application-card",[(i=a.type,i?"task"===i?"card-task":"team"===i?"card-team":"badge"===i?"card-badge":"card-task":"card-task"),_(a.status)]])},[e.createElementVNode("view",{class:e.normalizeClass(["status-corner",_(a.status)])},e.toDisplayString(a.statusText),3),e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("view",{class:"card-title"},[e.createTextVNode(e.toDisplayString(b(a))+" ",1),e.createElementVNode("text",{class:e.normalizeClass(["type-tag",T(a.type)])},e.toDisplayString("task"===a.type?"任务":"team"===a.type?"队伍":"badge"===a.type?"徽章":"未知"),3)]),e.createElementVNode("view",{class:"card-info"},["creator"===p.value||"leader"===p.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"申请人："),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(a.applicantName)+" "+e.toDisplayString(a.applicantMajor?"· "+a.applicantMajor:""),1)])):e.createCommentVNode("",!0),"team"===a.type&&a.roleName?(e.openBlock(),e.createElementBlock("view",{key:1,class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"申请角色："),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(a.roleName),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"申请时间："),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(M(a.appliedAt)),1)]),a.message?(e.openBlock(),e.createElementBlock("view",{key:2,class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"申请理由："),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(a.message),1)])):e.createCommentVNode("",!0),a.reviewNotes&&"pending"!==a.status?(e.openBlock(),e.createElementBlock("view",{key:3,class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"审核备注："),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(a.reviewNotes),1)])):e.createCommentVNode("",!0)])]),"creator"!==p.value&&"leader"!==p.value||"pending"!==a.status?"applicant"===p.value&&"pending"===a.status?(e.openBlock(),e.createElementBlock("view",{key:1,class:"card-footer"},[e.createElementVNode("view",{class:"btn-group"},[e.createElementVNode("button",{class:"btn btn-detail",onClick:e.withModifiers((e=>A(a)),["stop"])},"查看详情",8,["onClick"]),e.createElementVNode("button",{class:"btn btn-reject",onClick:e.withModifiers((e=>async function(e,a){e&&a?"badge"!==a?uni.showModal({title:"取消申请",content:"确定要取消该申请吗？",success:async n=>{if(n.confirm)try{let t;if(uni.showLoading({title:"处理中..."}),"task"===a)t=await E.cancelTaskApplication(e);else{if("team"!==a)throw new Error("未知的申请类型");t=await m.cancelApplication(e)}uni.hideLoading(),t&&200===t.code&&t.data&&t.data.success?(uni.showToast({title:"已取消申请",icon:"success"}),S(!0)):uni.showToast({title:(null==t?void 0:t.message)||"操作失败",icon:"none"})}catch(i){uni.hideLoading(),t("error","at pages/application/application.vue:821","取消申请失败:",i),uni.showToast({title:"网络异常，请稍后重试",icon:"none"})}}}):uni.showToast({title:"徽章申请取消功能开发中",icon:"none"}):uni.showToast({title:"参数错误",icon:"none"})}(a.id,a.type)),["stop"])},"取消申请",8,["onClick"])])])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"card-footer"},[e.createElementVNode("view",{class:"btn-group"},[e.createElementVNode("button",{class:"btn btn-detail",onClick:e.withModifiers((e=>A(a)),["stop"])},"查看详情",8,["onClick"])]),a.reviewedAt?(e.openBlock(),e.createElementBlock("text",{key:0,class:"process-time"},"处理时间："+e.toDisplayString(M(a.reviewedAt)),1)):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"card-footer"},[e.createElementVNode("view",{class:"btn-group"},[e.createElementVNode("button",{class:"btn btn-detail",onClick:e.withModifiers((e=>A(a)),["stop"])},"查看详情",8,["onClick"]),e.createElementVNode("button",{class:"btn btn-reject",onClick:e.withModifiers((e=>I(a.id,"rejected",a.type)),["stop"])},"拒绝",8,["onClick"]),e.createElementVNode("button",{class:"btn btn-approve",onClick:e.withModifiers((e=>I(a.id,"approved",a.type)),["stop"])},"通过",8,["onClick"])])]))],2);var i})),128)),0!==x.value.length||s.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("image",{class:"empty-image",src:"/static/images/empty.png",mode:"aspectFit"}),e.createElementVNode("text",{class:"empty-text"},"暂无申请记录")])),s.value&&!o.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-more"},[e.createVNode(l,{status:"loading",contentText:u})])):e.createCommentVNode("",!0),r.value&&!s.value&&x.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:2,class:"no-more"},[e.createVNode(l,{status:"noMore",contentText:u})])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"safe-area-bottom"})],40,["refresher-triggered"])])}}};__definePage("pages/login/login",x),__definePage("pages/index/index",A),__definePage("pages/task-square/index",Z),__definePage("pages/task-square/detail",X),__definePage("pages/task-square/create",Le),__definePage("pages/team/detail",$e),__definePage("pages/team/list",Fe),__definePage("pages/team/create",ze),__definePage("pages/competition/index",Ue),__definePage("pages/competition/create",je),__definePage("pages/competition/detail",qe),__definePage("pages/profile/index",He),__definePage("pages/Xiaoxi/Xiaoxi",Oe),__definePage("pages/application/application",Ge);const We={onLaunch:function(){t("warn","at App.vue:4","当前组件仅支持 uni_modules 目录结构 ，请升级 HBuilderX 到 3.1.0 版本以上！"),t("log","at App.vue:5","App Launch")},onShow:function(){t("log","at App.vue:8","App Show")},onHide:function(){t("log","at App.vue:11","App Hide")}};l();const{app:Ye,Vuex:Je,Pinia:Qe}={app:e.createVueApp(We)};uni.Vuex=Je,uni.Pinia=Qe,Ye.provide("__globalStyles",__uniConfig.styles),Ye._component.mpType="app",Ye._component.render=()=>{},Ye.mount("#app")}(Vue);
